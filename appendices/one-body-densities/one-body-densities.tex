\chapter{Coupled cluster density matrices}
    \label{app:cc-density-matrices}
    From \autoref{eq:cc-one-body-density} we have an expression for the coupled
    cluster one-body density matrices $\densityten^q_p$ from the left- and
    right-hand coupled cluster wave functions.
    \begin{align}
        \densityten^{q}_{p}
        &= \mel{\tilde{\Psi}}{\ccr{p}\can{q}}{\Psi}
        = \mel{\slat}{
            (\1 + \clustl)
            \exp[-\clust]
            \ccr{p}\can{q}
            \exp[\clust]
        }{\slat}.
    \end{align}
    Note that we here restrict ourselves to the case of static orbitals,
    however, the expressions turn out to be the same for the case of
    orbital-adaptive orbitals due to the bi-orthonormality of the bivariational
    second quantized operators.
    In order to find an expression for the one-body density matrices in terms of
    the $\clustlamp$- and $\clustamp$-amplitudes we wish to use Wick's theorem.
    We start by splitting up the left-hand wave function into two terms.
    \begin{align}
        \densityten^q_p
        &= \mel{\slat}{
            \exp[-\clust]
            \ccr{p}\can{q}
            \exp[\clust]
        }{\slat}
        + \mel{\slat}{
            \clustl
            \exp[-\clust]
            \ccr{p}\can{q}
            \exp[\clust]
        }{\slat}.
    \end{align}
    Next we expand the exponentials and use the Baker-Campbell-Hausdorff
    formula.
    This lets us write
    \begin{align}
        \exp[-\clust]
        \ccr{p}\can{q}
        \exp[\clust]
        &= \ccr{p}\can{q}
        + \com{\ccr{p}\can{q}}{\clust}
        + \frac{1}{2!}\com{\com{\ccr{p}\can{q}}{\clust}}{\clust}
        + \dots.
    \end{align}
    To determine how many terms to include we have to look at the number of
    excitations that will be performed by the excitation operators $\clust$ and
    relaxation operators $\clustl$.
    We know that $\clust$ will at least excite the reference by $1$.
    The combined operator $\ccr{p}\can{q}$ is able to excite and relax the
    reference with at most $1$, or leave it unchanged.
    The relaxation operator $\clustl$ will at least relax the reference by $1$.
    As our basis of Slater determinants are orthonormal the only non-zero
    contributions to $\densityten^q_p$ will be the operator combinations that
    leave the reference unchanged after applying the total operator product.
    For the first term in $\densityten^q_p$ this leaves us with
    \begin{align}
        \mel{\slat}{
            \exp[-\clust]
            \ccr{p}\can{q}
            \exp[\clust]
        }{\slat}
        &= \mel{\slat}{
            \ccr{p}\can{q}
        }{\slat}
        + \mel{\slat}{
            \ccr{p}\can{q}\clust
        }{\slat},
    \end{align}
    where we've only kept the first term in the first commutator for the
    Baker-Campbell-Hausdorff expansion as the second term in the first
    commutator will leave the state excited thus annihilating the overlap.
    For the term in the one-body density matrix with the Lagrange multipliers,
    we find
    \begin{align}
        \mel{\slat}{
            \clustl
            \exp[-\clust]
            \ccr{p}\can{q}
            \exp[\clust]
        }{\slat}
        &= \mel{\slat}{
            \clustl
            \ccr{p}\can{q}
        }{\slat}
        + \mel{\slat}{
            \clustl
            \com{\ccr{p}\can{q}}{\clust}
        }{\slat}
        \nonumber \\
        &\qquad
        + \frac{1}{2!}
        \mel{\slat}{
            \clustl
            \com{\com{\ccr{p}\can{q}}{\clust}}{\clust}
        }{\slat}
        + \dots.
        \label{eq:densityten_q_p_lambda_part}
    \end{align}
    Depending on the truncation level of the coupled cluster equations, e.g.,
    singles, doubles etc, this will provide a natural truncation for
    \autoref{eq:densityten_q_p_lambda_part}.

    \section{Doubles density matrices}
        \label{app:ccd-density-matrices}
        In the doubles truncation, the only contribution to
        \autoref{eq:densityten_q_p_lambda_part} will be
        \begin{align}
            \bra{\slat}\clustl e^{-\clust}\ccr{p}\can{q}e^{\clust}\ket{\slat}
            &= \bra{\slat}\clustl \com{\ccr{p}\can{q}}{\clust}\ket{\slat}.
        \end{align}
        This happens as the first term in \autoref{eq:densityten_q_p_lambda_part} will
        at best leave the reference relaxed by $1$ as $\ccr{p}\can{q}$ can only
        excite a single particle. The next commutator will suffer the same
        effect, but in reverse. Two $\clust$ operators will leave the reference in a
        $+4$ state, $\ccr{p}\can{q}$ will at best relax this to a $+3$ state.
        Then, $\clustl$, will only be able to relax the total down to a $+1$,
        thus annihilating the overlap. The one-body density matrix for coupled
        cluster doubles is then
        \begin{align}
            \densityten^{q}_{p}
            &= \bra{\slat}\ccr{p}\can{q}\ket{\slat}
            + \bra{\slat}\com{\ccr{p}\can{q}}{\clust}\ket{\slat}
            + \bra{\slat}\clustl \com{\ccr{p}\can{q}}{\clust}\ket{\slat}
            \\
            &=
            \delta^{q}_{j} \delta^{i}_{p} \para{
                \delta^{j}_{i}
                + \half l^{ik}_{ab} t^{ab}_{kj}
            }
            - \half \delta^{q}_{b} \delta^{a}_{p} l^{ij}_{ac} t^{cb}_{ij}.
        \end{align}
        We note that there are no contribution to the terms with an occupied and
        a virtual index, that is, $\densityten^{i}_{a} = \rho^{a}_{i} = 0$. This is a
        direct consequence of the lack of single excitations. The density
        operators $\ccr{a}\can{i}$ and $\ccr{i}\can{a}$ will excite and relax a
        single particle respectively. But, $\clustl$ and $\clust$ only works on pairs
        therefore leaving the reference oddly excited or relaxed thus
        annihilating the overlap.

    \section{The one-body density matrix for singles and doubles excitations}
        For coupled cluster singles-and-doubles \autoref{eq:densityten_q_p_lambda_part}
        will truncate at the double commutator as written. Employing
        SymPy\cite{sympy} we can compute an expression for the one-body density
        matrices.
        \begin{align}
            \densityten^{q}_{p}
            &= \bra{\slat}\ccr{p}\can{q}\ket{\slat}
            + \bra{\slat}\com{\ccr{p}\can{q}}{\clust}\ket{\slat}
            + \bra{\slat}\clustl \ccr{p}\can{q}\ket{\slat}
            \nonumber \\
            &\qquad
            + \bra{\slat}\clustl \com{\ccr{p}\can{q}}{\clust}\ket{\slat}
            + \frac{1}{2!}
            \bra{\slat}\clustl \com{\com{\ccr{p}\can{q}}{\clust}}{\clust}\ket{\slat}
            \\
            &=
            \delta^a_p \delta^q_b \para{
                l^i_a t^b_i + \frac{1}{2} l^{ij}_{ac} t^{bc}_{ij}
            }
            + \delta^a_p \delta^q_i l^i_a
            + \delta^q_j \delta^i_p \para{
                \delta^j_i
                - l^j_a t^a_i
                + \half l^{jk}_{ab} t^{ab}_{ki}
            }
            \nonumber \\
            &\qquad
            + \delta^q_a \delta^i_p \para{
                t^a_i
                + l^j_b \brak{
                    t^{ab}_{ij} - t^b_i t^a_j
                }
                + \half t^{b}_{i} l^{kj}_{cb} t^{ac}_{kj}
                - \half t^{a}_{j} l^{kj}_{cb} t^{cb}_{ki}
            }.
            \label{eq:densityten_q_p_ccsd}
        \end{align}
        In this expression we have only kept the fully contracted terms. SymPy
        sets the indices arbitrarily so the expression shown in
        \autoref{eq:densityten_q_p_ccsd} has been factorized and had a relabeling of
        the indices for improved readability.

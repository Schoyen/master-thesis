\chapter{Quantum Mechanics}
    In this appendix we'll add proofs and derivations of expressions arising
    from the theory section on quantum mechanics and many-body theory.

    \section{Deriving the reference energy}
        \label{sec:deriving-the-reference-energy}
        For the orthormal basis $\brac{\ket{\phi_p}}_{p = 1}^{L}$ with the $N$
        first states occupied in the reference state $\ket{\refslat}$, we
        compute the reference energy from \autoref{eq:reference-energy}.
        We use Wick's theorem with normal ordering relative to the Fermi vacuum,
        that is, we treat the reference state as our vacuum state.
        Starting with the one-body operator, we get
        \begin{align}
            \onehamil
            &=
            \oneten^{p}_{q}
            \ccr{p}
            \can{q}
            =
            \oneten^{p}_{q}
            \para{
                \brac{
                    \ccr{p}
                    \can{q}
                }
                +
                \wick{
                    \c {\ccr{p}}
                    \c {\can{q}}
                }
            }
            =
            \oneten^{p}_{q}
            \brac{
                \ccr{p}
                \can{q}
            }
            +
            \oneten^{p}_{q}
            \delta_{p \in O}
            \delta_{pq},
            \label{eq:one-hamil-wick}
        \end{align}
        where we use $\delta_{p \in O}$ to denote that the general index
        $p$ must be contained in the set of occupied indices $O = \brac{1,
        \dots, N}$.
        This notation is similar to the one used by
        \citeauthor{crawford2000introduction} in
        \citetitle{crawford2000introduction}\cite{crawford2000introduction}.
        We call the first term, the \emph{normal-ordered one-body Hamiltonian},
        \begin{align}
            \onehamil_N \equiv \oneten^{p}_{q}\brac{
                \ccr{p}
                \can{q}
            }.
            \label{eq:one-hamil-normal}
        \end{align}
        Computing the expectation value of the one-body Hamiltonian on the
        reference state, we get
        \begin{align}
            \bra{\refslat}\onehamil\ket{\refslat}
            =
            \bra{\refslat}\onehamil_N\ket{\refslat}
            +
            \oneten^{p}_{q}
            \delta_{p \in O}
            \delta_{pq}
            \braket{\refslat}{\refslat}
            = 0 + \oneten^{i}_{i}.
        \end{align}
        To see why the former term becomes zero, we have to consider the four
        combinations of indices that can be summed over in the operators.
        From \autoref{sec:fermi-vacuum} we know that only terms with both
        occupied or both virtual indices will contribute to the expectation
        value.
        As the operators are normal-ordered relative to the Fermi vacuum they
        will destroy the reference state by either creating a particle that is
        already present in the reference state, or destroying a particle that is
        not in the reference state.
        The expectation value of the two-body term is given by
        \begin{align}
            \bra{\refslat}\twohamil\ket{\refslat}
            &=
            \frac{1}{4}u^{pq}_{rs}
            \bra{\refslat}\ccr{p}\ccr{q}\can{s}\can{r}\ket{\refslat}.
        \end{align}
        For brevity, we will only write out the operator strings.
        \begin{align}
            \ccr{p}\ccr{q}\can{s}\can{r}
            &=
            \wick{
                \c1 {\ccr{p}}
                \c2 {\ccr{q}}
                \c1 {\can{s}}
                \c2 {\can{r}}
            }
            +
            \wick{
                \c2 {\ccr{p}}
                \c1 {\ccr{q}}
                \c1 {\can{s}}
                \c2 {\can{r}}
            }
            + \brac{
                \wick{
                    \c {\ccr{p}}
                    {\ccr{q}}
                    \c {\can{s}}
                    {\can{r}}
                }
            }
            + \brac{
                \wick{
                    \c {\ccr{p}}
                    {\ccr{q}}
                    {\can{s}}
                    \c {\can{r}}
                }
            }
            \nonumber \\
            &\qquad
            + \brac{
                \wick{
                    {\ccr{p}}
                    \c {\ccr{q}}
                    \c {\can{s}}
                    {\can{r}}
                }
            }
            + \brac{
                \wick{
                    {\ccr{p}}
                    \c {\ccr{q}}
                    {\can{s}}
                    \c {\can{r}}
                }
            }
            + \brac{
                {\ccr{p}}
                {\ccr{q}}
                {\can{s}}
                {\can{r}}
            }
            \\
            &=
            -\delta_{p \in O}
            \delta_{q \in O}
            \delta_{ps}
            \delta_{qr}
            + \delta_{p \in O}
            \delta_{q \in O}
            \delta_{pr}
            \delta_{qs}
            - \delta_{p \in O}
            \delta_{ps}
            \brac{
                \ccr{q}
                \can{r}
            }
            \nonumber \\
            &\qquad
            + \delta_{p \in O}
            \delta_{pr}
            \brac{
                \ccr{q}
                \can{s}
            }
            + \delta_{q \in O}
            \delta_{qs}
            \brac{
                \ccr{p}
                \can{r}
            }
            - \delta_{q \in O}
            \delta_{qr}
            \brac{
                \ccr{p}
                \can{s}
            }
            \nonumber \\
            &\qquad
            + \brac{
                {\ccr{p}}
                {\ccr{q}}
                {\can{s}}
                {\can{r}}
            }.
            \label{eq:two-hamil-op-wick}
        \end{align}
        For the same reason as with the expectation value of the one-body
        operator, all terms with a normal-ordered pair of creation and
        annihilation operators will be zero.
        This means that we are left with the two fully contracted terms and the
        normal-ordered product with two pairs of creation and annihilation
        operators.
        We note that there exists a combination of indices which will \emph{not}
        destroy the reference even though the operators are normal-ordered.
        This occurs when both creation operators act on virtual states and the
        two annihilation operators act on occupied states, viz.
        \begin{align}
            \brac{
                {\ccr{a}}
                {\ccr{b}}
                {\can{j}}
                {\can{i}}
            }
            \ket{\refslat}
            = A\ket{\slat^{ab}_{ij}},
        \end{align}
        where $A$ is some phase factor.
        In other words, this combination of operators will leave the reference
        state excited, but due to the orthonormality of the basis states, the
        overlap between the reference state and the excited state will be zero.
        We are thus left with
        \begin{align}
            \bra{\refslat}\twohamil\ket{\refslat}
            &=
            \frac{1}{4}\twoten^{pq}_{rs}\brac{
                -\delta_{p \in O}
                \delta_{q \in O}
                \delta_{ps}
                \delta_{qr}
                + \delta_{p \in O}
                \delta_{q \in O}
                \delta_{pr}
                \delta_{qs}
            }\braket{\refslat}{\refslat}
            \\
            &=
            -\frac{1}{4} \twoten^{ij}_{ji}
            + \frac{1}{4} \twoten^{ij}_{ij}
            = \half \twoten^{ij}_{ij},
        \end{align}
        where we've used the anti-symmetry of the two-body tensor to collect the
        two remaining terms, that is, $\twoten^{ij}_{ij} =-\twoten^{ij}_{ji}$.
        In total we are left with the reference energy of the electronic
        Hamiltonian
        \begin{align}
            \energyref
            &=
            \bra{\refslat}\hamil\ket{\refslat}
            =
            \bra{\refslat}\onehamil\ket{\refslat}
            + \bra{\refslat}\twohamil\ket{\refslat}
            =
            \oneten^{i}_{i}
            + \half \twoten^{ij}_{ij},
        \end{align}
        which is what we wanted to show.

    \section{The normal-ordered Hamiltonian}
        Given an orthonormal basis $\brac{\ket{\phi_p}}_{p = 1}^{L}$, with the
        $N$ first states occupied in the reference state $\ket{\refslat}$, we
        can construct the normal-ordered Hamiltonian, $\hamil_N$, relative to
        the Fermi vacuum by using Wick's theorem.
        Starting with the one-body Hamiltonian, we know from
        \autoref{eq:one-hamil-wick} that we can write the one-body Hamiltonian
        as
        \begin{align}
            \onehamil = \onehamil_N + \oneten^{i}_{i},
        \end{align}
        where $\onehamil_N$ is the normal-ordered one-body Hamiltonian from
        \autoref{eq:one-hamil-normal}.
        For the two-body operator, we use \autoref{eq:two-hamil-op-wick} and
        perform the summation.
        This gives
        \begin{align}
            \twohamil
            &=
            - \frac{1}{4}\twoten^{ij}_{ji}
            + \frac{1}{4}\twoten^{ij}_{ij}
            - \frac{1}{4}\twoten^{iq}_{ri}\brac{
                \ccr{q}
                \can{r}
            }
            + \frac{1}{4}\twoten^{iq}_{is}\brac{
                \ccr{q}
                \can{s}
            }
            \nonumber \\
            &\qquad
            + \frac{1}{4}\twoten^{pj}_{rj}\brac{
                \ccr{p}
                \can{r}
            }
            - \frac{1}{4}\twoten^{pj}_{js}\brac{
                \ccr{p}
                \can{s}
            }
            + \frac{1}{4}\twoten^{pq}_{rs}\brac{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        Using the anti-symmetric properties of the anti-symmetric two-body
        matrix elements,
        \begin{align}
            \twoten^{pq}_{rs}
            =
            -\twoten^{qp}_{rs}
            =
            -\twoten^{pq}_{sr}
            =
            \twoten^{qp}_{sr},
        \end{align}
        and relabeling some of the indidces, we can collect terms and rewrite
        the two-body operator to
        \begin{align}
            \twohamil
            &=
            \half \twoten^{ij}_{ij}
            + \twoten^{pi}_{qi}\brac{
                \ccr{p}
                \can{q}
            }
            + \twohamil_N.
        \end{align}
        Here we have introduced the \emph{normal-ordered two-body operator} to
        be
        \begin{align}
            \twohamil_N
            &\equiv
            \frac{1}{4}\twoten^{pq}_{rs}\brac{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        Combining the one- and two-body operators, we get the full Hamiltonian
        \begin{align}
            \hamil
            &=
            \onehamil + \twohamil
            =
            \oneten^{i}_{i}
            + \half \twoten^{ij}_{ij}
            + \para{
                \oneten^{p}_{q}
                +
                \twoten^{pi}_{qi}
            }
            \brac{
                \ccr{p}
                \can{q}
            }
            +
            \frac{1}{4}\twoten^{pq}_{rs}
            \brac{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            },
        \end{align}
        where we've collected the constant terms, the one-body terms and the
        two-body term.
        We recognize the two first constant terms as the reference energy from
        \autoref{eq:reference-energy}.
        The two next terms constitute the normal-ordered Fock operator given by
        \begin{align}
            \fock_N
            &\equiv
            \para{
                \oneten^{p}_{q}
                +
                \twoten^{pi}_{qi}
            }
            \brac{
                \ccr{p}
                \can{q}
            }
            \equiv
            \fockten^{p}_{q}
            \brac{
                \ccr{p}
                \can{q}
            }.
        \end{align}
        Inserted into the full Hamiltonian we are able to discern the
        normal-ordered Hamiltonian.
        \begin{align}
            \hamil
            &=
            \energyref
            +
            \fock_N
            +
            \twohamil_N
            \equiv
            \energyref
            +
            \hamil_N.
        \end{align}
        In terms of the second quantized operator the normal-ordered Hamiltonian
        is given by
        \begin{align}
            \hamil_N
            &=
            \fock_N + \twohamil_N
            =
            \fockten^{p}_{q}\brac{
                \ccr{p}
                \can{q}
            }
            +
            \frac{1}{4}
            \twoten^{pq}_{rs}\brac{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        The normal-ordered Hamiltonian relative to the Fermi vacuum is defined
        in such a manner that
        \begin{align}
            \bra{\slat}\hamil_N\ket{\slat}
            = \bra{\slat}\fock_N\ket{\slat}
            + \bra{\slat}\twohamil_N\ket{\slat}
            = 0.
        \end{align}
        You can convince yourself of this by noting that the only terms that
        do not destroy the reference state must leave it excited.
        For an orthonormal basis of Slater determinants, this will necessarily
        leave the overlap between the reference state and an excited state zero.

    \section{Deriving the dimensionless Hamiltonian}
        \label{app:two-dim-ho-dimensionless}
        In \autoref{subsec:two-dim-ho} we introduced the dimensionless form of
        the two-dimensional harmonic oscillator \cite{anisimovas1998energy}.
        Here we will show the steps involved in the derivation to make the
        Hamiltonian dimensionless.
        Introducing the dimensionless position $\vfg{r}'$ given by
        \begin{align}
            \vfg{r} = a \vfg{r}',
        \end{align}
        where $a$ is the Bohr radius given by \autoref{eq:bohr-radius}.
        Inserting the dimensionless position into the Hamiltonian from
        \autoref{eq:two-dim-ho-hamiltonian} we find for the Laplace operator in
        polar coordinates $\vfg{r} = (r, \phi)$,
        \begin{align}
            \vfg{\nabla}^2
            &= \frac{1}{r}\dpd{}{r}\para{
                r\dpd{}{r}
            }
            + \frac{1}{r^2}\dpd[2]{}{\phi}
            \\
            &= \frac{1}{a r'}\frac{1}{a}\dpd{}{r'}\para{
                a r' \frac{1}{a}\dpd{}{r'}
            }
            + \frac{1}{a^2 r^2}\dpd[2]{}{\phi}
            = \frac{1}{a^2}\para{\vfg{\nabla}'}^2,
        \end{align}
        where we've dropped the particle indices for the sake of brevity.
        Thus, the one-body part of the Hamiltonian becomes
        \begin{align}
            \oneten(\vfg{r})
            = -\frac{\hslash^2}{2m a^2}\para{\vfg{\nabla}'}^2
            + \half m \omega^2 a^2 \para{\vfg{r}'}^2
            = \frac{\hslash\omega}{2}\brak{
                -\para{\vfg{\nabla}'}^2
                + \para{\vfg{r}'}^2
            }.
        \end{align}
        The Coulomb interaction becomes
        \begin{align}
            \twoten(\vfg{r}_i, \vfg{r}_j)
            &= \frac{e^2}{4\pi\epsilon_0 \abs{\vfg{r}_i - \vfg{r}_j}}
            = \frac{e^2}{4\pi \epsilon_0 a}
            \frac{1}{\abs{\vfg{r}_i' - \vfg{r}_j'}}.
        \end{align}
        Thus, the full dimensionless Hamitonian becomes
        \begin{align}
            \hamilten(\vfg{r})
            = \frac{\hslash\omega}{2} \sum_{i = 1}^{N}\brak{
                -\vfg{\nabla}^2_i
                + \vfg{r}^2_i
            }
            + \lambda \sum_{i < j}^{N} \frac{1}{\abs{\vfg{r}_i - \vfg{r}_j}},
        \end{align}
        where $\lambda$ is defined as in \autoref{eq:two-dim-ho-lambda}.
        This is the form of the Hamiltonian we wanted to show.

    \section{Coulomb elements}
        \label{app:coulomb-elements}
        In this section we'll write out the closed form solution to the Coulomb
        elements for the two-dimensional harmonic oscillator in polar
        coordinates \cite{anisimovas1998energy}.
        The eigenstates are given by \autoref{eq:eigenstate-tdho} and the
        Coulomb interaction in coordinate representation by
        \begin{align}
            u(\vf{r}_i, \vf{r}_j)
            &= \frac{1}{4\pi\epsilon_0}\frac{e^2}{\abs{\vf{r}_i - \vf{r}_j}}.
        \end{align}
        Replacing the positions with the dimensionless length $\vf{r} \to
        \vf{r}/a$, where $a$ is the Bohr radius from \autoref{eq:bohr-radius},
        and measuring energy in dimensionless units of $\hslash \omega$
        \cite{anisimovas1998energy} we can write the Coulomb interaction as
        \begin{align}
            u(\vf{r}_i, \vf{r}_j)
            &= \lambda
            \frac{1}{\abs{\vf{r}_i - \vf{r}_j}},
        \end{align}
        where we have introduced the coupling constant
        \begin{align}
            \lambda = \frac{a m e^2}{4 \hslash^2 \pi \epsilon_0}.
        \end{align}
        In the case of atomic Hartree units, the Coulomb
        interaction can be written
        \begin{align}
            u(\vf{r}_i, \vf{r}_j)
            &= \sqrt{\omega}
            \frac{1}{\abs{\vf{r}_i - \vf{r}_j}},
        \end{align}
        where the frequency comes from the Bohr radius.
        The scaled eigenstates are then given by
        \begin{align}
            \psi_{nm}(r, \phi)
            &= \sqrt{\frac{n!}{\pi(\abs{m} + n)!}}
            r^{\abs{m}} L^{\abs{m}}_n(r^2)
            \exp[-r^2/2]
            \exp[im\phi].
        \end{align}
        % TODO: Should there be a factor 2 in n! and pi?
        % See Anisimovas article.
        We will only look at the orbital part of the elements, as the
        spin-symmetry can be added afterwards.
        \begin{align}
            \mel{ij}{\hat{u}}{kl}
            &= \lambda
            \mathcal{I}^{ij}_{kl},
        \end{align}
        where we are interested in computing the integral
        \begin{align}
            \mathcal{I}^{ij}_{kl}
            &=
            \delta_{m_i + m_j, m_k + m_l}
            \int\dd \vf{r}_1\dd \vf{r}_2
            \psi_{i}^{*}(\vf{r}_1) \psi_{j}^{*}(\vf{r}_2)
            \frac{1}{\abs{\vf{r}_1 - \vf{r}_2}}
            \psi_{k}(\vf{r}_1)\psi_{l}(\vf{r}_2),
        \end{align}
        Unlike \citeauthor{anisimovas1998energy} we will compute the log of the
        integral they list as this is slightly more convenient in terms of
        computation.
        % TODO: Remember to introduce the index convention used by Anisimovas
        % and Matulis.

    \section{Barrier integrals}
        \label{app:barrier-integrals}
        We start by solving the integral for the absolute value of the cosine.
        \begin{align}
            \tilde{\mathcal{C}}_{pq}
            =
            \int_{0}^{2\pi} \dd \phi
            \abs{\cos(\phi)}
            \exp[-i\Delta m_{pq} \phi],
        \end{align}
        where we've again introduced the difference in the angular quantum
        number as in \autoref{eq:diff-m-tdqd}.
        We split up the integrals in three parts where $\cos(\phi) \geq 0$ to
        get rid of the absolute value.
        \begin{align}
            \tilde{\mathcal{C}}_{pq}
            &=
            \para{
                \int_{0}^{\pi/2}
                \dd \phi
                -
                \int_{\pi/2}^{3\pi/2}
                \dd \phi
                +
                \int_{3\pi/2}^{2\pi}
                \dd \phi
            }
            \cos(\phi)
            \exp[-i\Delta m_{pq}\phi],
        \end{align}
        where the notation should be understood such that each integral should
        evaluate the function to its right.
        The sign of the second integral comes from the fact that $\cos(\phi)
        \leq 0$ for $\phi \in [\pi/2, 3\pi/2]$.
        The solutions to the indefinite integrals are the same as for the dipole
        moment in the $x$-direction as seen in \autoref{eq:dipole-x-tdqd}.
        Taking care to look at the situation when $\Delta m_{pq} \neq \pm 1$
        first, we get
        \begin{align}
            \tilde{\mathcal{C}}_{pq}
            &=
            \frac{2}{1 - (\Delta m_{pq})^2}\brac{
                \exp[-i\Delta m_{pq} \pi / 2]
                + \exp[-i \Delta m_{pq} 3\pi / 2]
            }
            \\
            &= \frac{2}{1 - (\Delta m_{pq})^2}
            \exp[-i\Delta m_{pq} \pi / 2]
            \para{
                1 + \cos(\Delta m_{pq} \pi)
            }.
        \end{align}
        We can then see that odd values of $\Delta m_{pq}$ makes the integral
        vanish as
        \begin{align}
            1 + \cos(\Delta m_{pq} \pi)
            = 1 + \cos((2k + 1) \pi) = 0,
        \end{align}
        where $k \in \mathbb{Z}$, whereas for even values of $\Delta m_{pq}$ we
        get
        \begin{align}
            1 + \cos(\Delta m_{pq} \pi)
            = 1 + \cos(2k \pi) = 2.
        \end{align}
        Furthermore, the sign of the exponential will alternate between $\pm 1$
        for odd and even values of $k$.
        We thus have
        \begin{align}
            \tilde{\mathcal{C}}_{pq}
            =
            \frac{4}{1 - (\Delta m_{pq})^2}
            \begin{cases}
                0 & \Delta m_{pq} = 2k + 1, \\
                1 & \Delta m_{pq} = 4k, \\
                -1 & \Delta m_{pq} = 4k + 2,
            \end{cases}
        \end{align}
        where $k \in \mathbb{Z} \setminus \brac{0}$.
        Looking at the case when $\Delta m_{pq} = \pm 1$ we get
        \begin{align}
            \tilde{\mathcal{C}}_{pq}
            &=
            \para{
                \int_{0}^{\pi/2}
                \dd \phi
                -
                \int_{\pi/2}^{3\pi/2}
                \dd \phi
                +
                \int_{3\pi/2}^{2\pi}
                \dd \phi
            }
            \cos(\phi)
            \exp[\mp i\phi]
            \\
            &=
            \para{
                \int_{0}^{\pi/2}
                \dd \phi
                -
                \int_{\pi/2}^{3\pi/2}
                \dd \phi
                +
                \int_{3\pi/2}^{2\pi}
                \dd \phi
            }
            \brak{
                \cos^2(\phi)
                \mp i \cos(\phi)\sin(\phi)
            }
            \\
            &= 0.
        \end{align}
        Moving to the integral with the absolute value of the sine.
        \begin{align}
            \tilde{\mathcal{S}}_{pq}
            &= \int_{0}^{2\pi} \dd \phi
            \abs{\sin(\phi)}
            \exp[-i\Delta m_{pq} \phi]
            \\
            &= \para{
                \int_{0}^{\pi} \dd \phi
                - \int_{\pi}^{2\pi} \dd \phi
            }
            \sin(\phi) \exp[-i\Delta m_{pq} \phi].
        \end{align}
        We again start our initial analysis for $\Delta m_{pq} \neq \pm 1$.
        The solution to each of the indefinite integrals is the same as in
        \autoref{eq:dipole-y-tdqd} but with changed integration limits.
        Evaluating at the new limits we get
        \begin{align}
            \tilde{\mathcal{S}}_{pq}
            &=
            \frac{2}{1 - (\Delta m_{pq})^2}
            \brak{
                \exp[-i\Delta m_{pq} \pi]
                + 1
            }
            \\
            &= \frac{2}{1 - (\Delta m_{pq})^2}
            \brak{
                \cos(\Delta m_{pq} \pi)
                + 1
            }
            \\
            &=
            \frac{4}{1 - (\Delta m_{pq})^2}
            \begin{cases}
                0 & \Delta m_{pq} = 2k + 1, \\
                1 & \Delta m_{pq} = 2k,
            \end{cases}
        \end{align}
        where $k \in \mathbb{Z} \setminus \brac{0}$.
        For $\Delta m_{pq} = \pm 1$ we get
        \begin{align}
            \tilde{\mathcal{S}}_{pq}
            &= \para{
                \int_{0}^{\pi} \dd \phi
                - \int_{\pi}^{2\pi} \dd \phi
            }
            \sin(\phi) \exp[\mp i \phi]
            \\
            &= \para{
                \int_{0}^{\pi} \dd \phi
                - \int_{\pi}^{2\pi} \dd \phi
            }
            \brak{
                \sin(\phi)\cos(\phi)
                \mp i\sin^2(\phi)
            }
            = 0.
        \end{align}

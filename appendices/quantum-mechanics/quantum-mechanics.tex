\chapter{Quantum Mechanics}
    In this appendix we'll add proofs and derivations of expressions arising
    from the theory chapters on quantum mechanics and many-body theory.

    \section{Gauge invariant electromagnetic Hamiltonian}
        \label{app:gauge-invariant-electromagnetic-hamiltonian}
        Given the semi-classical Hamiltonian on the form
        \begin{align}
            \hamil
            = -\frac{\hslash^2}{2m}\vfg{\nabla}^2
            + v(\vfg{r})
            + i\hslash\frac{q}{2m}\brak{
                \vfg{A}\cdot\vfg{\nabla}
                + \vfg{\nabla}\cdot\vfg{A}
            }
            + \frac{q^2}{2m}\vfg{A}^2
            + q\phi,
        \end{align}
        where $\vfg{A}$ and $\phi$ are the classical description of the
        electromagnetic vector and scalar potentials respectively, we wish to
        show that under the gauge transformations
        \begin{gather}
            \vfg{A} \to \vfg{A}' = \vfg{A} + \vfg{\nabla}f,
            \\
            \phi \to \phi' = \phi - \dpd{f}{t},
            \\
            \psi \to \psi' = \exp[\frac{iq}{\hslash}f]\psi,
        \end{gather}
        as listed in \autoref{eq:gauge-invariant-vector-potential} to
        \autoref{eq:gauge-invariant-wave-function}, the time-dependent
        Schrödinger equation is invariant.
        We start by looking at the gradient and the Laplace operator on the
        gauge transformed wave function.
        \begin{gather}
            \vfg{\nabla}\psi'
            = \exp[\frac{iq}{\hslash} f]\brak{
                \frac{iq}{\hslash}\para{\vfg{\nabla}f}
                + \vfg{\nabla}
            }\psi, \\
            \vfg{\nabla}^2\psi'
            = \exp[\frac{iq}{\hslash} f]\brak{
                \frac{iq}{\hslash}\para{\vfg{\nabla}f}
                + \vfg{\nabla}
            }^2\psi, \\
        \end{gather}
        where the nabla-operator works on everything to its right unless it is
        in a paranthesis.
        This means that one must include the product rule with the wave function
        $\psi$ for the squared bracket.
        The potential $v(\vfg{r})$ does not include derivatives and therefore
        leaves the state $\psi'$ unchanged.
        For the third term we get
        \begin{align}
            \vfg{A}'\cdot\vfg{\nabla}\psi'
            +
            \vfg{\nabla}\cdot\para{
                \vfg{A}'\psi'
            }
            =
            2
            \vfg{A}'\cdot\vfg{\nabla}\psi'
            +
            \para{\vfg{\nabla}\cdot\vfg{A}'}\psi'.
        \end{align}
        The former of these two terms yield
        \begin{align}
            2\vfg{A}'\cdot\vfg{\nabla}\psi'
            = 2\exp[\frac{iq}{\hslash}f]
            \brak{
                \frac{iq}{\hslash}
                \vfg{A}\cdot\para{\vfg{\nabla}f}
                + \vfg{A}\cdot\vfg{\nabla}
                + \frac{iq}{\hslash}
                \para{\vfg{\nabla}f}^2
                + \para{\vfg{\nabla}f}\cdot\vfg{\nabla}
            }\psi,
        \end{align}
        and the latter gives
        \begin{align}
            \para{\vfg{\nabla}\cdot\vfg{A}'}\psi'
            =
            \exp[\frac{iq}{\hslash}f]
            \brak{
                \para{\vfg{\nabla}\cdot\vfg{A}}
                + \para{\vfg{\nabla}^2f}
            }\psi.
        \end{align}
        The term squared in the vector potential yields
        \begin{align}
            \para{\vfg{A}'}^2\psi'
            =
            \exp[\frac{iq}{\hslash}f]
            \brak{
                \vfg{A}^2
                + 2\vfg{A}\cdot\para{\vfg{\nabla}f}
                + \para{\vfg{\nabla}f}^2
            }\psi.
        \end{align}
        For the scalar potential we get
        \begin{align}
            \phi'\psi'
            = \exp[\frac{iq}{\hslash}f]\brak{
                \phi
                - \dpd{f}{t}
            }\psi.
        \end{align}
        The left-hand side of the time-dependent Schrödinger equation gives
        \begin{align}
            \dpd{}{t}
            \psi'
            =
            \exp[\frac{iq}{\hslash}f]
            \brak{
                \frac{iq}{\hslash}\dpd{f}{t}
                + \dpd{}{t}
            }\psi.
        \end{align}
        Noting that all terms in the time-dependent Schrödinger equation
        contains the exponential function from $\psi'$ we can remove this term
        on both sides.
        Starting with the scalar potential and the left-hand side of the
        time-dependent Schrödinger equation, we have that
        \begin{align}
            i\hslash\dpd{}{t}\psi'
            \supset
            v(\vfg{r})\psi'
            +
            q\phi'\psi'
            \implies
            i\hslash\dpd{}{t}\psi
            \supset
            v(\vfg{r})\psi
            +
            q\phi\psi,
        \end{align}
        where we've used the notation $\supset$ to denote a term in the right-hand
        side of the Schrödinger equation, and included the potential term.
        To go from here we collect all terms that contain the function $f$.
        For the kinetic term we have
        \begin{align}
            -\frac{\hslash^2}{2m}\vfg{\nabla}^2\psi'
            \supset
            \brak{
                \frac{q^2}{2m}\para{\vfg{\nabla}f}^2
                - \frac{iq\hslash}{m}\para{\vfg{\nabla}f}\cdot\vfg{\nabla}
                - \frac{iq\hslash}{2m}\para{\vfg{\nabla}^2f}
            }\psi,
        \end{align}
        where we've multiplied in the constant factor to recognize equal terms.
        \begin{align}
            \frac{iq\hslash}{2m}\brak{
                \vfg{A}'\cdot\vfg{\nabla}
                + \vfg{\nabla}\cdot\vfg{A}'
            }\psi'
            &\supset
            \Biggl[
                - \frac{q^2}{m}\vfg{A}\cdot\para{\vfg{\nabla}f}
                - \frac{q^2}{m}\para{\vfg{\nabla}f}^2
                \nonumber \\
                &\qquad
                + \frac{iq\hslash}{m}\para{\vfg{\nabla}f}\cdot\vfg{\nabla}
                + \frac{iq\hslash}{2m}\para{\vfg{\nabla}^2f}
            \Biggr]\psi.
        \end{align}
        Finally, the squared term contains the function $f$ in the following
        places
        \begin{align}
            \frac{q^2}{2m}\para{\vfg{A}'}^2\psi'
            &\supset
            \brak{
                \frac{q^2}{m}\vfg{A}\cdot\para{\vfg{\nabla}f}
                + \frac{q^2}{2m}\para{\vfg{\nabla}f}^2
            }\psi.
        \end{align}
        We are thus able to see that all terms containing the function $f$
        cancel and can conclude that
        \autoref{eq:gauge-invariant-vector-potential} through
        \autoref{eq:gauge-invariant-wave-function} are gauge transformations for
        the electromagnetic potentials and the wave function that leave the
        time-dependent Schrödinger equation invariant.

    \section{Positive definite overlap matrix}
        \label{app:positive-definite-overlap}
        Consider an atomic orbital basis of $L$ single-particle states
        $\brac{\chi_{\alpha}}$ where the overlap is given by
        \begin{align}
            \overlapten_{\alpha\beta}
            = \braket*{\chi_{\alpha}}{\chi_{\beta}}
            = \int\dd x \chi^{*}_{\alpha}(x)\chi_{\beta}(x)
            \neq \delta_{\alpha\beta}.
        \end{align}
        The overlap matrix $\overlapmat \in \mathbb{C}^{L \times L}$ constructed
        from the overlap elements above is Hermitian by construction.
        This means that there exists a unitary matrix $\vfg{U} \in \mathbb{C}^{L
        \times L}$ which diagonalizes the overlap matrix, viz.
        \begin{align}
            \vfg{U}^{\dagger}\overlapmat\vfg{U}
            = \vfg{s},
        \end{align}
        where $\vfg{s}$ is a diagonal matrix with the eigenvalues $\lambda_i$ of
        $\overlapmat$.
        We now wish to show that $\overlapmat$ is positive definite.
        \begin{proof}
            Defining $\vfg{u}_{i} \in \mathbb{C}^{L}$ as the $i$'th column of
            $\vfg{U}$ we have that
            \begin{align}
                \vfg{u}_{i}^{\dagger}\overlapmat\vfg{u}_i
                &= u^{*}_{\alpha i}
                \overlapten_{\alpha\beta}
                u_{\beta i}
                = \int\dd x
                \para{
                    u_{\alpha i}
                    \chi_{\alpha}(x)
                }
                \para{
                    \chi_{\beta}(x)
                    u_{\beta i}
                }
                \\
                &=
                \int \dd x
                \psi^{*}_i(x)
                \psi_i(x)
                =
                \braket*{\psi_i}{\psi_i}
                = \lambda_i
                > 0,
            \end{align}
            as the normalization of $\psi_i$ dictates that the inner product with
            itself must be greater than zero.
            This demonstrates that $\overlapmat$ is positive definite.
        \end{proof}
        Now, as $\overlapmat$ is positive definite, we have that the eigenvalues
        $\lambda_i > 0$.

    \section{Orbital rotations}
        \label{sec:orbital-rotations}
        We prove \autoref{lemma:unitary-transformation-slater}.
        \begin{proof}
            Let $\brac{\phi_i}$ be an orthonormal basis of $L$
            atomic orbitals.
            We can then do a unitary transformation from this basis to a new
            basis $\brac{\psi_i}$ of $L$ single-particle states by
            \begin{align}
                \ket*{\psi_i} = U_{ji}\ket*{\phi_j},
                \label{eq:unitary_transformation}
            \end{align}
            where $U_{ji}$ is an element in the unitary matrix $\vfg{U} \in
            \mathbb{C}^{L \times L}$.
            For a set of coordinates $\vfg{x} = \brac{x_1, \dots, x_N}$, we
            write
            \begin{align}
                \psi_{ij} \equiv \psi_j(x_i)
                = \braket*{x_i}{\psi_j},
            \end{align}
            and equivalently for $\phi_{ij}$. Projecting onto the coordinate
            basis we can write \autoref{eq:unitary_transformation} as
            \begin{gather}
                \psi_{ki} = U_{ji}\phi_{kj}
                \implies
                \vfg{\Psi} = \vfg{\Phi}\vfg{U},
            \end{gather}
            where the matrices $\vfg{\Psi}$, $\vfg{\Phi}$, and $\vfg{U}$ are
            the matrices with elements
            \begin{align}
                \vfg{\Psi}
                &= \begin{pmatrix}
                    \psi_{11} & \psi_{12} & \dots & \psi_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    \psi_{N1} & \psi_{N2} & \dots & \psi_{NN}
                \end{pmatrix}, \\
                \vfg{\Phi}
                &= \begin{pmatrix}
                    \phi_{11} & \phi_{12} & \dots & \phi_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    \phi_{N1} & \phi_{N2} & \dots & \phi_{NN}
                \end{pmatrix}, \\
                \vfg{U}
                &= \begin{pmatrix}
                    U_{11} & U_{12} & \dots & U_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    U_{N1} & U_{N2} & \dots & U_{NN}
                \end{pmatrix}.
            \end{align}
            The Slater determinants projected onto the coordinates $\vfg{x}$
            can now be found by
            \begin{align}
                \Psi(\vfg{x})
                = \braket*{\vfg{x}}{\Psi}
                = \frac{1}{\sqrt{N!}}\det(\vfg{\Psi}),
            \end{align}
            and similarly for $\Phi(\vfg{x})$.
            We can now write the unitary transformation from $\Phi(\vfg{x})$
            to $\Psi(\vfg{x})$ as
            \begin{align}
                \Psi(\vfg{x})
                = \frac{1}{\sqrt{N!}}
                \det(\vfg{U}\vfg{\Phi})
                = \det(\vfg{U})\Phi(\vfg{x}),
            \end{align}
            where we used that the determinant of a product is the product
            of the determinants.
            Since $\vfg{U}$ is unitary we have that the squared determinant
            of $\vfg{U}$ will $1$, as can be seen by using the product rule
            of determinants described above.
            This means that
            \begin{align}
                \det(\vfg{U}) = \exp[i\phi],
            \end{align}
            that is, the determinant of a unitary matrix becomes a complex
            phase factor.
            In other words, $\Psi(\vfg{x})$ will differ from $\Phi(\vfg{x})$
            by at most a complex phase factor and
            \begin{align}
                \braket*{\Psi}
                = \norm{\det(U)}^2\braket*{\Phi}
                = \braket*{\Phi}
                = \1,
            \end{align}
            and the lemma is proved.
        \end{proof}


    \section{Deriving the reference energy}
        \label{sec:deriving-the-reference-energy}
        Let $\brac{\phi_p}$ be an orthonormal basis of $L$ single-particle
        states with the $N$ first states occupied in the reference state
        $\ket*{\slat}$, we compute the reference energy from
        \autoref{eq:reference-energy}.
        We use Wick's theorem with normal ordering relative to the Fermi vacuum,
        that is, we treat the reference state as our vacuum state.
        Starting with the one-body operator, we get
        \begin{align}
            \onehamil
            &=
            \oneten^{p}_{q}
            \ccr{p}
            \can{q}
            =
            \oneten^{p}_{q}
            \para{
                \normalord{
                    \ccr{p}
                    \can{q}
                }
                +
                \wick{
                    \c {\ccr{p}}
                    \c {\can{q}}
                }
            }
            =
            \oneten^{p}_{q}
            \normalord{
                \ccr{p}
                \can{q}
            }
            +
            \oneten^{p}_{q}
            \delta_{p \in O}
            \delta_{pq},
            \label{eq:one-hamil-wick}
        \end{align}
        where we use $\delta_{p \in O}$ to denote that the general index
        $p$ must be contained in the set of occupied indices $O = \brac{1,
        \dots, N}$.
        This notation is similar to the one used by
        \citeauthor{crawford2000introduction} in
        \citetitle{crawford2000introduction}\cite{crawford2000introduction}.
        We call the first term, the \emph{normal-ordered one-body Hamiltonian},
        \begin{align}
            \onehamil_N \equiv \oneten^{p}_{q}\normalord{
                \ccr{p}
                \can{q}
            }.
            \label{eq:one-hamil-normal}
        \end{align}
        Computing the expectation value of the one-body Hamiltonian on the
        reference state, we get
        \begin{align}
            \mel*{\slat}{\onehamil}{\slat}
            =
            \mel*{\slat}{\onehamil_N}{\slat}
            +
            \oneten^{p}_{q}
            \delta_{p \in O}
            \delta_{pq}
            \braket*{\slat}{\slat}
            = 0 + \oneten^{i}_{i}.
        \end{align}
        To see why the former term becomes zero, we have to consider the four
        combinations of indices that can be summed over in the operators.
        From \autoref{subsec:fermi-vacuum} we know that only terms with both
        occupied or both virtual indices will contribute to the expectation
        value.
        As the operators are normal-ordered relative to the Fermi vacuum they
        will destroy the reference state by either creating a particle that is
        already present in the reference state, or destroying a particle that is
        not in the reference state.
        The expectation value of the two-body term is given by
        \begin{align}
            \mel*{\slat}{\twohamil}{\slat}
            &=
            \frac{1}{4}u^{pq}_{rs}
            \mel*{\slat}{\ccr{p}\ccr{q}\can{s}\can{r}}{\slat}.
        \end{align}
        For brevity, we will only write out the operator strings.
        \begin{align}
            \ccr{p}\ccr{q}\can{s}\can{r}
            &=
            \wick{
                \c1 {\ccr{p}}
                \c2 {\ccr{q}}
                \c1 {\can{s}}
                \c2 {\can{r}}
            }
            +
            \wick{
                \c2 {\ccr{p}}
                \c1 {\ccr{q}}
                \c1 {\can{s}}
                \c2 {\can{r}}
            }
            + \normalord{
                \wick{
                    \c {\ccr{p}}
                    {\ccr{q}}
                    \c {\can{s}}
                    {\can{r}}
                }
            }
            + \normalord{
                \wick{
                    \c {\ccr{p}}
                    {\ccr{q}}
                    {\can{s}}
                    \c {\can{r}}
                }
            }
            \nonumber \\
            &\qquad
            + \normalord{
                \wick{
                    {\ccr{p}}
                    \c {\ccr{q}}
                    \c {\can{s}}
                    {\can{r}}
                }
            }
            + \normalord{
                \wick{
                    {\ccr{p}}
                    \c {\ccr{q}}
                    {\can{s}}
                    \c {\can{r}}
                }
            }
            + \normalord{
                {\ccr{p}}
                {\ccr{q}}
                {\can{s}}
                {\can{r}}
            }
            \\
            &=
            -\delta_{p \in O}
            \delta_{q \in O}
            \delta_{ps}
            \delta_{qr}
            + \delta_{p \in O}
            \delta_{q \in O}
            \delta_{pr}
            \delta_{qs}
            - \delta_{p \in O}
            \delta_{ps}
            \normalord{
                \ccr{q}
                \can{r}
            }
            \nonumber \\
            &\qquad
            + \delta_{p \in O}
            \delta_{pr}
            \normalord{
                \ccr{q}
                \can{s}
            }
            + \delta_{q \in O}
            \delta_{qs}
            \normalord{
                \ccr{p}
                \can{r}
            }
            - \delta_{q \in O}
            \delta_{qr}
            \normalord{
                \ccr{p}
                \can{s}
            }
            \nonumber \\
            &\qquad
            + \normalord{
                {\ccr{p}}
                {\ccr{q}}
                {\can{s}}
                {\can{r}}
            }.
            \label{eq:two-hamil-op-wick}
        \end{align}
        For the same reason as with the expectation value of the one-body
        operator, all terms with a normal-ordered pair of creation and
        annihilation operators will be zero.
        This means that we are left with the two fully contracted terms and the
        normal-ordered product with two pairs of creation and annihilation
        operators.
        We note that there exists a combination of indices which will \emph{not}
        destroy the reference even though the operators are normal-ordered.
        This occurs when both creation operators act on virtual states and the
        two annihilation operators act on occupied states, viz.
        \begin{align}
            \normalord{
                {\ccr{a}}
                {\ccr{b}}
                {\can{j}}
                {\can{i}}
            }
            \ket*{\slat}
            = A\ket*{\slat^{ab}_{ij}},
        \end{align}
        where $A$ is some phase factor.
        In other words, this combination of operators will leave the reference
        state excited, but due to the orthonormality of the basis states, the
        overlap between the reference state and the excited state will be zero.
        We are thus left with
        \begin{align}
            \mel*{\slat}{\twohamil}{\slat}
            &=
            \frac{1}{4}\twoten^{pq}_{rs}\brac{
                -\delta_{p \in O}
                \delta_{q \in O}
                \delta_{ps}
                \delta_{qr}
                + \delta_{p \in O}
                \delta_{q \in O}
                \delta_{pr}
                \delta_{qs}
            }\braket*{\slat}{\slat}
            \\
            &=
            -\frac{1}{4} \twoten^{ij}_{ji}
            + \frac{1}{4} \twoten^{ij}_{ij}
            = \half \twoten^{ij}_{ij},
        \end{align}
        where we've used the anti-symmetry of the two-body tensor to collect the
        two remaining terms, that is, $\twoten^{ij}_{ij} =-\twoten^{ij}_{ji}$.
        In total we are left with the reference energy of the electronic
        Hamiltonian
        \begin{align}
            \energyref
            &=
            \mel*{\slat}{\hamil}{\slat}
            =
            \mel*{\slat}{\onehamil}{\slat}
            + \mel*{\slat}{\twohamil}{\slat}
            =
            \oneten^{i}_{i}
            + \half \twoten^{ij}_{ij},
        \end{align}
        which is what we wanted to show.

    \section{The normal-ordered Hamiltonian}
        \label{app:normal-ordered-hamiltonian}
        Given an orthonormal basis of $L$ single-particle states
        $\brac{\phi_p}$, with the $N$ first states occupied in the reference
        state $\ket*{\slat}$, we can construct the normal-ordered Hamiltonian,
        $\hamil_N$, relative to the Fermi vacuum by using Wick's theorem.
        Starting with the one-body Hamiltonian, we know from
        \autoref{eq:one-hamil-wick} that we can write the one-body Hamiltonian
        as
        \begin{align}
            \onehamil = \onehamil_N + \oneten^{i}_{i},
        \end{align}
        where $\onehamil_N$ is the normal-ordered one-body Hamiltonian from
        \autoref{eq:one-hamil-normal}.
        For the two-body operator, we use \autoref{eq:two-hamil-op-wick} and
        perform the summation.
        This gives
        \begin{align}
            \twohamil
            &=
            - \frac{1}{4}\twoten^{ij}_{ji}
            + \frac{1}{4}\twoten^{ij}_{ij}
            - \frac{1}{4}\twoten^{iq}_{ri}\normalord{
                \ccr{q}
                \can{r}
            }
            + \frac{1}{4}\twoten^{iq}_{is}\normalord{
                \ccr{q}
                \can{s}
            }
            \nonumber \\
            &\qquad
            + \frac{1}{4}\twoten^{pj}_{rj}\normalord{
                \ccr{p}
                \can{r}
            }
            - \frac{1}{4}\twoten^{pj}_{js}\normalord{
                \ccr{p}
                \can{s}
            }
            + \frac{1}{4}\twoten^{pq}_{rs}\normalord{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        Using the antisymmetric properties of the antisymmetric two-body
        matrix elements,
        \begin{align}
            \twoten^{pq}_{rs}
            =
            -\twoten^{qp}_{rs}
            =
            -\twoten^{pq}_{sr}
            =
            \twoten^{qp}_{sr},
        \end{align}
        and relabeling some of the indidces, we can collect terms and rewrite
        the two-body operator to
        \begin{align}
            \twohamil
            &=
            \half \twoten^{ij}_{ij}
            + \twoten^{pi}_{qi}\normalord{
                \ccr{p}
                \can{q}
            }
            + \twohamil_N.
        \end{align}
        Here we have introduced the \emph{normal-ordered two-body operator} to
        be
        \begin{align}
            \twohamil_N
            &\equiv
            \frac{1}{4}\twoten^{pq}_{rs}\normalord{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        Combining the one- and two-body operators, we get the full Hamiltonian
        \begin{align}
            \hamil
            &=
            \onehamil + \twohamil
            =
            \oneten^{i}_{i}
            + \half \twoten^{ij}_{ij}
            + \para{
                \oneten^{p}_{q}
                +
                \twoten^{pi}_{qi}
            }
            \normalord{
                \ccr{p}
                \can{q}
            }
            +
            \frac{1}{4}\twoten^{pq}_{rs}
            \normalord{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            },
        \end{align}
        where we've collected the constant terms, the one-body terms and the
        two-body term.
        We recognize the two first constant terms as the reference energy from
        \autoref{eq:reference-energy}.
        The two next terms constitute the normal-ordered Fock operator given by
        \begin{align}
            \fock_N
            &\equiv
            \para{
                \oneten^{p}_{q}
                +
                \twoten^{pi}_{qi}
            }
            \normalord{
                \ccr{p}
                \can{q}
            }
            \equiv
            \fockten^{p}_{q}
            \normalord{
                \ccr{p}
                \can{q}
            }.
        \end{align}
        Inserted into the full Hamiltonian we are able to discern the
        normal-ordered Hamiltonian.
        \begin{align}
            \hamil
            &=
            \energyref
            +
            \fock_N
            +
            \twohamil_N
            \equiv
            \energyref
            +
            \hamil_N.
        \end{align}
        In terms of the second quantized operator the normal-ordered Hamiltonian
        is given by
        \begin{align}
            \hamil_N
            &=
            \fock_N + \twohamil_N
            =
            \fockten^{p}_{q}\normalord{
                \ccr{p}
                \can{q}
            }
            +
            \frac{1}{4}
            \twoten^{pq}_{rs}\normalord{
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r}
            }.
        \end{align}
        The normal-ordered Hamiltonian relative to the Fermi vacuum is defined
        in such a manner that
        \begin{align}
            \mel*{\slat}{\hamil_N}{\slat}
            = \mel*{\slat}{\fock_N}{\slat}
            + \mel*{\slat}{\twohamil_N}{\slat}
            = 0.
        \end{align}
        You can convince yourself of this by noting that the only terms that
        do not destroy the reference state must leave it excited.
        For an orthonormal basis of Slater determinants, this will necessarily
        leave the overlap between the reference state and an excited state zero.

    \section{Many-body operators in second quantization}
        \label{app:operator-representation}
        We will in this section demonstrate the representation of the one- and
        two-body operators as matrix elements of single-particle functions and
        second quantized operators.
        We let $\hat{Q}_1$ be a one-body operator acting on a single
        single-particle state at a time,
        \begin{align}
            \hat{Q}_1
            = \sum_{i = 1}^{N}\hat{q}(i),
        \end{align}
        where $\hat{q}(i)$ acts on particle state $i$ and ignores the other
        states.
        As a tensor product we can write this particular operator by
        \begin{align}
            \hat{q}(i)
            = \1\otimes
            \dots\otimes\hat{q}\otimes\dots\otimes\1
            = \1^{\otimes (i - 1)}
            \otimes\hat{q}
            \otimes\1^{\otimes (N - (i + 1))}
            \label{eq:tensor-one-body}
        \end{align}
        that is, a tensor product of identity operators except for position $i$
        where the one-body operator $\hat{q}$ is located.
        Let $\brac{\phi_p}$ be a basis of $L$ single-particle states.
        We can then find the action of $\hat{q}$ on a single-particle state,
        \begin{align}
            \hat{q}\ket*{\phi_i}
            = \sum_{p = 1}^{L}\ket*{\phi_{p}}\mel*{\phi_p}{\hat{q}}{\phi_i}
            \equiv \sum_{p = 1}^{L} q^{p}_{i}\ket*{\phi_p},
        \end{align}
        where we've used the resolution of the identity.
        Furthermore, we've re-instated explicit sums for the moment to avoid
        confusion.
        As the one-body operator acts on a single single-particle state at a
        time, the operator will commute with the permutation operator
        $\hat{P}_{\sigma}$.
        We can construct an $N$-particle Slater determinant by the
        antisymmetrizer $\hat{A}$ shown in
        \autoref{eq:slater-determinant-abstract}.
        Acting with $\hat{Q}_1$ on the Slater determinant, we get
        \begin{align}
            \hat{Q}_1\ket*{\slat}
            &=
            \hat{Q}_1\ket*{\phi_1\dots\phi_N}
            =
            \frac{1}{\sqrt{N!}}
            \sum_{\sigma \in S_N}
            (-1)^{\abs{\sigma}}
            \hat{P}_{\sigma}
            \sum_{i = 1}^{N}\hat{q}(i)
            \bigotimes_{j = 1}^{N}
            \ket*{\phi_j},
        \end{align}
        where we've moved the one-body operator to the far right.
        We've also represented the Slater determinant as a single ket with the
        occupied single-particle states inside, similar to the occupation number
        representation in the section on Fock space.
        Concentrating on the action of the one-body operator on the product
        state, we can write
        \begin{align}
            \sum_{i = 1}^{N}\hat{q}(i)
            \bigotimes_{j = 1}^{N}
            \ket*{\phi_j}
            =
            \sum_{i = 1}^{N}
            \sum_{p = 1}^{L}
            q^{p}_{i}
            \para{
                \bigotimes_{j = 1}^{i - 1}
                \ket*{\phi_j}
            }
            \otimes \ket*{\phi_p}
            \otimes \para{
                \bigotimes_{j = i + 1}^{N}
                \ket*{\phi_j}
            },
        \end{align}
        where the single-particle state $\ket*{\phi_i}$ has been replaced in the
        product state by the single-particle state $\ket*{\phi_p}$.
        Moving the matrix elements outside the antisymmetrizer we get a sum over
        Slater determinants which we write
        \begin{align}
            \hat{Q}_1\ket*{\slat}
            &=
            \sum_{p = 1}^{L}
            \sum_{i = 1}^{N}q^{p}_{i}
            \ket*{\phi_1\dots\phi_p\dots\phi_N},
        \end{align}
        where the placement of $\phi_p$ depends on the index $i$ as we replace
        $\phi_i$ with $\phi_p$.
        This means that we ignore the canonical ordering of the determinants for
        now, but this can be included after $\phi_p$ has been inserted.
        We will however not sort the state after the removal and insertion of a
        new single-particle state.
        Having moved the matrix elements of $\hat{q}(i)$ outside the
        antisymmetrizer we see that
        \begin{align}
            \ket*{\phi_1\dots\phi_{i - 1}\phi_p\phi_{i + 1}\dots\phi_N}
            = \ccr{p}\can{i}\ket*{\phi_1\dots\phi_N}
            = \ccr{p}\can{i}\ket*{\slat}
            = \ccr{p}\can{q}\ket*{\slat},
        \end{align}
        where we in the last equality used that $\can{a}\ket*{\slat} = 0$ using
        the Fermi vacuum formalism and therefore $\can{i}\ket*{\slat} =
        \can{q}\ket*{\slat}$.
        We also see that the sum over $p$ is independent of the sum over
        $q$ (where we went from $i \to q$), and we write
        \begin{align}
            \hat{Q}_1\ket*{\slat}
            = \sum_{p = 1}^{L}\sum_{q = 1}^{L}q^{p}_{q}
            \ccr{p}\can{q}\ket*{\slat},
        \end{align}
        Removing the explicit sums and extracting the operator without the
        reference determinant, we then have
        \begin{align}
            \hat{Q}_1 = q^{p}_{q}\ccr{p}\can{q},
        \end{align}
        where the matrix elements $q^{p}_{q}$ can be found in a basis of given
        single-particle states $\phi_p$ by
        \begin{align}
            q^{p}_{q}
            \equiv
            \mel*{\phi_p}{\hat{q}}{\phi_q}
            = \int\dd x\phi^{*}_{p}(x)\hat{q}\phi_{q}(x),
        \end{align}
        which is what we wanted to show.

        The two-body operator $\hat{Q}_2$ is given by
        \begin{align}
            \hat{Q}_2
            = \sum_{i < j}^{N}
            \hat{q}(i, j),
        \end{align}
        where the sum runs over all pairs $(i, j)$ for $N$ particles and we
        treat $i < j$.
        The two-body operator is harder to represent in an explicit tensor
        representation as opposed to the one-body operator in
        \autoref{eq:tensor-one-body}.
        This is due to there being two operators acting on two separate
        single-particle states, but the results being connected.
        We will therefore describe the action of the two-body operator on a
        product state of two single-particle states by
        \begin{align}
            \hat{q}(i, j)\ket*{\phi_i}\otimes\ket*{\phi_j}
            = \sum_{p, q = 1}^{L}
            q^{pq}_{ij}
            \ket*{\phi_p}\otimes\ket*{\phi_q},
        \end{align}
        where we've used the resolution of the identity for both single-particle
        states in the product state.
        The two-body matrix elements are given by
        \begin{align}
            q^{pq}_{ij}
            &\equiv
            \mel*{\phi_p\phi_q}{\hat{q}(i, j)}{\phi_i\phi_j}
            \\
            &=
            \int\dd x_1 \dd x_2
            \phi^{*}_{p}(x_1)\phi^{*}_{q}(x_2)
            \hat{q}(i, j)
            \phi_i(x_1)\phi_j(x_2),
        \end{align}
        where some care must be shown for the notation of the matrix elements in
        the definition of the two-body elements as we use $\ket*{\phi_i\phi_j} =
        \ket*{\phi_i}\otimes\ket*{\phi_j}$ to denote a product state in the matrix
        elements.
        However, outside the matrix elements, this notation will denote a Slater
        determinant in the occupation number representation.
        Note the symmetry of the integral that
        \begin{align}
            q^{pq}_{ij} = q^{qp}_{ji},
            \label{eq:symmetry-two-body}
        \end{align}
        as the ordering of the two integrals is arbitrary.
        The two-body operator will also commute with the permutation operator
        $\hat{P}_{\sigma}$ as the ordering of the pairs does not matter when all
        pairs are included.
        The action of the two-body operator on a Slater determinant can thus be
        written
        \begin{align}
            \hat{Q}_2\ket*{\slat}
            = \sum_{i < j}^{N}\sum_{p, q = 1}^{L}
            q^{pq}_{ij}\ket*{\phi_1\dots\phi_p\dots\phi_q\dots\phi_N},
            \label{eq:temp-action-two-body}
        \end{align}
        where $\phi_p$ is at position $i$ and $\phi_q$ at $j$.
        Again we ignore canonical ordering after the new single-particle states
        have been inserted.
        From \autoref{eq:temp-action-two-body} we see that the insertion and
        removal of the single-particle states can be described by the second
        quantized operator string $\ccr{p}\ccr{q}\can{j}\can{i}$ as we first
        remove single-particle state $\phi_i$, then $\phi_j$ before inserting
        $\phi_q$ and then $\phi_p$.\footnote{%
            Note the ordering of the annihilation operators.
        }
        This ensures that after the total operator string has been evaluated, no
        sign-change has occured.
        Now, including $i = j$ introduces no extra elements as $\can{j}\can{i}$
        will destroy the reference determinant.
        Furthermore, due to the symmetry of the two-body elements from
        \autoref{eq:symmetry-two-body} we have that including $i > j$ in the
        summation will introduce double counting of the same states as for $i <
        j$ thus this can be added at the cost of a factor $1/2$.
        Finally, as in the case of the one-body operators, changing the limit on
        the sum over $i$ and $j$ from $N$ to $L$ will not introduce any new
        elements as $\can{r}\can{s}$ will destroy the reference whenever $r > N$
        and $s > N$.
        In total we can then write the action of the two-body operator on a
        Slater determinant,
        \begin{align}
            \hat{Q}_2\ket*{\slat}
            = q^{pq}_{rs} \ccr{p}\ccr{q}\can{s}\can{r}\ket*{\slat},
        \end{align}
        where we've removed the explicit summations and all sums run over the
        entire number of basis states.
        Without the determinant we have the operator given by
        \begin{align}
            \hat{Q}_2
            = q^{pq}_{rs}\ccr{p}\ccr{q}\can{s}\can{r},
        \end{align}
        which is the same form as in the second term of
        \autoref{eq:many-body-operator}.

    %\section{Deriving the dimensionless Hamiltonian}
    %    \label{app:two-dim-ho-dimensionless}
    %    In \autoref{subsec:two-dim-ho} we introduced the dimensionless form of
    %    the two-dimensional harmonic oscillator \cite{anisimovas1998energy}.
    %    Here we will show the steps involved in the derivation to make the
    %    Hamiltonian dimensionless.
    %    Introducing the dimensionless position $\vfg{r}'$ given by
    %    \begin{align}
    %        \vfg{r} = a \vfg{r}',
    %    \end{align}
    %    where $a$ is the scaling radius given by \autoref{eq:bohr-radius}.
    %    Inserting the dimensionless position into the Hamiltonian from
    %    \autoref{eq:two-dim-ho-hamiltonian} we find for the Laplace operator in
    %    polar coordinates $\vfg{r} = (r, \phi)$,
    %    \begin{align}
    %        \vfg{\nabla}^2
    %        &= \frac{1}{r}\dpd{}{r}\para{
    %            r\dpd{}{r}
    %        }
    %        + \frac{1}{r^2}\dpd[2]{}{\phi}
    %        \\
    %        &= \frac{1}{a r'}\frac{1}{a}\dpd{}{r'}\para{
    %            a r' \frac{1}{a}\dpd{}{r'}
    %        }
    %        + \frac{1}{a^2 r^2}\dpd[2]{}{\phi}
    %        = \frac{1}{a^2}\para{\vfg{\nabla}'}^2,
    %    \end{align}
    %    where we've dropped the particle indices for the sake of brevity.
    %    Thus, the one-body part of the Hamiltonian becomes
    %    \begin{align}
    %        \oneten(\vfg{r})
    %        = -\frac{\hslash^2}{2m a^2}\para{\vfg{\nabla}'}^2
    %        + \half m \omega^2 a^2 \para{\vfg{r}'}^2
    %        = \frac{\hslash\omega}{2}\brak{
    %            -\para{\vfg{\nabla}'}^2
    %            + \para{\vfg{r}'}^2
    %        }.
    %    \end{align}
    %    The Coulomb interaction becomes
    %    \begin{align}
    %        \twoten(\vfg{r}_i, \vfg{r}_j)
    %        &= \frac{e^2}{4\pi\epsilon_0 \abs{\vfg{r}_i - \vfg{r}_j}}
    %        = \frac{e^2}{4\pi \epsilon_0 a}
    %        \frac{1}{\abs{\vfg{r}_i' - \vfg{r}_j'}}.
    %    \end{align}
    %    Thus, the full dimensionless Hamitonian becomes
    %    \begin{align}
    %        \hamilten(\vfg{r})
    %        = \frac{\hslash\omega}{2} \sum_{i = 1}^{N}\brak{
    %            -\vfg{\nabla}^2_i
    %            + \vfg{r}^2_i
    %        }
    %        + \hslash \omega \lambda
    %        \sum_{i < j}^{N} \frac{1}{\abs{\vfg{r}_i - \vfg{r}_j}},
    %    \end{align}
    %    where $\lambda$ is defined as in \autoref{eq:two-dim-ho-lambda}.
    %    This is the form of the Hamiltonian we wanted to show.

    %\section{Two-dimensional harmonic oscillator spectrum}
    %    \label{app:tdho-spectrum}
    %    In this section we discuss how we can find the spectrum of the
    %    non-interacting two-dimensional harmonic oscillator with the
    %    dimensionless Hamiltonian given in
    %    \autoref{eq:tdho-one-body-hamiltonian}.
    %    In order to solve the time-independent Schrödinger equation
    %    \begin{align}
    %        \oneten(\vfg{r})\psi(\vfg{r}) = \epsilon \psi(\vfg{r}),
    %    \end{align}
    %    we assume a separable solution in polar coordinates to be given by
    %    \begin{align}
    %        \psi(\vfg{r}) = \psi(r, \phi)
    %        = R(r)\Phi(\phi),
    %    \end{align}
    %    where we ignore the normalization condition for now.
    %    Inserted into the one-body Hamiltonian and collecting terms we get
    %    \begin{gather}
    %        -\frac{\Phi}{r}\dpd{}{r}\para{
    %            r\dpd{}{r}
    %        }R
    %        - \frac{R}{r^2}\dpd[2]{}{\phi}\Phi
    %        + r^2 R \Phi = \epsilon R \Phi,
    %    \end{gather}
    %    where we've expressed the Laplace operator in polar coordinates.
    %    Next we divide by $R\Phi$ on both sides and multiply by $-r^2$.
    %    This yields
    %    \begin{gather}
    %        \frac{r}{R}\dpd{}{r}\para{
    %            r\dpd{}{r}
    %        } R
    %        + \frac{1}{\Phi}
    %        \dpd[2]{}{\phi}
    %        \Phi
    %        - r^2\brak{
    %            r^2 - \epsilon
    %        }
    %        = 0,
    %    \end{gather}
    %    which has now been reduced to two separate differential equations as
    %    we've decoupled radial and the azimuthal dependence.
    %    Introducing a dependent variable $m^2$ we can write the two equations
    %    as
    %    \begin{gather}
    %        \frac{1}{\Phi}\dod[2]{}{\phi}\Phi = -m^2,
    %        \label{eq:tdho-angular-eq}
    %        \\
    %        \frac{r}{R}\dod{}{r}\para{
    %            r\dod{}{r}
    %        }R
    %        - r^2 \brak{
    %            r^2 - \epsilon
    %        }
    %        = m^2.
    %        \label{eq:tdho-radial-eq}
    %    \end{gather}
    %    We recognize \autoref{eq:tdho-angular-eq} as the azimuthal equation from
    %    solving the Schrödinger equation in three dimensions
    %    \cite{griffiths2017introduction}.
    %    This solution can be expressed as
    %    \begin{align}
    %        \Phi(\phi) &= \exp[im\phi],
    %    \end{align}
    %    where we absorb the constant term into the normalization of the wave
    %    function which we solve in the end.
    %    Furthermore, by allowing $m$ to be negative we can avoid including the
    %    negative frequency solutions $\exp{-im\phi}$
    %    \cite{griffiths2017introduction}.

    %    For the radial equation in \autoref{eq:tdho-radial-eq} we start by doing
    %    a variable substitution \cite{439282}.
    %    As $r \geq 0$ we define $r^2 \equiv \rho$ which yields
    %    \begin{align}
    %        r\dod{}{r} = r\dod{\rho}{r}\dod{}{\rho}
    %        = 2r^2\dod{}{\rho}
    %        = 2\rho\dod{}{\rho},
    %    \end{align}
    %    and for the full Laplace operator
    %    \begin{align}
    %        r\dod{}{r}\para{r \dod{}{r}}
    %        &= 2r\dod{}{r}\para{\rho\dod{}{\rho}}
    %        = 2r\para{
    %            \dod{\rho}{r}\dod{}{\rho}
    %            + \rho\dod{\rho}{r}\dod[2]{}{\rho}
    %        }
    %        \\
    %        &= 4\rho\dod{}{\rho} + 4\rho^2\dod[2]{}{\rho}.
    %    \end{align}
    %    Now the radial equation in \autoref{eq:tdho-radial-eq} can be written
    %    \begin{align}
    %        \frac{4\rho}{R}\dod{R}{\rho}
    %        + \frac{4\rho^2}{R}\dod[2]{R}{\rho}
    %        - \rho\brak{
    %            \rho - \epsilon
    %        } = m^2.
    %    \end{align}
    %    Dividing through by $4\rho^2/R$ and moving the constant $m^2$ over to
    %    the left-hand side we get
    %    \begin{align}
    %        \dod[2]{R}{\rho}
    %        + \frac{1}{\rho}\dod{R}{\rho}
    %        - \frac{1}{4\rho}\brak{
    %            \rho
    %            - \epsilon
    %            + \frac{m^2}{\rho}
    %        }R = 0
    %        \label{eq:tdho-radial-sub}
    %    \end{align}
    %    A solution to this equation is given by \cite{439282,
    %    sandev2005selection}
    %    \begin{align}
    %        R(\rho)
    %        = \rho^{\abs{m}/2}
    %        \exp[-\rho/2]
    %        L(\rho),
    %    \end{align}
    %    where $L(\rho)$ is some function of $\rho$.
    %    Computing the derivatives of $R(\rho)$ with respect to $\rho$ we get
    %    \begin{gather}
    %        \dod{R}{\rho}
    %        = \rho^{\abs{m}/2} \exp[-\rho/2]\brak{
    %            \frac{\abs{m}}{2\rho}
    %            - \half
    %            + \dod{}{\rho}
    %        }L(\rho),
    %        \\
    %        \dod[2]{R}{\rho}
    %        = \rho^{\abs{m}/2} \exp[-\rho/2]\brak{
    %            \frac{\abs{m}}{2\rho}
    %            - \half
    %            + \dod{}{\rho}
    %        }^2 L(\rho),
    %    \end{gather}
    %    where it is understood that the differential operator acts on everything
    %    to its right, including the use of the product rule.
    %    This means that unpacking the paranthesis for the second order
    %    derivative must be done with some care.
    %    Inserted into \autoref{eq:tdho-radial-sub} and dividing through by the
    %    two first factors, we get
    %    \begin{align}
    %        \brak{
    %            \frac{\abs{m}}{2\rho}
    %            - \half
    %            + \dod{}{\rho}
    %        }^2
    %        L(\rho)
    %        &+ \frac{1}{\rho}
    %        \brak{
    %            \frac{\abs{m}}{2\rho}
    %            - \half
    %            + \dod{}{\rho}
    %        }
    %        L(\rho)
    %        \nonumber \\
    %        &\qquad
    %        - \frac{1}{4\rho}\brak{
    %            \rho
    %            - \epsilon
    %            + \frac{m^2}{\rho}
    %        }
    %        L(\rho)
    %        = 0.
    %    \end{align}
    %    Expanding the paranthesis and collecting terms we are left with
    %    \begin{align}
    %        \dod[2]{L}{\rho}
    %        + \frac{1}{\rho}\brak{
    %            1 - \rho + \abs{m}
    %        }\dod{L}{\rho}
    %        + \frac{1}{2\rho}\brak{
    %            \frac{\epsilon}{2}
    %            - (\abs{m} + 1)
    %        }L
    %        = 0.
    %    \end{align}
    %    Finally, multiplying by $\rho$ we get
    %    \begin{align}
    %        \rho\dod[2]{L}{\rho}
    %        + \brak{
    %            \abs{m}+ 1 - \rho
    %        }\dod{L}{\rho}
    %        + \frac{1}{2}\brak{
    %            \frac{\epsilon}{2}
    %            - (\abs{m} + 1)
    %        }L
    %        = 0,
    %    \end{align}
    %    we recognize this as the differential equation where the
    %    \emph{associated Laguerre polynomials}\footnote{%
    %        Also known as the \emph{generalized Laguerre polynomial}.
    %    } are the solutions as long as the requirement
    %    \begin{align}
    %        n \equiv \half\brak{
    %            \frac{\epsilon}{2}
    %            - (\abs{m} + 1)
    %        } \geq 0,
    %    \end{align}
    %    with $n \in \mathbb{N}$ is upheld \cite{laguerre-polynomials}.
    %    This automatically sets some restrictions on the values of $m$ and
    %    $\epsilon$ as both will have to have integer values, with $\epsilon \in
    %    \mathbb{N}$, and $m \in \mathbb{Z}$ as the absolute value ensures that
    %    negative integers are allowed.
    %    Substituting back to the regular radius $r$ we have the solution to the
    %    radial equation as
    %    \begin{align}
    %        R_{nm}(r)
    %        = r^{\abs{m}} \exp[-r^2 / 2]
    %        L^{\abs{m}}_{n}(r^2),
    %    \end{align}
    %    where the \emph{Rodrigues formula} for the associated Laguerre
    %    polynomials can be written
    %    \begin{align}
    %        L^{\abs{m}}_{n}(r^2)
    %        &= \frac{r^{-2\abs{m}}}{n!}
    %        \para{
    %            \frac{1}{2r}
    %            \dod{}{r}
    %            - 1
    %        }^{n}
    %        r^{2(n + \abs{m})}.
    %    \end{align}
    %    Note that formula looks a little extra messy with the squared argument,
    %    but luckily for us, we only need to call this function using SymPy
    %    \cite{sympy}, which handles all the messy parts.
    %    % TODO: Discuss orthonormality of the radial equation.
    %    % TODO: Introduce the normalization constant.

    %\section{Two-dimensional harmonic oscillator dipole}
    %    \label{app:tdho-dipole}
    %    Starting with \autoref{eq:cos-integral-tdho} we can write
    %    \begin{align}
    %        \mathcal{C}_{ij}
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd \phi
    %        \cos(\phi)
    %        \exp[-i\Delta m_{ij} \phi],
    %    \end{align}
    %    where we use the definition of the difference in the azimuthal quantum
    %    from \autoref{eq:diff-m-tdqd}.
    %    The closed form solution to this integral is
    %    \begin{align}
    %        \mathcal{C}_{ij}
    %        &= \brak{
    %            \frac{\exp[-i\Delta m_{ij} \phi]}{1 - (\Delta m_{ij})^2}
    %            \brak{
    %                -i\Delta m_{ij} \cos(\phi)
    %                + \sin(\phi)
    %            }
    %        }_{0}^{2\pi}
    %        = 0,
    %        \label{eq:dipole-x-tdqd}
    %    \end{align}
    %    if $\Delta m_{ij} \neq \pm 1$.
    %    For the case when $\Delta m_{ij} = \pm 1$ we solve the easier
    %    integral
    %    \begin{align}
    %        \mathcal{C}_{ij}
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd \phi
    %        \cos(\phi) \exp[\mp i\phi]
    %        \\
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd \phi
    %        \para{
    %            \cos^2(\phi)
    %            \mp i\cos(\phi)\sin(\phi)
    %        }
    %        = \pi.
    %    \end{align}
    %    For the sine integral in \autoref{eq:sin-integral-tdho} we have
    %    \begin{align}
    %        \mathcal{S}_{ij}
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd\phi
    %        \sin(\phi)
    %        \exp[-i\Delta m_{ij} \phi].
    %    \end{align}
    %    The closed form solution of this integral is similar to the form for
    %    the cosine-integral.
    %    Again we look at the situation when $\Delta m_{ij} \neq \pm 1$
    %    initially.
    %    \begin{align}
    %        \mathcal{S}_{ij}
    %        &= \brak{
    %            \frac{\exp[-i\Delta m_{ij} \phi]}{1 - (\Delta m_{ij})^2}
    %            \brak{
    %                -i\Delta m_{ij} \sin(\phi)
    %                + \cos(\phi)
    %            }
    %        }_{0}^{2\pi}
    %        = 0.
    %        \label{eq:dipole-y-tdqd}
    %    \end{align}
    %    For $\Delta m_{ij} = \pm 1$ we get
    %    \begin{align}
    %        \mathcal{S}_{ij}
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd\phi
    %        \sin(\phi)
    %        \exp[\mp i\phi]
    %        \\
    %        &=
    %        \int_{0}^{2\pi}
    %        \dd\phi
    %        \para{
    %            \sin(\phi)\cos(\phi)
    %            \mp i\sin^2(\phi)
    %        }
    %        = \mp i\pi.
    %    \end{align}


    %\section{Coulomb elements}
    %    \label{app:coulomb-elements}
    %    In this section we'll write out the closed form solution to the Coulomb
    %    elements for the two-dimensional harmonic oscillator in polar
    %    coordinates \cite{anisimovas1998energy}.
    %    The eigenstates are given by \autoref{eq:eigenstate-tdho} and the
    %    Coulomb interaction in coordinate representation by
    %    \begin{align}
    %        u(\vf{r}_i, \vf{r}_j)
    %        &= \frac{1}{4\pi\epsilon_0}\frac{e^2}{\abs{\vf{r}_i - \vf{r}_j}}.
    %    \end{align}
    %    Replacing the positions with the dimensionless length $\vf{r} \to
    %    \vf{r}/a$, where $a$ is the scaling radius from \autoref{eq:bohr-radius},
    %    and measuring energy in dimensionless units of $\hslash \omega$
    %    \cite{anisimovas1998energy} we can write the Coulomb interaction as
    %    \begin{align}
    %        u(\vf{r}_i, \vf{r}_j)
    %        &= \lambda
    %        \frac{1}{\abs{\vf{r}_i - \vf{r}_j}},
    %    \end{align}
    %    where we have introduced the coupling constant
    %    \begin{align}
    %        \lambda = \frac{a m e^2}{4 \hslash^2 \pi \epsilon_0}.
    %    \end{align}
    %    In the case of atomic Hartree units, the Coulomb
    %    interaction can be written
    %    \begin{align}
    %        u(\vf{r}_i, \vf{r}_j)
    %        &= \sqrt{\omega}
    %        \frac{1}{\abs{\vf{r}_i - \vf{r}_j}},
    %    \end{align}
    %    where the frequency comes from the scaling radius.
    %    The scaled eigenstates are then given by
    %    \begin{align}
    %        \psi_{nm}(r, \phi)
    %        &= \sqrt{\frac{n!}{\pi(\abs{m} + n)!}}
    %        r^{\abs{m}} L^{\abs{m}}_n(r^2)
    %        \exp[-r^2/2]
    %        \exp[im\phi].
    %    \end{align}
    %    % TODO: Should there be a factor 2 in n! and pi?
    %    % See Anisimovas article.
    %    We will only look at the orbital part of the elements, as the
    %    spin-symmetry can be added afterwards.
    %    \begin{align}
    %        \mel*{ij}{\hat{u}}{kl}
    %        &= \lambda
    %        \mathcal{I}^{ij}_{kl},
    %    \end{align}
    %    where we are interested in computing the integral
    %    \begin{align}
    %        \mathcal{I}^{ij}_{kl}
    %        &=
    %        \delta_{m_i + m_j, m_k + m_l}
    %        \int\dd \vf{r}_1\dd \vf{r}_2
    %        \psi_{i}^{*}(\vf{r}_1) \psi_{j}^{*}(\vf{r}_2)
    %        \frac{1}{\abs{\vf{r}_1 - \vf{r}_2}}
    %        \psi_{k}(\vf{r}_1)\psi_{l}(\vf{r}_2),
    %    \end{align}
    %    Unlike \citeauthor{anisimovas1998energy} we will compute the log of the
    %    integral they list as this is slightly more convenient in terms of
    %    computation.
    %    % TODO: Remember to introduce the index convention used by Anisimovas
    %    % and Matulis.

    %\section{Barrier integrals}
    %    \label{app:barrier-integrals}
    %    We start by solving the integral for the absolute value of the cosine.
    %    \begin{align}
    %        \tilde{\mathcal{C}}_{pq}
    %        =
    %        \int_{0}^{2\pi} \dd \phi
    %        \abs{\cos(\phi)}
    %        \exp[-i\Delta m_{pq} \phi],
    %    \end{align}
    %    where we've again introduced the difference in the angular quantum
    %    number as in \autoref{eq:diff-m-tdqd}.
    %    We split up the integrals in three parts where $\cos(\phi) \geq 0$ to
    %    get rid of the absolute value.
    %    \begin{align}
    %        \tilde{\mathcal{C}}_{pq}
    %        &=
    %        \para{
    %            \int_{0}^{\pi/2}
    %            \dd \phi
    %            -
    %            \int_{\pi/2}^{3\pi/2}
    %            \dd \phi
    %            +
    %            \int_{3\pi/2}^{2\pi}
    %            \dd \phi
    %        }
    %        \cos(\phi)
    %        \exp[-i\Delta m_{pq}\phi],
    %    \end{align}
    %    where the notation should be understood such that each integral should
    %    evaluate the function to its right.
    %    The sign of the second integral comes from the fact that $\cos(\phi)
    %    \leq 0$ for $\phi \in [\pi/2, 3\pi/2]$.
    %    The solutions to the indefinite integrals are the same as for the dipole
    %    moment in the $x$-direction as seen in \autoref{eq:dipole-x-tdqd}.
    %    Taking care to look at the situation when $\Delta m_{pq} \neq \pm 1$
    %    first, we get
    %    \begin{align}
    %        \tilde{\mathcal{C}}_{pq}
    %        &=
    %        \frac{2}{1 - (\Delta m_{pq})^2}\brac{
    %            \exp[-i\Delta m_{pq} \pi / 2]
    %            + \exp[-i \Delta m_{pq} 3\pi / 2]
    %        }
    %        \\
    %        &= \frac{2}{1 - (\Delta m_{pq})^2}
    %        \exp[-i\Delta m_{pq} \pi / 2]
    %        \para{
    %            1 + \cos(\Delta m_{pq} \pi)
    %        }.
    %    \end{align}
    %    We can then see that odd values of $\Delta m_{pq}$ makes the integral
    %    vanish as
    %    \begin{align}
    %        1 + \cos(\Delta m_{pq} \pi)
    %        = 1 + \cos((2k + 1) \pi) = 0,
    %    \end{align}
    %    where $k \in \mathbb{Z}$, whereas for even values of $\Delta m_{pq}$ we
    %    get
    %    \begin{align}
    %        1 + \cos(\Delta m_{pq} \pi)
    %        = 1 + \cos(2k \pi) = 2.
    %    \end{align}
    %    Furthermore, the sign of the exponential will alternate between $\pm 1$
    %    for odd and even values of $k$.
    %    We thus have
    %    \begin{align}
    %        \tilde{\mathcal{C}}_{pq}
    %        =
    %        \frac{4}{1 - (\Delta m_{pq})^2}
    %        \begin{cases}
    %            0 & \Delta m_{pq} = 2k + 1, \\
    %            1 & \Delta m_{pq} = 4k, \\
    %            -1 & \Delta m_{pq} = 4k + 2,
    %        \end{cases}
    %    \end{align}
    %    where $k \in \mathbb{Z} \setminus \brac{0}$.
    %    Looking at the case when $\Delta m_{pq} = \pm 1$ we get
    %    \begin{align}
    %        \tilde{\mathcal{C}}_{pq}
    %        &=
    %        \para{
    %            \int_{0}^{\pi/2}
    %            \dd \phi
    %            -
    %            \int_{\pi/2}^{3\pi/2}
    %            \dd \phi
    %            +
    %            \int_{3\pi/2}^{2\pi}
    %            \dd \phi
    %        }
    %        \cos(\phi)
    %        \exp[\mp i\phi]
    %        \\
    %        &=
    %        \para{
    %            \int_{0}^{\pi/2}
    %            \dd \phi
    %            -
    %            \int_{\pi/2}^{3\pi/2}
    %            \dd \phi
    %            +
    %            \int_{3\pi/2}^{2\pi}
    %            \dd \phi
    %        }
    %        \brak{
    %            \cos^2(\phi)
    %            \mp i \cos(\phi)\sin(\phi)
    %        }
    %        \\
    %        &= 0.
    %    \end{align}
    %    Moving to the integral with the absolute value of the sine.
    %    \begin{align}
    %        \tilde{\mathcal{S}}_{pq}
    %        &= \int_{0}^{2\pi} \dd \phi
    %        \abs{\sin(\phi)}
    %        \exp[-i\Delta m_{pq} \phi]
    %        \\
    %        &= \para{
    %            \int_{0}^{\pi} \dd \phi
    %            - \int_{\pi}^{2\pi} \dd \phi
    %        }
    %        \sin(\phi) \exp[-i\Delta m_{pq} \phi].
    %    \end{align}
    %    We again start our initial analysis for $\Delta m_{pq} \neq \pm 1$.
    %    The solution to each of the indefinite integrals is the same as in
    %    \autoref{eq:dipole-y-tdqd} but with changed integration limits.
    %    Evaluating at the new limits we get
    %    \begin{align}
    %        \tilde{\mathcal{S}}_{pq}
    %        &=
    %        \frac{2}{1 - (\Delta m_{pq})^2}
    %        \brak{
    %            \exp[-i\Delta m_{pq} \pi]
    %            + 1
    %        }
    %        \\
    %        &= \frac{2}{1 - (\Delta m_{pq})^2}
    %        \brak{
    %            \cos(\Delta m_{pq} \pi)
    %            + 1
    %        }
    %        \\
    %        &=
    %        \frac{4}{1 - (\Delta m_{pq})^2}
    %        \begin{cases}
    %            0 & \Delta m_{pq} = 2k + 1, \\
    %            1 & \Delta m_{pq} = 2k,
    %        \end{cases}
    %    \end{align}
    %    where $k \in \mathbb{Z} \setminus \brac{0}$.
    %    For $\Delta m_{pq} = \pm 1$ we get
    %    \begin{align}
    %        \tilde{\mathcal{S}}_{pq}
    %        &= \para{
    %            \int_{0}^{\pi} \dd \phi
    %            - \int_{\pi}^{2\pi} \dd \phi
    %        }
    %        \sin(\phi) \exp[\mp i \phi]
    %        \\
    %        &= \para{
    %            \int_{0}^{\pi} \dd \phi
    %            - \int_{\pi}^{2\pi} \dd \phi
    %        }
    %        \brak{
    %            \sin(\phi)\cos(\phi)
    %            \mp i\sin^2(\phi)
    %        }
    %        = 0.
    %    \end{align}

\clearemptydoublepage

\section{One-dimensional quantum dots}
    \label{sec:one-dim-ho}
    Artificial atoms, or the so-called quantum dots, constitute a hot topic in
    condensed matter physics and material sciences. We will be exploring
    several types of quantum dots in both one and two dimensions in this
    thesis. The difference between the types of quantum dots is found in the
    one-body potential. All of the dots share the characteristic of being in an
    infinite well which makes the systems \emph{bound}. In our study of systems
    subject to intense laser fields, this will prove to be a bad approximation
    when the laser becomes very strong as the particles have no way of being
    ionized, i.e., escape the potential well.  Even so, for weak laser fields
    and for ground state calculations, they serve as excellent candidates for
    our methods.
    % TODO: This text needs some work

    The time-independent one-dimensional quantum dot can be described by the
    one-body Hamiltonian
    \begin{align}
        \oneten(x)
        = -\frac{\hslash^2}{2m} \dod[2]{}{x}
        + v(x),
        \label{eq:one-body-odqd}
    \end{align}
    where $v(x)$ is a potential function.
    In one dimension it is quite cheap to define a grid and use finite
    differences to solve the one-dimensional Schrödinger equation.
    Furthermore, for the systems we explore, numerically solving the Coulomb
    integrals is also feasible.
    This solution has its drawbacks in that the we approximate an infinite
    integral on a finite line, but it also has the advantage of being ``blind''
    to the choice of potential.
    This makes the solution completely general and opens up for a wide variety
    of potentials without the need for any extra mathematics.

    \subsection{Discretizing the problem}
        For a given one-body Hamiltonian $h(x)$ on the form described in
        \autoref{eq:one-body-odqd}, we wish to find a solution the
        time-indepedent Schrödinger equation
        \begin{align}
            \oneten(x)\psi(x) = \epsilon \psi(x),
        \end{align}
        where we've ignored labels on the eigenpair $(\epsilon, \psi(x))$ for
        now to avoid clutter.
        However, do be aware that we are looking for a spectrum of eigenstate.
        We use the central finite difference scheme for the kinetic term in the
        one-body Hamiltonian, that is,
        \begin{align}
            \dod[2]{\psi(x)}{x}
            = \frac{
                \psi(x + \Delta x) - 2\psi(x) + \psi(x - \Delta x)
            }{(\Delta x)^2}
            + \mathcal{O}\para{(\Delta x)^2}.
        \end{align}
        Now we can write the time-independent Schrödinger equation in the fully
        discretized form
        \begin{align}
            \oneten(x) \psi(x)
            = -\frac{\hslash^2}{2m}
            \frac{
                \psi(x + \Delta x) - 2\psi(x) + \psi(x - \Delta x)
            }{(\Delta x)^2}
            + v(x)\psi(x)
            = \epsilon \psi(x).
        \end{align}

    \subsection{Integrating the Coulomb elements}

    \subsection{One-dimensional harmonic oscillator}
        The one-dimensional harmonic oscillator is usually one of the first
        models studied in undergraduate quantum mechanics courses.
        The one-body Hamiltonian of the one-dimensional harmonic oscillator is
        given by
        \begin{align}
            \onehamil = \frac{\momentum^2}{2m} + \half m\omega^2 \position^2,
            \label{eq:1dho-hamiltonian}
        \end{align}
        where the latter term, i.e., the one-body potential, gives rise to the
        name of the system.
        Plugging this operator into the time-independent Schrödinger equation
        \begin{gather}
            \onehamil\ket{n} = \epsilon_n\ket{n},
        \end{gather}
        which results in an energy eigenvalue equation we wish to solve in order
        to find an expression for $\ket{n}$.
        % TODO: Discuss both the algebraic derivation and the solution using
        % diagonalization on a grid.
        % TODO: Include analytic solution to \ket{n}.
        % TODO: Include figues of the potential and the eigenstates.

    \subsection{One-dimensional double well quantum dot}
        A slightly more complicated model is the \emph{double well} quantum dot.
        Succintly named due to its ``bump'' in the bottom of the parabolic
        potential from the harmonic oscillator. The one-body hamiltonian is
        given by
        \begin{align}
            \onehamil = \frac{\momentum^2}{2m}
            + \half m\omega^2\para{
                \position^2
                + \frac{1}{4}l^2
                - l\abs{\position}
            },
        \end{align}
        where $l$ is the ``width'' of the potential barrier in the bottom of the
        parabola.
        % TODO: What is the width? RMS?
        % TODO: Discuss the constant term occuring in the double-well.

\section{Two-dimensional quantum dot}
    % TODO: Discuss the importance of the two-dimensional quantum dot
    Extending the formalism of the one-dimensional quantum dot to two dimensions
    we look at a system of particles confined to the plane.
    Due to there existing analytical solutions to the Coulomb elements for the
    two-dimensional harmonic oscillator in polar coordinates
    \cite{anisimovas1998energy}, this avoids the need of evaluating the two-body
    elements on a grid as in the one-dimensiona case.
    The one-body Hamiltonian in coordinate representation can thus be
    represented by
    \begin{align}
        \oneten(r, \phi)
        = -\frac{\hslash^2}{2m}\brak{
            \frac{1}{r}\dpd{}{r}\para{
                r\dpd{}{r}
            }
            + \frac{1}{r^2}\dpd[2]{}{\phi}
        }
        + v(r, \phi),
    \end{align}
    where we do not necessarily assume that the potential is circular symmetric
    unless specified.

    \subsection{Two-dimensional harmonic oscillator}
        In the two-dimensional harmonic oscillator we have a circual symmetric
        potential on the form
        \begin{align}
            v(r, \phi) = v(r) = \half m \omega^2 r^2.
        \end{align}
        % TODO: Shortly describe the systeym.
        We now look for a solution to the time-independent Schrödinger equation
        on the form
        \begin{align}
            \oneten(r, \phi)\psi(r, \phi) = \epsilon \psi(r, \phi),
        \end{align}
        where we assume a separable solution, viz.
        \begin{align}
            \phi(r, \phi) = R(r)\Phi(\phi).
        \end{align}
        Inserted into the one-body Hamiltonian and collecting terms that are
        acted upon by the differential operators to the right of the operators.
        \begin{gather}
            -\frac{\hslash^2}{2m}\brak{
                \frac{\Phi}{r}\dpd{}{r}\para{
                    r\dpd{}{r}
                }R
                + \frac{R}{r^2}\dpd[2]{}{\phi}\Phi
            }
            + v R \Phi = \epsilon R \Phi.
        \end{gather}
        Next we divide by $R\Phi$ on both sides and multiply with $-2m r^2
        /\hslash^2$.
        This yields
        \begin{gather}
            \frac{r}{R}\dpd{}{r}\para{
                r\dpd{}{r}
            } R
            + \frac{1}{\Phi}
            \dpd[2]{}{\phi}
            \Phi
            - \frac{2m r^2}{\hslash^2} \brak{
                v(r) - \epsilon
            } = 0,
        \end{gather}
        which has now been reduced to two separate differential equations.
        Introducing a dependent variable $- m^2$ we can write the two equations
        as
        \begin{gather}
            \frac{1}{\Phi}\dod[2]{}{\phi}\Phi = -m^2,
            \label{eq:tdho-angular-eq}
            \\
            \frac{r}{R}\dod{}{r}\para{
                r\dod{}{r}
            }R
            - \frac{2\mu r^2}{\hslash^2}\brak{
                v(r) - \epsilon
            }
            = -m^2,
            \label{eq:tdho-radial-eq}
        \end{gather}
        where we've relabeled the mass variable $m \to \mu$ to avoid confusion
        with the newly introduced quantity $m$.
        We recognize \autoref{eq:tdho-angular-eq} as the azimuthal equation from
        the solving the Schrödinger equation in three dimensions
        \cite{griffiths2017introduction}.
        The solution can be expressed as
        \begin{align}
            \Phi(\phi) &= \exp[im\phi],
        \end{align}
        where we absorb the constant term into the normalization of the wave
        function which we solve in the end.
        Furthermore, by allowing $m$ to be negative we can avoid including the
        negative frequency solutions $\exp{-im\phi}$.
        The radial equation in \autoref{eq:tdho-radial-eq} represents a slightly
        more complicated equation.
        Expanding the differential operators to
        \begin{align}
            \dod{}{r}\para{
                r\dod{}{r}
            }R
            = \dod{R}{r} + r\dod[2]{R}{r},
        \end{align}
        and multiplying through by $R/r^2$ we can write
        \autoref{eq:tdho-radial-eq} as
        \begin{gather}
            \dod[2]{R}{r}
            + \frac{1}{r}\dod{R}{r}
            + \brak{
                \frac{2\mu \epsilon}{\hslash^2}
                - \frac{\mu^2\omega^2}{\hslash^2} r^2
                + \frac{m^2}{r^2}
            } R
            = 0,
        \end{gather}
        where we've inserted the explicit expression for the harmonic oscillator
        potential.
        The solution to this equation is given by \cite{sandev2005selection}
        \begin{align}
            R_{nm}(r)
            = r^{\abs{m}}
            \exp[-a^2 r^2/2]
            \rho(r),
        \end{align}
        where $\rho(r)$ is a function of $r$ and $a$ is the Bohr radius given by
        \begin{align}
            a = \sqrt{\frac{\mu \omega}{\hslash}}.
            \label{eq:bohr-radius}
        \end{align}
        Now, finding the derivatives $R_{nm}(r)$ with respect to $r$ yields
        \begin{gather}
            \dod{}{r}R_{nm}(r)
            = r^{\abs{m}} \exp[-a^2 r^2 / 2] \brak{
                \frac{\abs{m}}{r} - a^2 r + \dod{}{r}
            }\rho(r),
            \\
            \dod[2]{}{r}R_{nm}(r)
            = r^{\abs{m}} \exp[-a^2 r^2 / 2] \brak{
                \frac{\abs{m}}{r} - a^2 r + \dod{}{r}
            }^2\rho(r).
        \end{gather}
        Inserted back into the radial equation and dividing through by the terms
        in front of $\rho$ in $R_{nm}$ we get
        \begin{align}
            \brak{
                \frac{\abs{m}}{r} - a^2 r + \dod{}{r}
            }^2 \rho
            &+ \frac{1}{r}\brak{
                \frac{\abs{m}}{r} - a^2 r + \dod{}{r}
            }\rho
            \nonumber \\
            &\qquad
            + \brak{
                \frac{2\mu \epsilon}{\hslash^2}
                - \frac{\mu^2\omega^2}{\hslash^2} r^2
                + \frac{m^2}{r^2}
            } \rho
            = 0.
        \end{align}
        % TODO: Continue from here


        In total the eigenstates of the two-dimensional harmonic oscillator is
        given by
        \begin{align}
            \psi_{nm}(r, \phi)
            &= a\sqrt{\frac{n!}{\pi(\abs{m} + n)!}}
            (ar)^{\abs{m}} L^{\abs{m}}_n(a^2 r^2)
            \exp[-a^2 r^2/2]
            \exp[im\phi].
            \label{eq:eigenstate-tdho}
        \end{align}


        \begin{align}
            \onehamil\ket{nm} = \epsilon_{nm}\ket{nm},
        \end{align}
        and diagonalize in order to find the eigenstates, $\ket{nm}$.
        Representing the eigenstates in polar coordinates
        \begin{align}
            \phi_{nm}(\vf{r}) = \phi_{nm}(r, \phi)
            \equiv \braket{r\phi}{nm},
        \end{align}
        we solve the eigenvalue problem by separating the radial and the angular
        part of the eigenstate and solve each term individually. That is,
        \begin{align}
            \phi_{nm}(r, \phi) = N_{nm}R_{nm}(r)\Phi_{m}(\phi).
            \label{eq:spf-2dqd}
        \end{align}
        % TODO: Complete this derivation, i.e., solve the differential equation and
        % find the normalization constant.
        % TODO: Talk about angular momentum.
        Solving the two coupled ordinary differential equations and finding the
        normalization constant, we find the terms
        \begin{align}
            N_{nm} = a\sqrt{\frac{n!}{\pi(n + \abs{m})!}},
        \end{align}
        as the normalization factor with
        \begin{align}
            a = \sqrt{\frac{m\omega}{\hslash}},
        \end{align}
        the Bohr radius. The radial contribution is given by
        \begin{align}
            R_{nm}(r)
            &= (ar)^{\abs{m}}L^{\abs{m}}_{n}(a^2r^2)
            \exp\brac{-\frac{a^2 r^2}{2}},
            \label{eq:radial-function-tdho}
        \end{align}
        where $L^{m}_{n}(r)$ is the \emph{associated Laguerre polynomials}. The
        angular part is given by
        \begin{align}
            \Phi_m(\phi) = \exp\brac{im\phi}.
        \end{align}
        The eigenenergy, $\epsilon_{nm}$, of the two-dimensional eigenstates is
        given by
        \begin{align}
            \epsilon_{nm} = \hslash\omega\brak{
                2n + \abs{m} + 1
            }.
            \label{eq:eigenenergies_2dqd}
        \end{align}
        Staring at the eigenenergy equation we notice quite fast that the states
        are degenerate in the energy. A drawing of the first three energy levels
        with their corresponding quantum numbers is shown in
        \autoref{fig:2dho-energy-levels}.
        \begin{figure}
            \begin{center}
                \begin{tikzpicture}
                    \begin{scope}
                        \foreach \i in {1, 2, 3} {
                            \draw(-1, \i - 1) node[anchor=east]
                            {$\epsilon = \i\hslash\omega$};
                        }

                        % Highest energy level
                        \foreach \i in {0, 3, 6} {
                            \draw (\i, 2) -- (\i + 2, 2);
                            \node at (\i + 0.75, 2) {$\uparrow$};
                            \node at (\i + 1.25, 2) {$\downarrow$};
                        }
                        \node[below, inner sep=.2cm] at (1, 2)
                        {$n = 0, m = -2$};
                        \node[below, inner sep=.2cm] at (4, 2)
                        {$n = 1, m = 0$};
                        \node[below, inner sep=.2cm] at (7, 2)
                        {$n = 0, m = 2$};

                        % Middle energy level
                        \foreach \i in {1.5, 4.5} {
                            \draw (\i, 1) -- (\i + 2, 1);
                            \node at (\i + 0.75, 1) {$\uparrow$};
                            \node at (\i + 1.25, 1) {$\downarrow$};
                        }
                        \node[below, inner sep=.2cm] at (2.5, 1)
                        {$n = 0, m = -1$};
                        \node[below, inner sep=.2cm] at (5.5, 1)
                        {$n = 0, m = 1$};

                        % Lowest energy level
                        \draw (3, 0) -- (5, 0);
                        \node at (3 + 0.75, 0) {$\uparrow$};
                        \node at (3 + 1.25, 0) {$\downarrow$};
                        \node[below, inner sep=.2cm] at (4, 0)
                        {$n = 0, m = 0$};
                    \end{scope}
                \end{tikzpicture}
            \end{center}
            \caption{In this plot we can see the energy degeneracy of the lowest
            three energy levels in the two-dimensional quantum dot.  Each arrow
            representes a spin up or a spin down state with the quantum numbers
            $n$ and $m$ as listed below. This pattern goes on indefinitly with
            the addition of one bar (two oscillators) per level.}
            \label{fig:2dho-energy-levels}
        \end{figure}
        The basis functions are orthonormal. By including spin as a quantum
        number $\sigma$, we can represent this by
        \begin{align}
            \braket{n_1 m_1 \sigma_1}{n_2 m_2 \sigma_2}
            = \delta_{n_1 n_2}\delta_{m_1 m_2} \delta_{\sigma_1 \sigma_2}.
        \end{align}
        % TODO: Add "mexican-hat" plots of probability density

        \subsubsection{Mapping the quantum numbers to a single value}
            When working with second quantized operators, we distinguish single
            particle functions in a Slater determinant by a single index.
            Including spin in the two-dimensional harmonic oscillator
            eigenstates we have to deal with three quantum numbers $n$, $m$ and
            $\sigma$ per state.  We are thus interested in finding a mapping
            $(n, m) \mapsto p$ and the inverse mapping $p \mapsto (n,
            m)$\footnote{The spin quantum number is easiest to deal with in the
            end as we can double each dimension in every tensor and label all
            odd or even indices by a spin direction.}.  Due to the degeneracy of
            the eigenenergies such a mapping will not be unique. We thus have to
            decide in advance how we should count the basis states. In this
            thesis we choose the convention that we start from the lowest energy
            level and move up by counting from left to right. Tabulating
            \autoref{fig:2dho-energy-levels} we get the table shown in
            \autoref{tab:2dho-mapping}.  In \autoref{alg:nm-to-p} we give a
            sketch of the algorithm we use to compute $(n, m) \mapsto p$. We
            show the inverse algorithm in \autoref{alg:p-to-nm}.

            Using the aforementioned mapping we can find indices $p$ such that
            \begin{align}
                \ket{nm} \mapsto \ket{p}.
            \end{align}

            \begin{table}
                \centering
                \caption{In this table we show an example of how our mapping
                convention will index the states shown in
                \autoref{fig:2dho-energy-levels}.}
                \begin{tabular}{c|ll}
                    $\epsilon_{nm}$ & $(n, m)$ & $p$ \\
                    \hline
                    \\
                    $\hslash\omega$ & $(0, 0)$ & $0$ \\
                    $2\hslash\omega$ & $(0, -1)$ & $1$ \\
                    $2\hslash\omega$ & $(0, 1)$ & $2$ \\
                    $3\hslash\omega$ & $(0, -2)$ & $3$ \\
                    $3\hslash\omega$ & $(1, 0)$ & $4$ \\
                    $3\hslash\omega$ & $(0, 2)$ & $5$
                \end{tabular}
                \label{tab:2dho-mapping}
            \end{table}

            \begin{algorithm}
                \inputpython{theory/quantum-systems/get_index_p.py}{0}{35}
                \caption{In this algorithm we describe how we can find $(n, m)
                \mapsto p$ relatively quick without having to tabulate all
                maps.}
                \label{alg:nm-to-p}
            \end{algorithm}

            \begin{algorithm}
                \inputpython{theory/quantum-systems/get_indices_nm.py}{0}{48}
                \caption{In this algorithm we sketch how we can find $p \mapsto
                (n, m)$, i.e., the inverse of \autoref{alg:nm-to-p}.}
                \label{alg:p-to-nm}
            \end{algorithm}

        \subsubsection{Computing the dipole moments}
            The matrix elements of the dipole moment of the two-dimensional
            harmonic oscillator quantum dot is given by
            \begin{align}
                \vf{d}_{ij}
                \equiv \mel{i}{\positionvec}{j},
            \end{align}
            where we get a dipole moment for each coordinate in $\vf{r}$. As
            we've expressed the single particle functions in polar coordinates,
            but wish to express the dipole moments in a cartesian coordinate
            system, we have to compute the two integrals
            \begin{align}
                \vf{d}_{ij}
                &= \vf{i}\mel{i}{\position}{j}
                + \vf{j}\mel{i}{\position[y]}{j}
                = \vf{i}\mel{i}{r \cos(\phi)}{j}
                + \vf{j}\mel{i}{r \sin(\phi)}{j},
                \label{eq:dipole_elements}
            \end{align}
            where $\vf{i}$ and $\vf{j}$ are the unit vectors along the $x$- and
            $y$-axis respectively.  Using \autoref{eq:spf-2dqd} we are able to
            find analytical expressions for the angular integral. The radial
            integral must be evaluated from $0$ to $\infty$, but lucikly SymPy
            \cite{sympy} handles this for us. Note that we use the notation $i
            \mapsto (n_i, m_i)$ from the mapping algorithms described above. We
            then get the following integrals
            \begin{align}
                \mel{i}{r \cos(\phi)}{j}
                &= N^{*}_{n_i m_i} N_{n_j m_j}
                \mathcal{R}_{ij}
                \mathcal{C}_{ij},
                \\
                \mel{i}{r \sin(\phi)}{j}
                &= N^{*}_{n_i m_i} N_{n_j m_j}
                \mathcal{R}_{ij}
                \mathcal{S}_{ij},
            \end{align}
            where no summation is implied in the index labels.
            The integrals are given by
            \begin{gather}
                \mathcal{R}_{ij}
                =
                \int_{0}^{\infty} \dd r r^2
                R_{n_i m_i}^{*}(r) R_{n_j m_j}(r),
                \label{eq:radial-integral-tdho}
                \\
                \mathcal{C}_{ij}
                =
                \int_{0}^{2\pi}
                \dd \phi
                \cos(\phi)
                \Phi_{m_i}^{*}(\phi)
                \Phi_{m_j}(\phi),
                \label{eq:cos-integral-tdho}
                \\
                \mathcal{S}_{ij}
                =
                \int_{0}^{2\pi}
                \dd \phi
                \sin(\phi)
                \Phi_{m_i}^{*}(\phi)
                \Phi_{m_j}(\phi).
                \label{eq:sin-integral-tdho}
            \end{gather}
            We solve the radial integral using SymPy \cite{sympy}.
            We start by constructing the radial functions $R_{n_i m_i}(r)$.
            This is done by the Python function shown in
            \autoref{alg:radial-function-tdho}, where the mapping from $i
            \mapsto (n_i, m_i)$ is done by \autoref{alg:p-to-nm}.
            \begin{algorithm}
                \inputpython{theory/quantum-systems/spf_radial_function.py}{0}{10}
                \caption{Python function constructing the radial functions from
                the \autoref{eq:radial-function-tdho}.}
                \label{alg:radial-function-tdho}
            \end{algorithm}
            Having constructed the two radial functions we can perform the
            integraion using the function in \autoref{alg:radial-integral-tdho}.
            \begin{algorithm}
                \inputpython{theory/quantum-systems/radial_integral.py}{0}{7}
                \caption{Python function performing the radial integral in
                \autoref{eq:radial-integral-tdho} using SymPy \cite{sympy} to
                evaluate the integral from $r \in [0, \infty)$.}
                \label{alg:radial-integral-tdho}
            \end{algorithm}

            The two angular integrals in \autoref{eq:cos-integral-tdho} and
            \autoref{eq:sin-integral-tdho} have closed form solutions which we
            derive.
            Starting with \autoref{eq:cos-integral-tdho} we can write
            \begin{align}
                \mathcal{C}_{ij}
                &=
                \int_{0}^{2\pi}
                \dd \phi
                \cos(\phi)
                \exp[-i\Delta m_{ij} \phi],
            \end{align}
            where we've defined the difference in the angular quantum number by
            \begin{align}
                \Delta m_{ij} \equiv m_i - m_j.
            \end{align}
            and we have that $\Delta m_{ij} \in \mathbb{Z}$.
            The closed form solution to this integral is
            \begin{align}
                \mathcal{C}_{ij}
                &= \brak{
                    \frac{\exp[-i\Delta m_{ij} \phi]}{1 - (\Delta m_{ij})^2}
                    \brak{
                        -i\Delta m_{ij} \cos(\phi)
                        + \sin(\phi)
                    }
                }_{0}^{2\pi}
                = 0,
            \end{align}
            if $\Delta m_{ij} \neq \pm 1$.
            For the case when $\Delta m_{ij} = \pm 1$ we solve the easier
            integral
            \begin{align}
                \mathcal{C}_{ij}
                &=
                \int_{0}^{2\pi}
                \dd \phi
                \cos(\phi) \exp[\mp i\phi]
                =
                \int_{0}^{2\pi}
                \dd \phi
                \para{
                    \cos^2(\phi)
                    \mp i\cos(\phi)\sin(\phi)
                }
                = \pi.
            \end{align}
            % TODO: Discuss the connection to the allowed dipole transitions in
            % a harmonic oscillator.
            For the sine integral in \autoref{eq:sin-integral-tdho} we have
            \begin{align}
                \mathcal{S}_{ij}
                &=
                \int_{0}^{2\pi}
                \dd\phi
                \sin(\phi)
                \exp[-i\Delta m_{ij} \phi].
            \end{align}
            The closed form solution of this integral is similar to the form for
            the cosine-integral.
            Again we look at the situation when $\Delta m_{ij} \neq \pm 1$
            initially.
            \begin{align}
                \mathcal{S}_{ij}
                &= \brak{
                    \frac{\exp[-i\Delta m_{ij} \phi]}{1 - (\Delta m_{ij})^2}
                    \brak{
                        -i\Delta m_{ij} \sin(\phi)
                        + \cos(\phi)
                    }
                }_{0}^{2\pi}
                = 0.
            \end{align}
            For $\Delta m_{ij} = \pm 1$ we get
            \begin{align}
                \mathcal{S}_{ij}
                &=
                \int_{0}^{2\pi}
                \dd\phi
                \sin(\phi)
                \exp[\mp i\phi]
                \\
                &=
                \int_{0}^{2\pi}
                \dd\phi
                \para{
                    \sin(\phi)\cos(\phi)
                    \mp i\sin^2(\phi)
                }
                = \mp i\pi.
            \end{align}
            The results for the angular integrals yields the selection rules for
            the dipole approximation for the two-dimensional harmonic
            oscillator.
            Unless $\Delta m_{ij} = \pm 1$, the transition between the states is
            not allowed in the dipole approximation, i.e., the integral
            vanishes.
            % TODO: Write the full expression for the dipole elements.
            % TODO: Add plot of the dipole moments.


        \subsubsection{Computing the Coulomb elements}
            Having found the basis functions and the elements of the one-body
            hamiltonian, we are left with the task of finding the two-body
            elements from the Coulomb interaction.
            Luckily, there exists an analytic formula finding these elements for
            the two-dimensional harmonic oscillator in polar coordinates.
            This formula is shown in appendix A in the article
            \citetitle{anisimovas1998energy} by
            \citeauthor{anisimovas1998energy} \cite{anisimovas1998energy}.
            Note that \citeauthor{anisimovas1998energy} interchanges the indices
            in the ket-part of their two-body integrals as opposed to our
            convention. That is, in our notation we would write
            \begin{align}
                \mel{ij}{\twohamil}{kl}
                &=
                \int\dd x_1\dd x_2
                \psi_{i}^{*}(x_1) \psi_{j}^{*}(x_2)
                \twoten
                \psi_{k}(x_1)\psi_{l}(x_2)
                \equiv
                \mel{ij}{\twohamil}{lk}_{AM},
            \end{align}
            where $ \bra{ij}\twohamil\ket{lk}_{AM}$ is the convention used by
            \citeauthor{anisimovas1998energy}.
            There are two significant symmetries included in the calculation of
            the two-body elements.
            The first occurs as the Hamiltonian is spin-independent and the
            second comes from the azimuthal quantum number $m$.
            This can be expressed as
            \begin{align}
                \mel{ij}{\twohamil}{kl}
                = \delta_{\sigma_i \sigma_k} \delta_{\sigma_j \sigma_l}
                \int\dd \vf{r}_1\dd \vf{r}_2
                \psi_{i}^{*}(\vf{r}_i) \psi_{j}^{*}(\vf{r}_2)
                \twoten
                \psi_{k}(\vf{r}_1)\psi_{l}(\vf{r}_2),
            \end{align}
            where the symmetry that $m_i + m_j = m_k + m_l$ is baked into the
            integral.
            The formula for computing the integral
            \begin{align}
                \mathcal{I}^{ij}_{kl}
                =
                \int\dd \vf{r}_1\dd \vf{r}_2
                \psi_{i}^{*}(\vf{r}_1) \psi_{j}^{*}(\vf{r}_2)
                \twoten
                \psi_{k}(\vf{r}_1)\psi_{l}(\vf{r}_2),
            \end{align}
            is rather involved and we've pushed it to
            \autoref{app:coulomb-elements}.


    \subsection{Two-dimensional double well quantum dot}
        Another interesting system to explore is the double well quantum dot,
        i.e., a quantum dot with a finite barrier in the potential trap.
        Building the barrier on top of the two-dimensional harmonic oscillator
        lets us reuse much of the machinery from the previous section.
        There are a multitude of ways to create a confining double well
        potential.
        In the following we'll be focusing on a double well with a sharp
        boundary for the barrier in either $x$- or $y$-direction.
        The one-body Hamiltonian of the double well with the barrier in the
        $x$-direction is given by
        \begin{align}
            \onehamil
            &=
            \frac{\momentum^2}{2m}
            + \half m \omega^2 \position[r]^2
            + \half m \omega^2 \para{
                \frac{1}{4} l^2 - l\abs{\position}
            }.
            \label{eq:one-body-2ddw}
        \end{align}
        % TODO: Give motivation for the shape of the double-well.
        % Discuss the constant term.
        In \autoref{eq:one-body-2ddw} we recognize the two first terms as the
        kinetic energy and the harmonic oscillator confining potential.
        Instead of finding an analytical expression for the full one-body
        Hamiltonian, as we did for the harmonic oscillator, we'll instead use
        the single-particle functions in \autoref{eq:spf-2dqd} as trial wave
        functions and use the variational method to find as good an estimate as
        possible to the underlying exact eigenpair.
        The one-body matrix elements can then be found from
        \begin{align}
            \oneten^{p}_{q}
            &= \epsilon_{p}\delta^{p}_{q}
            + \half m \omega^2\mel{p}{\para{
                \frac{1}{4} l^2 - l \abs{\position}
            }}{q}
            \\
            &= \epsilon_{p}\delta^{p}_{q}
            + \frac{1}{8} m \omega^2 l^2 \delta^{p}_{q}
            - \half m \omega^2 l \mel{p}{\abs{\position}}{q},
        \end{align}
        where we have used the mapping $(n, m) \to p$ from
        \autoref{alg:nm-to-p} described above and where
        the eigenenergies $\epsilon_p$ are given by
        \autoref{eq:eigenenergies_2dqd}.
        The two first terms give a shifted harmonic oscillator potential, viz.
        \begin{align}
            \epsilon_p' = \epsilon_p + \frac{1}{8} m \omega^2 l^2.
        \end{align}
        The last term is the double well barrier and resembles the dipole matrix
        elements from \autoref{eq:dipole_elements} except for the absolute
        value.
        We rewrite the potential barrier in polar coordinates by
        \begin{gather}
            \abs{x} = r\abs{\cos(\phi)}, \\
            \abs{y} = r\abs{\sin(\phi)},
        \end{gather}
        where we've included the barrier in $y$-direction for the sake of
        generality.
        We can thus compute the barrier integrals using the eigenstates from the
        harmonic oscillator.
        \begin{gather}
            \mel{p}{\abs{\position}}{q}
            =
            N^{*}_{n_p m_p} N_{n_q m_q}
            \mathcal{R}_{pq} \tilde{\mathcal{C}}_{pq},
            \\
            \mel{p}{\abs{\position[y]}}{q}
            =
            N^{*}_{n_p m_p} N_{n_q m_q}
            \mathcal{R}_{pq} \tilde{\mathcal{S}}_{pq},
        \end{gather}
        where the normalization and the radial integral is the same as for the
        dipole moment in the harmonic oscillator system.
        Note again that no summation is implied in the indices for the
        integrals.
        The only difference is the absolute value on the periodic function in
        the polar integral.
        These integrals are given by
        \begin{gather}
            \tilde{\mathcal{C}}_{pq}
            =
            \int_{0}^{2\pi} \dd \phi
            \abs{\cos(\phi)}
            \Phi^{*}_{m_p}(\phi)
            \Phi_{m_q}(\phi),
            \\
            \tilde{\mathcal{S}}_{pq}
            =
            \int_{0}^{2\pi} \dd \phi
            \abs{\sin(\phi)}
            \Phi^{*}_{m_p}(\phi)
            \Phi_{m_q}(\phi).
        \end{gather}


        This gives \cite{wolframalphatildei1}
        \begin{align}
            \tilde{I}_{\theta_1}
            &=
            \int_{0}^{2\pi}\dd \theta \abs{\cos(\theta)}
            \Theta_{m_p}^{*}(\theta)
            \Theta_{m_q}(\theta)
            =
            \int_{0}^{2\pi}\dd \theta \abs{\cos(\theta)}
            \exp\brac{i(m_q - m_p)\theta}
            \\
            &=
            -i\brak{
                -m_q + m_p
                + (m_q - m_p)\exp\brac{i\pi(m_q - m_p)}
                - 2i\exp\brac{
                    i\pi(m_q - m_p)/2
                }
            }
            \\
            &\qquad
            \times
            \frac{
                % This term should be 1:
                % \exp\brac{-2i\pi(m_p - m_q)}
                \brak{
                    1 + \exp\brac{i\pi(m_q - m_p)}
                }
            }{
                \para{m_q - m_p}^2 - 1
            },
        \end{align}
        where we've labeled the integral in the $x$-direction
        $\tilde{I}_{\theta_1}$.
        When $\abs{m_q - m_p} = 1$ we get $\tilde{I}_{\theta_1} = 0$
        \cite{wolframalphatildei1-zero}.
        For the $y$-direction we get the integral \cite{wolframalphatildei2}
        \begin{align}
            \tilde{I}_{\theta_2}
            &=
            \int_{0}^{2\pi}\dd \theta \abs{\sin(\theta)}
            \Theta_{m_p}^{*}(\theta)
            \Theta_{m_q}(\theta)
            =
            \int_{0}^{2\pi}\dd \theta \abs{\sin(\theta)}
            \exp\brac{i(m_q - m_p)\theta}
            \\
            &=
            -\frac{
                \brak{
                    1 + \exp\brac{i \pi (m_q - m_p)}
                }^2
            }{
                \para{m_q - m_p}^2 - 1
            }.
        \end{align}
        When $\abs{m_q - m_p} = 1$ this integral yields $\tilde{I}_{\theta_2} =
        0$ \cite{wolframalphatildei2-zero}.

        Having constructed the full one-body Hamiltonian, we can diagonalize it
        in order to find coefficients, $\vf{C}$, which we use to transform the
        single-particle functions and the two-body elements from the harmonic
        oscillator basis to an approximate double-well basis.
        That is, we construct the single-particle functions
        \begin{align}
            \ket{\psi_{\alpha}} = C^{p}_{\alpha}\ket{\phi_p},
        \end{align}
        where we label the double-well single-particle functions by
        $\ket{\psi_{\alpha}}$ with greek indices to distinguish from the known
        harmonic oscillator single-particle functions $\ket{\phi_p}$.
        Stated as an eigenequation for the double-well one-body Hamiltonian
        \begin{gather}
            \onehamil \ket{\psi_{\alpha}}
            = \varepsilon_{\alpha} \ket{\psi_{\alpha}}
            \implies
            \onehamil C^{q}_{\alpha} \ket{\phi_q}
            = \varepsilon_{\alpha} C^{q}_{\alpha} \ket{\phi_q},
        \end{gather}
        where we've inserted the known single-particle functions along with the
        coefficients.
        The eigenenergy $\varepsilon_{\alpha}$ is the eigenenergy of the
        double-well single-particle functions.
        Projecting onto the harmonic oscillator basis, we find a generalized
        eigenvalue equation.
        \begin{gather}
            \bra{\phi_{p}}\onehamil\ket{\phi_q} C^{q}_{\alpha}
            = \varepsilon_{\alpha} C^{q}_{\alpha} \braket{\phi_{p}}{\phi_{q}}.
        \end{gather}
        Recalling that the harmonic oscillator basis is orthonormal and
        inserting the matrix elements for the one-body Hamiltonian we are left
        with
        \begin{align}
            \oneten^{p}_{q} C^{q}_{\alpha}
            = \delta^{p}_{q} C^{q}_{\alpha} \varepsilon_{\alpha}
            = C^{p}_{\alpha} \varepsilon_{\alpha}.
        \end{align}
        Solving this generalized eigenvalue equation yields the coefficient
        matrix, $\vf{C} \in \mathbb{C}^{L\times L}$, and the eigenenergy matrix
        $\vfg{\varepsilon} = \diag(\varepsilon_1, \dots, \varepsilon_L)$, where
        $L$ is the number of harmonic oscillator basis functions.
        Having found the coefficient matrix we can transform the two-body
        elements from the harmonic oscillator basis to the double-well basis by
        \begin{align}
            \bra{\psi_{\alpha} \psi_{\beta}}
            \twohamil
            \ket{\psi_{\gamma} \psi_{\delta}}
            = {C^{p}_{\alpha}}^{*}
            {C^{q}_{\beta}}^{*}
            \bra{\phi_{p} \phi_{q}}
            \twohamil
            \ket{\phi_{r} \phi_{s}}
            C^{r}_{\gamma}
            C^{s}_{\delta}.
        \end{align}
        The same procedure can also be used on other matrix elements defined in
        the harmonic oscillator basis. For example, the dipole matrix elements
        yields
        \begin{align}
            \bra{\psi_{\alpha}}
            \vf{d}
            \ket{\psi_{\beta}}
            = {C^{p}_{\alpha}}^{*}
            \bra{\phi_{p}}
            \vf{d}
            \ket{\phi_{q}}
            C^{q}_{\beta}.
        \end{align}

        \subsubsection{Quality of the transformed single-particle functions}
            As the harmonic oscillator basis in no way is a complete basis
            covering enough of the Hilbert space in order to accurately describe
            the double-well basis, we need to make a choice on how many basis
            functions we deem ``good enough''.
            % TODO: This sentence needs rephrasing.

\chapter{Quantum Mechanics}
    \epigraph{The underlying physical laws necessary for the mathematical
    theory of a large part of physics and the whole of chemistry are thus
    completely known, and the difficulty is only that the exact application of
    these laws leads to equations much too complicated to be soluble.}
    {--- P. A. M. Dirac}

    \section{Pauli exclusion principle}
        % TODO: Include the spin-statistics theorem.

    \section{Spin-orbitals}
        In this thesis we will be looking at many-particle systems.
        Wave functions of many-particle systems depend on the coordinates of all
        the particles contained in the system.
        We will typically build the wave functions of the full system from
        \emph{single particle functions}.
        In this work we'll limit our attention to particles with spin one half ,
        i.e., fermions, which means that the total wave function must satisfy
        the \emph{Pauli exclusion principle} due to the particles being
        indistinguishable.
        The single particle functions will as a consequence depend on the
        particle's spatial orientation, i.e., the \emph{orbital} part, and the
        spin.
        We call these wave functions \emph{spin-orbitals}.
        \begin{align}
            \psi(x) \equiv \psi(\vf{r}, \sigma),
        \end{align}
        where $x = (\vf{r}, \sigma)$ is a generalized coordinate of both
        position, $\vf{r}$, and spin, $\sigma$.
        For fermions we have only two allowed spin states
        \begin{align}
            s_z = \pm \half\hslash,
        \end{align}
        where $s_z$ is the spin along $z$-direction.
        As there are only two allowed states we have that $\sigma \in
        \brac{\upspin, \downspin}$, where a positive value for $s_z$ corresponds
        to $\sigma = \upspin$, i.e., spin up, and a negative value for $s_z$ to
        $\sigma = \downspin$, i.e., spin down.
        We denote
        \begin{align}
            \psi_1(\vf{r}) \equiv \psi\para{\vf{r}, \upspin},
            \qquad
            \psi_2(\vf{r}) \equiv \psi\para{\vf{r}, \downspin},
        \end{align}
        for the two different spin-directions.
        We can thus represent the generalized spin-orbital $\psi(x)$ as a
        two-dimensional vector
        \begin{align}
            \psi(x) = \begin{pmatrix}
                \psi_1(\vf{r}) \\
                \psi_2(\vf{r})
            \end{pmatrix}.
        \end{align}
        We separate the spin dependence from the spatial part of the
        spin-orbitals by introducing separate ``spin functions'' for spin-up and
        spin-down.
        For example, choosing the basis
        \begin{align}
            \alpha \equiv \alpha(\sigma) = \begin{pmatrix}
                1 \\
                0
            \end{pmatrix},
            \qquad
            \beta \equiv \beta(\sigma) = \begin{pmatrix}
                0 \\
                1
            \end{pmatrix},
            \label{eq:spin-basis}
        \end{align}
        we use the same convention as in much of the many-body quantum mechanics
        litterature in labelling $\alpha$ as spin up and $\beta$ as spin down in
        the $z$-direction.
        Evaluating the spin functions thus yields
        \begin{gather}
            \alpha\para{\upspin} = 1, \qquad \alpha\para{\downspin} = 0, \\
            \beta\para{\upspin} = 0, \qquad \beta\para{\downspin} = 1.
        \end{gather}
        Using \autoref{eq:spin-basis} we see that we write the
        generalized spin-orbital as a linear combination of the spin basis
        functions by
        \begin{align}
            \psi(x)
            = \psi_1(\vf{r})\alpha(\sigma)
            + \psi_2(\vf{r})\beta(\sigma).
            \label{eq:general-spin-orbital}
        \end{align}
        % TODO: Consider adding theory on spin as in Mayer.
        We will for the most part work with spin-orbitals in a definite
        spin-direction, viz.
        \begin{align}
            \psi(x) = \phi(\vf{r})\xi(\sigma),
            \label{eq:spin-orbital}
        \end{align}
        where $\xi(\sigma)$ is either spin up $\alpha(\sigma)$ or spin down
        $\beta(\sigma)$ and we've denoted the spatial orbital by $\phi(\vf{r})$.
        The reason we avoid using a general spin-orbital as in
        \autoref{eq:general-spin-orbital} is convenience.
        It is simpler to generate a basis of spin-orbitals where we use a
        definite basis of analytic orbitals, e.g., harmonic oscillator basis
        functions, Gauss functions, etc, before deciding the spin direction of
        each orbital\footnote{
            For those that might find this frustrating, note that there is
            nothing stopping us from using orbitals and spin-functions which are
            linear combinations of an underlying basis of orbitals and
            spin-functions as well.
            There's linear combinations all the way down!
        }.
        When labelling the different spin-orbitals from
        \autoref{eq:spin-orbital} we use the notation
        \begin{align}
            \psi_P(x) = \phi_p(\vf{r})\xi_{\alpha}(\sigma),
        \end{align}
        where $P = (p, \alpha)$ is a composite index with $p$ labelling a
        specific orbital and $\alpha$ a specific spin-function\footnote{
            The index $\alpha$ must not be mistaken for the spin-function
            $\alpha(\sigma)$.
            The author wishes to extend an apology to everyone who might be
            confused by this notation.
        }.
        In the spin basis shown in \autoref{eq:spin-basis} we have that the
        inner product of two spin functions
        \begin{align}
            \braket{\xi_{\alpha}}{\xi_{\beta}}
            &=
            \xi_{\alpha}(\upspin)\xi_{\beta}(\upspin)
            + \xi_{\alpha}(\downspin)\xi_{\beta}(\downspin)
            = \delta_{\alpha\beta},
        \end{align}
        that is, they are orthonormal.
        The inner product of two spin-orbitals from \autoref{eq:spin-orbital} is
        then separated into an orbital and a spin inner product.
        \begin{align}
            \braket{\psi_P}{\psi_Q}
            &= \braket{\phi_p}{\phi_q}\braket{\xi_{\alpha}}{\xi_{\beta}}
            = \delta_{\alpha\beta}
            \int\dd\vf{r}\phi^{*}_{p}(\vf{r})\phi_{q}(\vf{r}).
            \label{eq:inner-spin-orbital}
        \end{align}
        This equation is quite suggestive in the sense that we can see that the
        spin decouples from the spatial part of the wave function.
        The two spin-directions constitute two separate Hilbert spaces for the
        orbital equations.
        % TODO: These statements _must_ be review properly!
        % They sound like mumbo-jumbo!
        Unless an operator contains a spin-coupling, the two spin-directions are
        completely independent of one another.
        For example, given a spin-independent operator, $\hat{O}$, the
        matrix element between two spin-orbitals become
        \begin{align}
            \bra{\psi_P}\hat{O}\ket{\psi_Q}
            &= \bra{\phi_p}\hat{O}\ket{\phi_q}\braket{\xi_{\alpha}}{\xi_{\beta}}
            = \delta_{\alpha\beta}
            \int\dd\vf{r}\phi^{*}_{p}(\vf{r})\hat{O}\phi_q(\vf{r}).
        \end{align}
        This motivates the coordinate representation independent notation
        \begin{align}
            \ket{\psi_P}
            &= \ket{\phi_p}\otimes\ket{\xi_{\alpha}},
        \end{align}
        where the tensor product

    \section{Slater determinants}
        As we are working with fermions the total many-body wave function must
        be \emph{antisymmetric} with respect to interchange of
        particles\footnote{We will restrict ourselves to the interchange of a
        full spin-orbital.}. Mathematically the full wave function of $n$
        fermions should satisfy
        \begin{align}
            \Psi(1, \dots, i, \dots, j, \dots, n)
            =
            -\Psi(1, \dots, j, \dots, i, \dots, n),
        \end{align}
        where we for brevity have introduced the notation $i \equiv x_i =
        (\vf{r}_i, \sigma_i)$. A fully antisymmetric, normalized, $n$-body wave
        function is given by the \emph{Slater determinant} built from $n$
        individual spin-orbitals with $n$ generalized coordinates.
        \begin{align}
            \Psi(1, \dots, n)
            &= \frac{1}{\sqrt{n!}}
            \begin{vmatrix}
                \psi_1(1) & \dots & \psi_n(1) \\
                \vdots & \ddots & \vdots \\
                \psi_1(n) & \dots & \psi_n(n)
            \end{vmatrix},
        \end{align}
        where $\psi_i(j) \equiv \psi_i(\vf{r}_j, \sigma_j)$ for the $i$'th
        spin-orbital in generalized coordinate $j$ \footnote{Note that the index
        on the spin-orbitals has nothing to do with which spin component is used
        as in the previous section on spin-orbitals.}. Exchanging a row in the
        determinant results in a sign change as we required from the
        antiysmmetric full wave function for the many-body problem. Furthermore,
        exchanging a column in the determinant also results in a sign-change.
        This means that there can not be two, or more, of the same spin-orbitals
        in the wave function perfectly encapsulating the Pauli principle as two
        of the same spin-orbitals translates to two particles being in the same
        state. Generally, the spin-orbitals in a Slater determinant are linearly
        independent, otherwise $\Psi = 0$. This is a consequence of the
        properties of a determinant that adding a scalar multiple of a column to
        another column does not change the determinant.

        The factor in front of the Slater determinant makes the many-body wave
        function normalized to unity as long as the spin-orbitals are
        orthonormalized.

        % TODO: Introduce proof
        \begin{proof}[Proof that Slater determinants are invariant under unitary
            transformations]
            \label{proof:slater_determinants_invariant}
            Given a basis $\brac{\ket{\phi_i}}_{i = 1}^{N}$ that spans the
            $N$-dimensional Hilbert space. We can then do a unitary
            transformation from this basis to a new basis
            $\brac{\ket{\psi_i}}_{i = 1}^{N}$ in the same Hilbert space by
            \begin{align}
                \ket{\psi_i} = u_{ji}\ket{\phi_j},
                \label{eq:unitary_transformation}
            \end{align}
            where $u_{ji} = u_{ij}^{*}$. For a set of coordinates
            $\brac{x_1, \dots, x_N}$, we write
            \begin{align}
                \psi_{ij} \equiv \psi_j(x_i)
                \equiv \braket{x_i}{\psi_j},
            \end{align}
            and equivalently for $\phi_{ij}$. Projecting onto the coordinate
            basis we can write \autoref{eq:unitary_transformation} as
            \begin{gather}
                \braket{x_k}{\psi_i}
                = u_{ji}\braket{x_k}{\phi_j}
                \implies
                \psi_{ki} = u_{ji}\phi_{kj} = \phi_{kj}u_{ji}
                \implies \vfg{\Psi} = \vfg{\Phi}\vfg{U},
            \end{gather}
            where the matrices $\vfg{\Psi}$, $\vfg{\Phi}$ and $\vfg{U}$ are
            the matrices with elements
            \begin{align}
                \vfg{\Psi}
                &= \begin{pmatrix}
                    \psi_{11} & \psi_{12} & \dots & \psi_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    \psi_{N1} & \psi_{N2} & \dots & \psi_{NN}
                \end{pmatrix}, \\
                \vfg{\Phi}
                &= \begin{pmatrix}
                    \phi_{11} & \phi_{12} & \dots & \phi_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    \phi_{N1} & \phi_{N2} & \dots & \phi_{NN}
                \end{pmatrix}, \\
                \vfg{U}
                &= \begin{pmatrix}
                    u_{11} & u_{12} & \dots & u_{1N} \\
                    \vdots & \vdots & \ddots & \vdots \\
                    u_{N1} & u_{N2} & \dots & u_{NN}
                \end{pmatrix},
            \end{align}
            and where $U^{\dagger}U = \1$. Creating the fully antisymmetrized
            normalized wave function, i.e., the Slater determinant, from
            $\vfg{\Psi}$ and $\vfg{\Phi}$ we see that
            % TODO: Fix description, the determinant of the "Slater matrices"
            % are not necessarily normalized without the pre-factor.
            \begin{gather}
                \det(\vfg{\Psi}) = \det(\vfg{\Phi}\vfg{U})
                = \det(\vfg{\Phi})\det(\vfg{U})
            \end{gather}
            We now take the squared norm on both sides.
            \begin{align}
                \norm{\det(\vfg{\Psi})}^2
                = \norm{\det(\vfg{\Phi})\det(\vfg{U})}^2
                \leq
                \norm{\det(\vfg{\Phi})}^2\norm{\det(\vfg{U})}^2
                = \norm{\det(\vfg{\Phi})}^2,
                \label{eq:squared_determinant}
            \end{align}
            where we have used that
            \begin{align}
                \norm{\det(\vfg{U})}^2
                &= \norm{\det(\vfg{U^{\dagger}})\det(\vfg{U})}
                = \norm{\det(\vfg{U}^{\dagger}\vfg{U})}
                = \norm{\det(\1)} = 1.
            \end{align}
            Now, in \autoref{eq:squared_determinant}, since the Slater
            determinant of $\vfg{\Phi}$ is orthonormalized and a unitary
            transformation preserves the normalization this means that the norm
            of $\det(\vfg{\Phi})$ and the norm of $\det(\vfg{\Psi})$ must be
            unity.  Thus, the equality in the splitting of the norm is preserved
            thus yielding
            \begin{gather}
                \norm{\det(\vfg{\Psi})}^2 = \norm{\det(\vfg{\Phi})}^2.
            \end{gather}
        \end{proof}

    \section{Density matrices}
        When working with many-body quantum mechanics, computing expectation
        values can at times prove easier when done using density matrices. A
        general density matrix of a \emph{pure state} is on the form
        \begin{align}
            \densitymatrix = \ket{\psi}\bra{\psi},
        \end{align}
        that is, a pure state is a quantum state $\ket{\psi}$ containing the
        maximum amount of information about a given system. For a \emph{mixed
        state}, i.e., a linear combination of pure states $\ket{\psi_k}$ with a
        classical probability $p_k$ associated with the state, we get a density
        matrix on the form
        \begin{align}
            \densitymatrix = \sum_{k} p_k \ket{\psi_k}\bra{\psi_k}.
        \end{align}
        Any density operator must satisfy the following
        properties \cite{modern-qm}:
        \begin{enumerate}
            \item Hermiticity, that is
                \begin{align}
                    p_k = p_k^{*} \implies \densitymatrix = \densitymatrix^{\dagger}.
                \end{align}
                This translates to the probabilities being real, $p_k \in
                \mathbb{R}$.
            \item Positivity,
                \begin{align}
                    p_k \geq 0 \implies \bra{\chi}\densitymatrix\ket{\chi} \geq 0.
                \end{align}
                In other words, density matrices are \emph{positive
                semidefinite}.
            \item Normalization of the probabilities,
                \begin{align}
                    \sum_{k} p_k = 1 \implies \tr(\densitymatrix),
                \end{align}
                that is, the probabilities must sum up to one.
        \end{enumerate}
        Furthermore, by squaring the density matrix and taking the trace we can
        infer if the system we are perusing is in a mixed state or a pure state
        \cite{modern-qm}.
        \begin{align}
            \tr(\densitymatrix^2) = \sum_{k} p_k^2 \leq 1,
        \end{align}
        with equality if, and only if, the system is in a pure state, viz.
        \begin{align}
            \densitymatrix = \ket{\psi}\bra{\psi}
            \implies \densitymatrix^2 = \densitymatrix
            \implies \tr(\densitymatrix^2) = 1.
        \end{align}
        Using density matrices, we can compute the expectation value of any
        operator $\hat{O}$, by \cite{modern-qm}
        \begin{align}
            \expv{\hat{O}} = \tr(\hat{O}\densitymatrix).
        \end{align}
        % TODO: Work this out further

    \section{Second quantization}
        When working with many-body quantum mechanics where the wave functions
        are linear combination of Slater determinants, we find that

        \subsection{Many-body density matrices}
            In a seminal paper by Löwdin \cite{lowdin-density-matrices}, the
            concept of a many-body density matrix in terms of the orbitals of a
            Slater determinant is discussed. These are dubbed $N$-body density
            matrices, where $N$ depends on the $N$-body interaction, that is,
            the number of particles included in the interaction. Of the most
            useful for our work, we have the one- and two-body density matrices.
            As we will work almost exclusively in second quantization, we will
            follow the derivation of the one- and two-body density matrices done
            by \citeauthor{helgaker-molecular}. Löwdin's paper
            \cite{lowdin-density-matrices} did not employ second quantization,
            and all matrices are expressed in the coordinate representation. We
            will list these as they arrive.

        \subsection{Wick's theorem}

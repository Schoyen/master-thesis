\chapter{Configuration interaction}
     A popular post Hartree-Fock method is \textit{configuration interaction}.
     % TODO: Discuss that FCI is "exact" for any choice of basis functions
     It consists of expressing the wavefunction as a linear combination of
     excited Slater determinants in a truncated single-particle and Slater
     determinant basis.
     \begin{align}
         \ket{\Psi}
         &= C_0\ketslat
         + \sum_{ai}C^a_i\ketslate{a}{i}
         + \frac{1}{4}\sum_{abij}C^{ab}_{ij}\ketslate{ab}{ij}
         + \dots,
     \end{align}
     where we have divided by a factor $4$ in the double sum to avoid over
     counting as both the coefficients and the excited determinants are
     antisymmetric. By generating all the possible Slater determinants from the
     $L$ single-particle functions we employ the \textit{full configuration
     interaction} method. This will give the most accurate value of the energy
     for the system, but quickly becomes computationally impossible as the FCI
     space grows in dimensions as $\binom{L}{N}$.
     \cite{kvaal2017notes}

     \section{Time-independent configuration interaction theory}
        We start with the time-independent Schrödinger equation
        \begin{align}
            \hamil\ket{\Psi_J} = E_J\ket{\Psi_J},
            \label{eq:ci_tise}
        \end{align}
        where $(E_J, \ket{\Psi_J})$ is an eigenpair for $\hat{H}$. Expanding the
        CI wavefunction in a Slater determinant basis.
        \begin{align}
            \ket{\Psi_J} = \sum_{K} C_{KJ}\ket{\Phi_K},
            \label{eq:expanded_ci_wavefunction}
        \end{align}
        where $C_{KJ}$ are the amplitudes for a certain excitation $K$ for a
        specific energy level $J$. Inserting
        \autoref{eq:expanded_ci_wavefunction} into \autoref{eq:ci_tise} and left
        projecting on a state $\ket{\Phi_I}$ we get
        \begin{align}
            \sum_{K}\bra{\Phi_I}\hat{H}\ket{\Phi_K}C_{KJ}
            = E_J\sum_{K}\braket{\Phi_I}{\Phi_K}C_{KJ}.
        \end{align}
        We now define the Hamiltonian matrix $H_{IK} =
        \bra{\Phi_I}\hat{H}\ket{\Phi_K}$ and the overlap matrix $S_{IK} =
        \braket{\Phi_I}{\Phi_K}$. We can thus formulate the generalized
        eigenvalue equation
        \begin{gather}
            \sum_{K}H_{IK}C_{KJ} = E_J\sum_{K}S_{IK}C_{KJ}
            \\
            \implies
            HC = ESC,
        \end{gather}
        where $S_{IK} = 1 \iff \braket{\Phi_I}{\Phi_K} = \delta_{IK}$. We will
        in this text only care about systems where the Slater determinants are
        orthonormal. Thus the eigenvalue equation we will solve will be
        \begin{align}
            HC = EC,
        \end{align}
        which means our job is to construct $H_{IJ}$ and diagonalize the
        matrix \cite{karwowski}. The elements $H_{IJ}$ are computed by
        \begin{align}
            \bra{\Phi_I}\hat{H}\ket{\Phi_J}
            &= \sum_{pq}h^{p}_{q}
            \bra{\Phi_I}\ccr{p}\can{q}\ket{\Phi_J}
            + \frac{1}{4}\sum_{pqrs}u^{pq}_{rs}
            \bra{\Phi_I}\ccr{p}\ccr{q}\can{s}\can{r}\ket{\Phi_J}.
        \end{align}
        Having constructed the one- and two-body elements $h^{p}_{q}$ and
        $u^{pq}_{rs}$ what remains is for us to evaluate the integrals
        $\bra{\Phi_I}\ccr{p}\can{q}\ket{\Phi_J}$ and
        $\bra{\Phi_I}\ccr{p}\ccr{q}\can{s}\can{r}\ket{\Phi_J}$. The total
        process of evaluating the matrix elements
        $\bra{\Phi_I}\hamil\ket{\Phi_J}$ can be done using the so-called
        \emph{Slater-Condon rules} which we'll describe below.

        \subsection{The Slater-Condon rules}

        \subsection{One-body density matrix}
            For a given eigenstate $\ket{\Psi_I}$ of the many-body Hamiltonian
            shown in \autoref{eq:ci_tise} we can compute the one-body density
            matrix ${\rho_I}^{q}_{p}$ by
            \begin{align}
                {\rho_I}^{q}_{p}
                &= \bra{\Psi_I}\ccr{p}\can{q}\ket{\Psi_I}
                = C_{JI}^{*}C_{KI}\bra{\Phi_J}\ccr{p}\can{q}\ket{\Phi_K}.
            \end{align}

    \section{Time-dependent configuration interaction}
        Starting from the time-depdendent Schrödinger equation, we can formulate
        the time-evolution of the many-body wave function.
        \begin{align}
            i\hslash \dpd[]{}{t}\ket{\Psi(t)}
            = \hamil(t)\ket{\Psi(t)},
            \label{eq:ci_tdse}
        \end{align}
        Here the time-dependent wave function $\ket{\Psi(t)}$ is given as a
        linear combination of Slater determinants
        \begin{align}
            \ket{\Psi(t)} = c_{I}(t) \ket{\Phi_I},
            \label{eq:ci_td_wave}
        \end{align}
        where the orbitals in the Slater determinants are static, i.e.,
        time-independent, meaning that the time-evolution happens in the
        coefficients $c_{I}(t)$.
        Our choice of initial state $\ket{\Psi(0)}$ is to a large degree
        arbitrary as long as the coefficients are normalized and the
        determinants span the entire space we are looking at.
        A natural choice is to choose $\ket{\Psi(0)} = \ket{\Psi_J}$, where
        $\ket{\Psi_J}$ is an eigenstate from the time-independent Schrödinger
        equation in \autoref{eq:ci_tise}.
        It is common to choose $J = 0$, i.e., the ground state, but there is
        nothing stopping us from choosing an arbitrary initial guess.
        For example, we can choose a single Slater determinant from our basis of
        determinants as an initial guess.
        This can be a good guess, especially if we use Hartree-Fock orbitals as
        our basis of spin-orbitals.

        Inserting \autoref{eq:ci_td_wave} into \autoref{eq:ci_tdse} we get an
        equation for time-evolution of the coefficients.
        \begin{align}
            i\hslash \dpd[]{}{t}c_{J}(t)\ket{\Phi_J}
            = \hamil(t) c_{J}(t)\ket{\Phi_J}.
        \end{align}
        Left-projecting with a Slater determinant $\ket{\Phi_I}$ then yields
        \begin{gather}
            i\hslash \dpd[]{}{t}c_{J}(t)\braket{\Phi_I}{\Phi_J}
            = \bra{\Phi_I}\hamil(t)\ket{\Phi_J} C_{J}(t) \\
            \implies
            i\hslash \dpd[]{}{t}c_{J}(t) S_{IJ}
            = H_{IJ}(t) c_{J}(t),
        \end{gather}
        where we've again introduced the matrix $S_{IJ}$ with overlaps between
        the Slater determinants and the time-dependent Hamiltonian matrix
        $H_{IJ}(t)$.
        We'll limit our attention to systems where the Slater determinants are
        orthonormal, thus leaving us with the equation
        \begin{align}
            i\hslash \dpd[]{}{t}c_{I}(t)
            = H_{IJ}(t) c_{J}(t).
            \label{eq:tdci}
        \end{align}
        As the initial coefficients $c_{I}(0)$ are known, we need to compute the
        matrix elements of the time-dependent Hamiltonian at each time step
        before using a time-evolution scheme to solve \autoref{eq:tdci}.
        Depending on the nature of the time-dependent interaction in the
        Hamiltonian, we can compute the time-dependent matrix elements by
        \begin{align}
            H_{IJ}(t)
            &= \bra{\Phi_I}\hamil(t)\ket{\Phi_J}
            = \bra{\Phi_I}\onehamil(t)\ket{\Phi_J}
            + \frac{1}{4}\bra{\Phi_I}\twohamil(t)\ket{\Phi_J}
            \\
            &=
            \oneten^{p}_{q}(t)
            \bra{\Phi_I}\ccr{p}\can{q}\ket{\Phi_J}
            + \frac{1}{4}\twoten^{pq}_{rs}(t)
            \bra{\Phi_I}\ccr{p}\ccr{q}\can{s}\can{r}\ket{\Phi_J}
            \\
            &=
            \oneten^{p}_{q}(t) \densityten^{q}_{p}
            + \frac{1}{4} \twoten^{pq}_{rs}(t) \densityten^{rs}_{pq},
        \end{align}
        where we in the last line have used the one- and two-body density
        matrices to evaluate the operator strings.

\chapter{Coupled cluster theory}
    % TODO: Why is coupled cluster so awesome?
    % Discuss size-consistency and size-extensivity.
    % Discuss exponential scaling catching all excitations of the reference
    % state.
    % Discuss how higher CI/CC coefficients/amplitudes contributing less than
    % the singles and doubles coefficients/amplitudes.
    % That is, for CCSDTQ, the doubles amplitudes will contribute more to the
    % quadruply excited states than the quadruple amplitudes.
    % See Crawford & Schaefer for a good intro to these topics.


    \section{Time-independent coupled cluster theory}
        This section follows closely the derivation done in
        \citetitle{crawford2000introduction} by
        \citeauthor{crawford2000introduction} \cite{crawford2000introduction}.
        Starting with the time-independent Schrödinger equation, the coupled
        cluster method seeks to find a many-body wave function $\ketcc$ which
        solves
        \begin{align}
            \hamil\ketcc = \energycc\ketcc.
        \end{align}
        Start from a single reference Slater determinant $\ketslat$ coupled
        cluster makes the ansatz that the true many-body wave function is given
        by
        \begin{align}
            \ketcc \equiv e^{\clust}\ketslat
            = \sum_{n = 0}^{\infty}\frac{1}{n!}\clust^n\ketslat,
            \label{eq:cc_wave_function}
        \end{align}
        where the \emph{cluster operator} $\clust$ is given by a sum of excitation
        operators $\clust_{\mu}$.
        \begin{align}
            \clust &= \sum_{\mu = 1}^{\infty} \clust_{\mu}
            = \clustamp^a_i\ccr{a}\can{i}
            + \para{\frac{1}{2!}}^2\clustamp^{ab}_{ij}\ccr{a}\ccr{b}\can{i}\can{j}
            + \para{\frac{1}{3!}}^2\clustamp^{abc}_{ijk}
            \ccr{a}\ccr{b}\ccr{c}\can{i}\can{j}\can{k}
            + \dots,
            \label{eq:cluster-operator}
        \end{align}
        where the cluster amplitudes $\clustamp^{abc\dots}_{ijk\dots}$ are the
        primary unknowns.
        In this formulation, the cluster amplitudes satisify the anti-symmetric
        properties
        \begin{align}
            \clustamp^{abc\dots}_{ijk\dots}
            = -\clustamp^{bac\dots}_{ijk\dots}
            = -\clustamp^{abc\dots}_{jik\dots}
            = \clustamp^{bac\dots}_{jik\dots},
        \end{align}
        where interchange of a pair of indices gives rise to a sign change.
        Furthermore, the cluster amplitudes commute with one another as the
        creation and annihilation operators run over non-overlapping sets of
        indices.
        Note that interchange of indices from upper to lower, or vice-versa, are
        not permitted.
        By inserting \autoref{eq:cc_wave_function} into the time-independent
        Schrödinger equation we get
        \begin{align}
            \hamil\ketcc
            = e^{\clust}\ketslat
            = \energycc e^{\clust}\ketslat
            = \energycc \ketcc.
        \end{align}
        Projecting onto the reference Slater determinant we are left with
        \begin{align}
            \braslat\hamil\ketcc
            &= \braslat\energycc e^{\clust}\ketslat
            = \energycc \braslat e^{\clust}\ketslat
            = \energycc,
            \label{eq:cc_energy}
        \end{align}
        where for orthonormal Slater determinants, the coupled cluster wave
        function assumes \emph{intermediate normalization}, viz.
        \begin{align}
            \braket{\slat}{\cc}
            &= \bra{\slat}\para{
                \1 + \clust + \frac{1}{2!}\clust^2 + \dots
            }\ket{\slat}
            = 1.
        \end{align}
        Using the same projection technique as for the energy equation, we can
        obtain expressions for the cluster amplitudes.
        All we have to do is project onto an excited reference state, where the
        order of the excitation decides which order of the amplitudes we are
        solving for.
        \begin{align}
            \bra{\slat_{\mu}}\hamil e^{\clust}\ketslat
            &= \energycc \bra{\slat_{\mu}} e^{\clust}\ketslat.
            \label{eq:cc_amp}
        \end{align}
        % TODO: Discuss how this equation arises.
        % Check the pink book chapter 13.1.4.
        Here the excitation order $\mu$ decides which amplitudes we are solving
        for, e.g., for the doubles cluster amplitudes $\clustamp^{ab}_{ij}$ we
        project onto the doubly excited reference state $\ket{\slat^{ab}_{ij}}$.
        These equations are non-linear due to the presences of the exponential
        function creating cross terms with other excited amplitudes.
        Furthermore, if we don't truncate the cluster operatar, $\clust$, we
        recover the exact wave function as in full configuration interaction,
        that is, exact within the space spanned by the basis of single-particle
        functions we are perusing.
        % TODO: Add proof of recovery of the exact wave function.
        The amplitude equations in \autoref{eq:cc_amp} must be solved
        iteratively in order to find a minimum of the energy.
        % TODO: Check this sentence again.

        By expanding the exponential cluster operator in a power series, as in
        \autoref{eq:cc_wave_function}, and inserting it into
        \autoref{eq:cc_energy} we get
        \begin{align}
            \bra{\slat}\hamil \ketcc
            &=
            \bra{\slat}\hamil
            \sum_{n = 0}^{\infty} \frac{1}{n!}\clust^n
            \ket{\slat}
            = \energycc.
        \end{align}
        Depending on the form of the Hamiltonian, we will get a natural
        truncation of the cluster operators.
        As a single cluster operator is at
        least an operator exciting a single particle in our reference state, an
        $n$-times exponentiated cluster operator will excite $n$ particles from
        the reference.
        Except for some rare cases in nuclear physics,
        % TODO: Find references for some articles dealing with three-body
        % problems.
        the Hamiltonian will \emph{at most} contain two-body elements and thus
        will only be able to excite or relax a pair of particles.
        As we are projecting onto the reference state the Hamiltonian is forced
        to relax the excitation done by the cluster operators in order to get a
        non-zero contribution.
        Thus, for a Hamiltonian with at most two-body operators the exponential
        power series gets truncated at $n = 2$ for the cluster operators, viz.
        \begin{align}
            \bra{\slat}\hamil \ketcc
            &=
            \bra{\slat}\hamil\ket{\slat}
            + \bra{\slat}\hamil \clust \ket{\slat}
            + \frac{1}{2!}
            \bra{\slat} \hamil \clust^2 \ket{\slat}
            = \energycc.
        \end{align}
        Note that this result is general irrespective of the truncation level
        chosen for the cluster operators themselves, which we'll discuss
        shortly.

        \subsection{Rewriting the coupled cluster equations}
            In order to get amiable equations for the coupled cluster energy and
            amplitudes, we left multiply the Hamiltonian by the inverse of the
            exponential cluster operator.
            We then get the equations
            \begin{gather}
                \braslat e^{-\clust} \hamil e^{\clust} \ketslat
                = \energycc,
                \label{eq:cc_energy_sim}
                \\
                \bra{\slat_{\mu}} e^{-\clust} \hamil e^{\clust} \ketslat
                = 0.
                \label{eq:cc_amp_sim}
            \end{gather}
            Even though \autoref{eq:cc_energy} and \autoref{eq:cc_amp} are
            theoretically correct, they are not tractable for a numerical
            implementation, unlike \autoref{eq:cc_energy_sim} and
            \autoref{eq:cc_amp_sim}.
            Furthermore, the amplitude equations are
            now decoupled from the energy equation, which will help conserve
            size-extensivity.
            % TODO: Elaborate on this point, see Crawford & Schaefer
            By applying the Baker-Campbell-Hausdorff formula, we are able to
            rewrite the Hamiltonian and the exponential operators as a linear
            combination of nested commutators between $\hamil$ and $\clust$.
            \begin{align}
                \simhamil
                &=
                e^{-\clust} \hamil e^{\clust}
                =
                \hamil
                + \com{\hamil}{\clust}
                + \frac{1}{2!}\com{
                    \com{
                        \hamil
                    }{
                        \clust
                    }
                }{
                    \clust
                }
                + \dots,
            \end{align}
            where $\simhamil$ is dubbed the \emph{similarity transformed
            Hamiltonian}.
            Introducing the normal-ordered Hamiltonian, $\hamil_N$, given by
            \begin{align}
                \hamil_N
                &= \hamil - \braslat\hamil\ketslat,
            \end{align}
            where the latter term is known as the \emph{reference energy} of the
            system, $\energyref \equiv \braslat\hamil\ketslat$.
            If the reference state is the Hartree-Fock state%
            \footnote{
                The reference state is more or less always the Hartree-Fock
                state in quantum chemistry computations.
            }
            all energy contributions beyond the reference energy is known as
            \emph{correlation energy}.
            As the reference energy is just a number, the similarity transformed
            normal-ordered Hamiltonian takes on the form
            \begin{align}
                \simhamil_N
                &= e^{-\clust}\hamil_N e^{\clust}
                = e^{-\clust}\hamil e^{\clust} - \braslat\hamil\ketslat
                = \simhamil - \energyref.
                \label{eq:sim-normal-hamil}
            \end{align}
            Next, we apply Baker-Campbell-Hausdorff formula to
            \autoref{eq:sim-normal-hamil} and use the generalized Wick's theorem
            to contract the Hamiltonian and the cluster operators.
            The only nonzero terms in this expansion will be the terms
            containing at least one contraction between the normal-ordered
            Hamiltonian and ever cluster operator on its right.
            This is called the ``connected cluster'' theorem and yields a
            natural truncation of the Baker-Campbell-Hausdorff expansion.
            % TODO: Prove this.
            % TODO: Cite sources on this.
            For a Hamiltonian with at most two-body interactions, this means
            that the expansion gets truncated at quartic terms, i.e., at most
            four cluster operators to the right of the Hamiltonian.
            \begin{align}
                \simhamil_N
                &=
                \brak{
                    \hamil_N
                    + \hamil_N \clust
                    + \frac{1}{2!} \hamil_N \clust^2
                    + \frac{1}{3!} \hamil_N \clust^3
                    + \frac{1}{4!} \hamil_N \clust^4
                }_c,
                \label{eq:connected-hamil}
            \end{align}
            where the subscript $c$ signifies that we only include the terms
            that are connected, i.e., the Hamiltonian has at least one
            contraction with every cluster operator to its right.
            Note that the connected cluster theorem is a statement about the
            similarity transformed normal-ordered Hamiltonian.
            It is therefore applicable even for the amplitude equations.

        \subsection{Truncated coupled cluster theory}
            As discussed in \autoref{sub:truncated-configuration-interaction},
            we demonstrated how the truncated configuration interaction wave
            function was unable to represent the full Slater determinant basis
            in a small toy system.
            Repeating the same discussion, but now for $\clust = \clust_1$,
            i.e., truncating the cluster operator at singles excitations, we can
            construct the \emph{coupled cluster singles} wave function
            \begin{align}
                \ket{\Psi} &= e^{\clust_1}\ketslat
                = \ketslat + \clust_1\ketslat + \frac{1}{2!}\clust_1^2\ketslat
                \\
                &= \ketslat
                + \clustamp^{3}_{1}\ket{\slat^{3}_{1}}
                + \clustamp^{4}_{1}\ket{\slat^{4}_{1}}
                + \clustamp^{3}_{2}\ket{\slat^{3}_{2}}
                + \clustamp^{4}_{2}\ket{\slat^{4}_{2}}
                \nonumber \\
                &\qquad
                + \frac{1}{2!}\para{
                    \clustamp^{3}_{1}\clustamp^{4}_{2}\ket{\slat^{34}_{12}}
                    + \clustamp^{4}_{1}\clustamp^{3}_{2}\ket{\slat^{43}_{12}}
                    - \clustamp^{3}_{2}\clustamp^{4}_{1}\ket{\slat^{34}_{21}}
                    - \clustamp^{4}_{2}\clustamp^{3}_{1}\ket{\slat^{43}_{21}}
                }
                \\
                &= \ketslat
                + \clustamp^{3}_{1}\ket{\slat^{3}_{1}}
                + \clustamp^{4}_{1}\ket{\slat^{4}_{1}}
                + \clustamp^{3}_{2}\ket{\slat^{3}_{2}}
                + \clustamp^{4}_{2}\ket{\slat^{4}_{2}}
                + \clustamp^{3}_{1}\clustamp^{4}_{2}\ket{\slat^{34}_{12}}
                + \clustamp^{4}_{1}\clustamp^{3}_{2}\ket{\slat^{43}_{12}},
            \end{align}
            where we've collected equal terms thus demonstrating the
            double-counting that occurs for unbounded sums in the cluster
            amplitudes.
            In fact, we can go even further by realizing that
            \begin{align}
                \ket{\slat^{43}_{12}} = -\ket{\slat^{34}_{12}},
            \end{align}
            due to the indistinguishability of the particles.
            This then yields the full wave function
            \begin{align}
                \ket{\Psi}
                &= \ketslat
                + \clustamp^{3}_{1}\ket{\slat^{3}_{1}}
                + \clustamp^{4}_{1}\ket{\slat^{4}_{1}}
                + \clustamp^{3}_{2}\ket{\slat^{3}_{2}}
                + \clustamp^{4}_{2}\ket{\slat^{4}_{2}}
                + \para{
                    \clustamp^{3}_{1}\clustamp^{4}_{2}
                    - \clustamp^{4}_{1}\clustamp^{3}_{2}
                }
                \ket{\slat^{34}_{12}}.
                \label{eq:ccs_wave_function}
            \end{align}
            Comparing \autoref{eq:ccs_wave_function} with the singles truncated
            configuration interaction wave function in
            \autoref{eq:cis_wave_function} we see that the missing doubly
            excited determinant is recovered.
            That is, we are able to use all basis functions as seen in
            \autoref{fig:tiny-slater-basis}.

        \subsection{Energy equations}
            \label{subsec:cc-energy-equations}
            We are now ready to generate equations for the energy of the
            many-body system using the coupled cluster method.
            We do this by computing
            \begin{align}
                \bra{\slat}e^{-\clust}\hamil e^{\clust}\ket{\slat}
                = \bra{\slat}\simhamil\ket{\slat}
                = \bra{\slat}\simhamil_N\ket{\slat}
                + \bra{\slat}\hamil\ket{\slat}
                = \energycc.
            \end{align}
            Having already found an expression for the reference energy
            \begin{align}
                \energyref \equiv \bra{\slat}\hamil\ket{\slat}
                = \oneten^{i}_{i}
                + \half \twoten^{ij}_{ij}
                = \fockten^{i}_{i}
                - \half\twoten^{ij}_{ij},
            \end{align}
            our job is now to compute the expectation value of the similarity
            transformed normal-ordered Hamiltonian, or more concisely, the
            coupled cluster correlation energy.
            Inserting the expression in \autoref{eq:connected-hamil} for the
            Hamiltonian, we analyze term by term.
            The first term is the expectation value of the normal-ordered
            Hamiltonian.
            This term is zero by construction, viz.
            \begin{align}
                \bra{\slat}\hamil_N\ket{\slat} = 0.
            \end{align}
            As we are perusing a Hamiltonian with at most two-body operators,
            this means that the reference state can at most be twice excited by
            the cluster ampltudes in order for the Hamiltonian to be able to
            relax the excited state back to the reference state.
            If not, the overlap with the reference state will become zero.
            The cluster operators provide a net excitation of at least one each,
            thus
            \begin{align}
                \frac{1}{3!}
                \bra{\slat}\brak{
                    \hamil_N
                    \clust^3
                }_c\ket{\slat}
                =
                \frac{1}{4!}
                \bra{\slat}\brak{
                    \hamil_N
                    \clust^4
                }_c\ket{\slat}
                = 0,
            \end{align}
            where we again use the subscript $c$ to denote that we only include
            connected cluster operators.
            By virtue of the same argument as above, we come to realize that
            only singles and doubles amplitudes can contribute to the energy
            equations.
            All higher order amplitudes will contribute by ``removing stress''
            from the singles and doubles amplitudes.
            This can in many ways be seen as a technique leading to more correct
            singles and doubles amplitudes thus yielding better correlation
            energies.
            If we assume that the cluster operators contain at least the
            singles and doubles cluster operators, that is,
            \begin{align}
                \clust = \clust_1 + \clust_2 + \dots,
            \end{align}
            we get the energy contributions
            \begin{align}
                \bra{\slat}\brak{
                    \hamil_N \clust
                }_c\ket{\slat}
                =
                \fockten^{i}_{a}\clustamp^{a}_{i}
                +
                \frac{1}{4}\twoten^{ij}_{ab} \clustamp^{ab}_{ij},
                \label{eq:cc-energy-linear-contrib}
            \end{align}
            for the lone cluster operator, whereas the squared operator yields
            \begin{align}
                \frac{1}{2!}\bra{\slat}\brak{
                    \hamil_N \clust^2
                }_c\ket{\slat}
                &=
                \half \twoten^{ij}_{ab}\clustamp^{a}_{i}\clustamp^{b}_{j}.
                \label{eq:cc-energy-squared-contrib}
            \end{align}
            For a complete derivation of these expressions see
            \autoref{app:cc-energy-equations}.
            Including the reference energy, the total energy equation in the
            coupled cluster method is given by
            \begin{align}
                \energycc
                &= \bra{\slat}\simhamil\ket{\slat}
                =
                \fockten^{i}_{i}
                - \half \twoten^{ij}_{ij}
                + \fockten^{i}_{a}\clustamp^{a}_{i}
                + \half\twoten^{ij}_{ab}\brak{
                    \half\clustamp^{ab}_{ij}
                    + \clustamp^{a}_{i}\clustamp^{b}_{j}
                }.
                \label{eq:cc-energy-equation}
            \end{align}
            Depending on the truncation level of the cluster operators, we can
            adjust the energy expression in \autoref{eq:cc-energy-equation}.
            For example, in the coupled cluster doubles approximation, we get
            the energy equation
            \begin{align}
                \energyccd
                &= \bra{\slat}e^{-\clust_2}\hamil e^{\clust_2}\ket{\slat}
                =
                \fockten^{i}_{i}
                - \half \twoten^{ij}_{ij}
                + \frac{1}{4}\twoten^{ij}_{ab} \clustamp^{ab}_{ij}.
                \label{eq:ccd-energy-equation}
            \end{align}
            It is a sobering situation that only the reference, singly and
            doubly excited states do contribute to the final energy expression.
            All higher excitations couple to the energy, but the do not directly
            occur in the energy equation.
            % TODO: Why is it only singles and doubles excitations contributing
            % to the overall energy?


        \subsection{Amplitude equations}
            Using \autoref{eq:cc_amp_sim} and Wick's theorem we find a set of
            non-linear equations which we solve iteratively to construct the
            coupled cluster amplitudes.
            Unlike the energy equations in \autoref{eq:cc_energy_sim}, we are no
            longer projecting onto the reference state.
            This means that in addition to the similarity transformed
            Hamiltonian, we get an extra set of normal-ordered creation and
            annihilation operators from the excited state we are projecting
            onto.
            This seemingly benign inclusion of pairs of operators leads to a
            quite significant increase in the number of terms arising from
            Wick's theorem and can quickly lead to long and winded computations
            prone to much error.
            There are several ways to attack this problem, either by direct
            computation using Wick's theorem \cite{crawford2000introduction} or
            the more elegant solution of using diagrams \cite{shavitt2009many,
            crawford2000introduction}.
            The task at hand is to evaluate the equations
            \begin{align}
                \bra{\slat_{\mu}}\simhamil\ket{\slat}
                = \bra{\slat_{\mu}}\simhamil_N\ket{\slat}
                = \bra{\slat}\hat{X}^{\dagger}_{\mu}\simhamil_N\ket{\slat}
                = 0,
            \end{align}
            where we we've simplified by similarity transformed Hamiltonian
            by inserting the normal ordered similiarty transformed Hamiltonian
            as the overlap between the excited state and the reference state is
            zero.
            Furthermore, we've introduced the excitation operator
            $\hat{X}_{\mu}$ consisting of creation and annihilation operators
            such that
            \begin{align}
                \ket{\slat_{\mu}} = \hat{X}_{\mu}\ket{\slat}.
            \end{align}
            As $\hat{X}_{\mu}$ is an excitation operator, this means that
            $\hat{X}^{\dagger}_{\mu}$ is a relaxation operator annihilating the
            reference state.
            As an example we'll look at the excitation operator for a doubly
            excited reference state
            \begin{align}
                \ket{\slat^{ab}_{ij}}
                &= \hat{X}^{ab}_{ij}\ket{\slat}
                = \ccr{b}\can{j}\ccr{a}\can{i}\ketslat
                \\
                \bra{\slat^{ab}_{ij}}
                &= \bra{\slat}(\hat{X}^{ab}_{ij})^{\dagger}
                = \braslat \ccr{i}\can{a}\ccr{j}\can{b},
            \end{align}
            where we note that the last operator string is on normal ordered
            form relative to the Fermi vacuum.
            As the operator $\hat{X}^{\dagger}_{\mu}$ relaxes the incoming state
            by an order $\mu$ we need only keep terms from the normal ordered
            similarity transformed Hamiltonian that leaves the reference state
            excited at $\mu$.
            We will therefore look for terms in \autoref{eq:connected-hamil}
            that yields
            \begin{align}
                \simhamil_N\ketslat
                &\propto \ket{\slat_{\mu}},
            \end{align}
            as all other terms will vanish.
            For each set of amplitudes we get a corresponding set of amplitude
            equations.
            As an example, for the coupled cluster singles and doubles method we
            get the pair of amplitude equations
            \begin{gather}
                \bra{\slat^{a}_{i}}
                \simhamil_N\ketslat
                =
                \bra{\slat}
                (\hat{X}^{a}_{i})^{\dagger}
                \simhamil_N\ketslat
                = 0,
                \\
                \bra{\slat^{ab}_{ij}}
                \simhamil_N\ketslat
                =
                \bra{\slat}
                (\hat{X}^{ab}_{ij})^{\dagger}
                \simhamil_N\ketslat
                = 0.
            \end{gather}
            Having found expressions for the amplitudes, we do self-consistent
            field iterations in order to find amplitudes which satisfies the
            equations for the amplitudes.
            % TODO: Discuss the SCF-procedure for CC
            % TODO: Discuss the use of SymPy to find the amplitude equations
            % TODO: Remember to discuss the D-matrix


        \subsection{Non-variational coupled cluster}
            From the postulates of quantum mechanics we know that every physical
            observable $q$ is described by a Hermitian operator $\hat{Q}$ acting
            on the Hilbert space of state vectors.
            Having defined the coupled cluster wave function $\ket{\Psi}$ by
            \begin{align}
                \ket{\Psi} = e^{\clust}\ketslat,
            \end{align}
            we would expect to be able to construct a solution to the amplitudes
            by virtue of the variational principle.
            That is, by requiring that the amplitudes minimize the expression
            \begin{align}
                \energygs
                \leq \energycc
                = \frac{\bra{\Psi}\hamil\ket{\Psi}}{\braket{\Psi}{\Psi}}
                = \frac{
                    \braslat (e^{\clust})^{\dagger}\hamil e^{\clust}\ketslat
                }{
                    \braslat (e^{\clust})^{\dagger} e^{\clust}\ketslat
                }.
                \label{eq:variational-cc}
            \end{align}
            However, there are some serious limitations in
            \autoref{eq:variational-cc}.
            The cluster operators are not Hermitian.
            This can be observed from the fact that taking the Hermitian
            conjugate of a cluster operator yields a relaxation operator instead
            of an excitation operator.
            By computing the series expansion of the exponential operators we
            find
            \begin{align}
                \braslat (e^{\clust})^{\dagger}\hamil e^{\clust}\ketslat
                = \braslat\para{
                    \1 + \clust^{\dagger} + \dots
                }
                \hamil
                \para{
                    \1 + \clust + \dots
                }
                \ketslat,
                \label{eq:expansion-variational-cc}
            \end{align}
            where the relaxation operators on the left will act as excitation
            operators on the reference state we are projecting onto.
            This means that we no longer get a natural truncation with respect
            to the Hamiltonian.
            In \autoref{subsec:cc-energy-equations} we discussed how the
            Hamiltonian at most can net relax an exited state by $2$.
            This truncates the Baker-Campbell-Hausdorff expansion naturally at
            squared cluster operators which can provide a net excitation of $2$.
            In \autoref{eq:expansion-variational-cc} we no longer get this
            truncation.

            As the variational formulation of coupled cluster yields intractable
            equations and we note that the similarity transformed Hamiltonian is
            non-Hermitian thus violating the postulates of quantum mechanics, we
            are seemingly in a lot of trouble.
            Luckily, by not truncating the cluster operator\footnote{%
                Or, for $N$ particles truncating at $\clust_N$.
            } we will recover the formally exact solution within the space
            spanned by our basis of spin-orbitals \cite{coester1958421,
            monkhorst1977421}.

        \subsection{The coupled cluster Lagrangian}
            Even though we conclude that the non-variational formulation of
            the coupled cluster method yields an exact solution in the
            untruncated limit, and is accurate enough in the truncated limit
            that the lack of a bounded energy is not a large problem,
            we will get problems when looking at other properties than the
            energy as the conditions for the Hellmann-Feynman theorem are not
            met \cite{helgaker-molecular}.
            There have been attempts at computing observable quantities by using
            the variational expectation value for the operator in question
            \cite{exp-value-cizek, fink1974163}
            \begin{align}
                \expv{O}
                &= \frac{\bra{\Psi}\hat{O}\ket{\Psi}}{\braket{\Psi}{\Psi}}
                = \frac{
                    \braslat (e^{\clust})^{\dagger}
                    \hat{O}
                    e^{\clust}\ketslat}
                {\braslat (e^{\clust})^{\dagger} e^{\clust} \ketslat},
            \end{align}
            but as $\ket{\Psi}$ is not found from optimization of the energy
            using the variational principle in \autoref{eq:variational-cc}, we
            do not necessarily have that the energy found from the variational
            principle is the same as the energy found from the projected energy
            equation \cite{kvaal2013variational}.
            Replacing the Hamiltonian in \autoref{eq:cc_energy_sim} with the
            operator of the observable in question, we do get an expression for
            the observable.
            However, we return to the problem of computing first order
            properties being a cumbersome problem as the Hellmann-Feynman
            theorem is still not satisfied \cite{helgaker-molecular,
            kvaal2013variational}.

            In order for us to conform to the Hellmann-Feynman theorem, we can
            use a technique where we construct a variational Lagrangian
            \cite{helgaker1989}.
            To motivate the need for a variational Lagrangian, we consider the
            coupled cluster energy functional subject to a small perturbation
            $g$ \cite{monkhorst1977421}
            \begin{align}
                E[g, \clustamp_{\mu}]
                &= \braslat e^{-\clust(g)}
                \hamil(g)
                e^{\clust(g)}
                \ketslat,
                \label{eq:cc-perturbed-energy}
            \end{align}
            where $\mu$ and $\nu$ denotes an excitation level and
            $\clustamp_{\mu}$ is the set of all cluster amplitudes at this
            excitation.
            We also note that as the perturbation is represented on a grid, we
            will in the second quantized formulation absorb the pertubation in
            the matrix elements of the wave function instead of the wave
            function itself \cite{helgaker-molecular}.
            The expansion of the operators will then become
            \cite{monkhorst1977421}
            \begin{align}
                \hamil(g) &= \hamil + g\hamil^{(1)} + g^2\hamil^{(2)} + \dots, \\
                \clust(g) &= \clust + g\clust^{(1)} + g^2\clust^{(2)} + \dots.
            \end{align}
            We find the optimized energy of \autoref{eq:cc-perturbed-energy} by
            \begin{align}
                E(g) &= E[g, \clustamp^{*}_{\mu}]
            \end{align}
            where $\clustamp^{*}_{\mu}$ for a given $g$ represents the solution
            to the set of amplitude equations
            \begin{align}
                f_{\mu}[g, \vfg{\clustamp}_{*}]
                &=
                \left.
                \bra{\Phi_{\mu}}
                e^{-\clust(g)}
                \hamil(g)
                e^{\clust(g)}
                \ketslat
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                = 0.
                \label{eq:cc-amplitude-set}
            \end{align}
            Now if the coupled cluster wave function was indeed variational,
            this condition corresponds to finding the stationary point of the
            energy functional by
            \begin{align}
                \left.
                \dpd[]{E[g, \clustamp_{\mu}]}{\clustamp_{\nu}}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                = 0,
                \label{eq:cc-variational-condition}
            \end{align}
            for every $g$ that we peruse.
            As the wave function in fact isn't variational, this means that the
            total derivative of the optimized energy with respect to the
            pertubational parameter $g$ can not be computed simply as the
            partial derivative of the energy functional with respect to $g$ with
            $\clustamp_{\mu}$ evaluated at $\clustamp^{*}_{\mu}$.
            That is,
            \begin{align}
                \dod[]{E(g)}{g}
                =
                \left.
                \dod[]{E[g, \clustamp_{\mu}]}{g}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                &=
                \left.
                \dpd[]{E[g, \clustamp_{\mu}]}{g}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                +
                \left.
                \dpd[]{E[g, \clustamp_{\mu}]}{\clustamp_{\nu}}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                \left.
                \dpd[]{\clustamp_{\nu}}{g}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}}
                \\
                &\neq
                \left.
                \dpd[]{E[g, \clustamp_{\mu}]}{g}
                \right\rvert_{\clustamp_{\mu} = \clustamp^{*}_{\mu}},
            \end{align}
            as \autoref{eq:cc-variational-condition} is not satisified.
            In order to satisty \autoref{eq:cc-variational-condition} and the
            Hellmann-Feynman theorem we use Lagrange's method of undetermined
            multipliers to introduce a new set of parameters $\clustlamp_{\mu}$,
            one for every cluster amplitude.
            We incorporate the original energy functional in
            \autoref{eq:cc-perturbed-energy} into a Lagrangian functional with
            the set of amplitude equations in \autoref{eq:cc-amplitude-set}
            multiplied with the multipliers.
            \begin{align}
                L[g, \clustamp_{\mu}, \clustlamp_{\mu}]
                &= E[g, \clustamp_{\nu}]
                + \clustlamp_{\mu} f_{\mu}[g, \clustamp_{\nu}]
                \\
                &=
                \bra{\slat}e^{-\clust(g)}\hamil(g) e^{\clust(g)}\ket{\slat}
                +
                \clustlamp_{\mu}
                \bra{\slat_{\mu}}
                e^{-\clust(g)}\hamil(g) e^{\clust(g)}\ket{\slat}
                \\
                &=
                \bra{\slat}
                \para{\1 + \clustl}
                e^{-\clust(g)}\hamil(g) e^{\clust(g)}
                \ket{\slat},
                \label{eq:cc-perturbed-lagrangian}
            \end{align}
            where we've introduced the relaxation operator $\clustl$ from the
            Lagrange multipliers along with the string of relaxation operators
            from the excited state $\ket{\slat_{\mu}} = \hat{X}_{\mu}\ketslat$
            we project onto in the amplitude equations.
            That is,
            \begin{align}
                \clustl
                &\equiv
                \clustlamp_{\mu}\hat{X}^{\dagger}_{\mu}
                = \clustlamp^{i}_{a}\ccr{i}\can{a}
                + \frac{1}{4}\clustlamp^{ij}_{ab}\ccr{i}\can{a}\ccr{j}\can{b}
                + \dots
                \equiv
                \clustl_1 + \clustl_2 + \dots,
            \end{align}
            with the truncation level $\mu$ matching the truncation of the
            cluster operators $\clust$.
            Optimizing \autoref{eq:cc-perturbed-lagrangian} with respect to the
            parameters $\clustamp_{\mu}$ and $\clustlamp_{\mu}$ we get equations
            which lets us find the stationary points $\clustamp^{*}_{\mu}$ and
            $\clustlamp^{*}_{\mu}$.
            \begin{gather}
                \dpd[]{L[g, \clustamp_{\mu},\clustlamp_{\mu}]}
                {\clustlamp_{\nu}}
                = \bra{\slat_{\nu}}
                e^{-\clust(g)}\hamil(g) e^{\clust(g)}
                \ketslat
                = 0,
                \\
                \dpd[]{L[g, \clustamp_{\mu}, \clustlamp_{\mu}]}
                {\clustamp_{\nu}}
                = \bra{\slat}
                \para{\1 + \clustl}
                e^{-\clust(g)}
                \com{\hamil(g)}{\hat{X}_{\nu}}
                e^{\clust(g)}
                \ketslat
                = 0,
            \end{gather}
            where we note that the first equation in the absence of the
            perturbation corresponds to the projected amplitude equations in
            \autoref{eq:cc_amp_sim}.
            The second equation yields the solution to the Lagrange multipliers.
            This equation is slightly more involved as the extra set of
            amplitudes generates an increased amount of contractions to be
            solved.
            Using Wick's generalized theorem in the same manner as for the
            cluster amplitudes on the second equation yields explicit tensor
            contractions which must be solved iteratively in order to find
            self-consistent values for the Lagrange multipliers.
            In the abscence of the perturbation we write the coupled cluster
            Lagrangian as
            \begin{align}
                L[\clustamp_{\mu}, \clustlamp_{\mu}]
                &= \mel{\slat}{
                    \para{\1 + \clustl}
                    e^{-\clust}
                    \hamil
                    e^{\clust}
                }{\slat}
                = \mel*{\tilde{\Psi}}{\hamil}{\Psi},
                = E[\clustamp_{\mu}, \clustlamp_{\mu}],
                \label{eq:cc-energy-functional}
            \end{align}
            which we interpret as the variational coupled cluster energy
            functional.
            We've denoted the coupled cluster wave functions by
            \begin{gather}
                \ket{\Psi} = e^{\clust}\ket{\slat}, \\
                \bra*{\tilde{\Psi}} = \bra{\slat}\para{\1 + \clustl}e^{-\clust}.
            \end{gather}
            Furthermore, we have that
            \begin{align}
                L[\clustamp_{\mu}, \clustlamp_{\mu}]
                = \tr(\hamil\density),
            \end{align}
            where the coupled cluster density operator is defined by
            \cite{kvaal2013variational}
            \begin{align}
                \density
                &= \dyad*{\Psi}{\tilde{\Psi}}
                = e^{\clust}\dyad{\slat}{\slat}\para{\1 + \clustl}e^{\clust}.
                \label{eq:cc-density-operator}
            \end{align}
            Using this definition for the coupled cluster density operator we
            have that
            \begin{align}
                \tr{\density}
                &= \tr{\dyad*{\Psi}{\tilde{\Psi}}}
                = \bra*{\tilde{\Psi}}\ket{\Psi}
                \bra*{\tilde{\Psi}}\ket{\Psi}
                = 1,
            \end{align}
            which shows that the probabilities sum up to unity.
            To see this, observe that the exponentiated cluster operators cancel
            each other and the $\clustl$-operator destroys the reference.
            We are thus left left with the overlap between the normalized
            reference states.
            Furthermore, we see that
            \begin{align}
                \density^2
                = \density\density
                = \ket{\Psi}\braket*{\tilde{\Psi}}{\Psi}
                \bra*{\tilde{\Psi}}
                = \dyad*{\Psi}{\tilde{\Psi}}
                = \density,
            \end{align}
            making the density operator idempotent.
            This also means that the coupled cluster wave function is a pure
            state wave function.
            However, not surprisingly, we have that
            \begin{align}
                \density \neq \density^{\dagger}.
            \end{align}
            The observation that the coupled cluster ansatz with the Lagrange
            multipliers describe a pure, non-Hermitian, state leads to the
            interpretation of the coupled cluster wave function using the
            \emph{bi-variational principle} \cite{arponen1983311, lowdin-bi,
            kvaal2012ab, kvaal2013variational}
            We will expand on this notion when we discuss the orbital-adaptive
            time-dependent coupled cluster method later.

        \subsection{Density matrices}
            From the variational energy functional in
            \autoref{eq:cc-energy-functional} we can construct the one- and
            two-body density matrices.
            % TODO: What has this got to do with the Hellmann-Feynman theorem?
            \begin{align}
                E[\clustamp_{\mu}, \clustlamp_{\mu}]
                &= \mel*{\tilde{\Psi}}{\hamil}{\Psi}
                = \oneten^{p}_{q}
                \mel*{\tilde{\Psi}}{\ccr{p}\can{q}}{\Psi}
                + \frac{1}{4}
                \twoten^{pq}_{rs}
                \mel*{\tilde{\Psi}}{\ccr{p}\ccr{q}\can{s}\can{r}}{\Psi}
                \\
                &=
                \oneten^{p}_{q} \densityten^{q}_{p}
                + \frac{1}{4}
                \twoten^{pq}_{rs}
                \densityten^{rs}_{pq},
            \end{align}
            where the density matrices are treated as first order properties of
            the energy functional thus making use of the Hellmann-Feynman
            theorem.
            \begin{align}
                \densityten^{q}_{p}
                &= \mel*{\tilde{\Psi}}{\ccr{p}\can{q}}{\Psi}
                = \mel*{\slat}{
                    \para{\1 + \clustl}e^{-\clust}\ccr{p}\can{q} e^{\clust}
                }{\slat},
                \label{eq:cc-one-body-density}
                \\
                \densityten^{rs}_{pq}
                &= \mel*{\tilde{\Psi}}{
                    \ccr{p}\ccr{q}\can{s}\can{r}
                }{\Psi}
                = \mel*{\slat}{
                    \para{\1 + \clustl}e^{-\clust}
                    \ccr{p}\ccr{q}
                    \can{s}\can{r}
                    e^{\clust}
                }{\slat},
                \label{eq:cc-two-body-density}
            \end{align}
            where an explicit solution depends on the truncation level $\clust$
            and $\clustl$.

        \subsection{The non-orthogonal coupled cluster method}
            Including explicit orbital rotations in the coupled cluster
            Lagrangian is a technique to make the coupled cluster method gauge
            invariant \cite{gauge-invariant-thomas, gauge-invariant-thomas-2}
            and have it satisfy Ehrenfest's theorem \cite{rolf-nocc}.
            There exists several methods that include orbital rotations in the
            coupled cluster formalism, such as, the orbital optimized coupled
            cluster method, and the Brueckner coupled cluster method.
            % TODO: Add citations from Rolf to these?
            These methods do suffer from certain defects, where the former does
            not converge to the full configuration interaction method in the
            untruncated limit, and the latter yields unphysical results in the
            second order poles in the response function \cite{rolf-nocc}.
            However, the method we will discuss is the non-orthogonal coupled
            cluster method \cite{gauge-invariant-thomas-2} in which we relax the
            requirement that the orbital transformations should be unitary
            \cite{rolf-nocc}.
            This method has been demonstrated to converge to the full
            configuration interaction method in the untruncated limit
            \cite{rolf-nocc}.
            This yields bi-orthogonal orbitals leading to a bi-variational
            Lagrangian \cite{kvaal2013variational} in a formulation resembling
            that of \citeauthor{arponen1983311} \cite{arponen1983311}.

            In the non-orthogonal method we introduce a singles operators
            $\nocc$ given by
            \begin{align}
                \nocc = \noccten_{pq}\ccr{p}\bican{q},
            \end{align}
            where $\bican{p}$ is an annihilation operator for a bi-orthogonal
            Hilbert space.
            Note that in general $\para{\bican{p}}^{\dagger} \neq \ccr{p}$, but
            we have
            \begin{align}
                \acom{\bican{p}}{\ccr{q}} = \delta_{pq},
            \end{align}
            that is, the anti-commutation relations hold and we can still
            utilize Wick's theorem \cite{kvaal2012ab}, as long as the original
            atomic orbitals basis is orthonormal.
            % TODO: Maybe make a bigger point out of this?
            We have that $\noccten_{aa} = \noccten_{ii} = 0$ which lets
            separate the orbital rotation operator in two blocks.
            \begin{align}
                \nocc
                = \noccten_{ai} \ccr{a}\bican{i}
                + \noccten_{ia} \ccr{i}\bican{a}
                \equiv
                \nocc^{u} + \nocc^{d},
            \end{align}
            where we've introduced the labels $u$ and $d$ for up and down
            respectively \cite{rolf-nocc}.
            Constructing the bi-variational non-orthogonal coupled cluster
            Lagrangian
            \begin{align}
                L[\clustamp_{\mu}, \clustlamp_{\mu}, \nocc^{u}, \nocc^{d}]
                &= \mel*{\tilde{\Psi}}{\hamil}{\Psi}
                = \mel*{\tilde{\slat}}{
                    \para{\1 + \clustl}
                    e^{-\clust} e^{-\nocc}
                    \hamil
                    e^{\nocc} e^{\clust}
                }{\slat},
            \end{align}
            where we've introduced the left reference state
            \begin{align}
                \bra*{\tilde{\slat}}
                = \bra*{\tilde{\phi}_1, \dots, \tilde{\phi}_N}
                = \bra{\vac}\bican{1}\dots\bican{N},
            \end{align}
            as the bi-orthogonal dual state of the right reference state defined
            in the normal way.
            We require that $\bra*{\tilde{\Psi}}$ and $\ket{\Psi}$ must satisfy
            the standard coupled cluster equations \cite{rolf-nocc}.
            % TODO: Discuss how kappa is zero when computing right-hand sides
            % TODO: Add equations for tau, lambda, and kappa.

    \section{Time-dependent coupled cluster theory}
        Stuff!

        \subsection{Normalization of the coupled cluster wave functions in time}
            We compute the normalization of the coupled cluster wave function by
            \begin{align}
                \braket{\tilde{\Psi}(t)}{\Psi(t)} = N(t).
            \end{align}
            When using static orbitals this reduces to
            \begin{align}
                \braket{\tilde{\Psi}(t)}{\Psi(t)}
                = \bra{\slat}\para{
                    \1 + \clustl(t)
                } e^{-\clust(t)}
                e^{\clust(t)}
                \ket{\slat}
                = \braket{\slat}{\slat}
                = 1,
            \end{align}
            where we assume that the reference determinant is normalized to
            unity.
            We can then see that the static formulation of the coupled cluster
            methods are, by construction, normalized to unity.
            However, for the orbital-adaptive method where the orbitals are
            allowed to vary in time, the picture changes.
            \begin{align}
                \braket{\tilde{\Psi}(t)}{\Psi(t)}
                &=
                \bra{\tilde{\Phi}(t)}
                \para{
                    \1 + \clustl(t)
                }
                e^{-\clust(t)}
                e^{\clust(t)}
                \ket{\slat(t)}
                \\
                &= \braket{\tilde{\Phi}(t)}{\Phi(t)}
                = \det\brak{\vfg{T}(t)}
                = N(t),
                \label{eq:norm-oatdcc}
            \end{align}
            where we have introduced the matrix $\vfg{T}(t)$ as the product of
            the coefficient matrices for occupied indices.
            That is,
            \begin{align}
                T^{i}_{j}(t) = \tilde{C}^{i}_{\alpha}(t) C^{\alpha}_j(t)
            \end{align}
            where the coefficients are limited to run over the occupied orbitals
            in the reference Slater determinants, but $\alpha$ runs over all the
            atomic orbitals\footnote{%
                There is no problem in computing the determinant of the full
                product between the coefficient matrices as this should yield
                the identity, but formally only the occupied orbitals are
                included in the reference states.
            }.
            Here we observe that the normalization constant can change in time.
            Mathematically, we construct the product between the coefficients to
            be the identity, i.e.,
            \begin{align}
                \tilde{\vfg{C}}(t)\vfg{C}(t)
                = \1,
                \label{eq:oatdcc-coeff-identity}
            \end{align}
            where this product runs over all indices $p$ and $q$.
            We therefore expect that $N(t) = 1$ for all times $t$, but due to
            integration errors in the numerical differential equation solvers we
            will observe a time-dependent drift.
            By measuring the time-dependent norm from \autoref{eq:norm-oatdcc}
            and the preservation of the identity for the coefficients from
            \autoref{eq:oatdcc-coeff-identity} in the orbital-adaptive regime,
            we can make an educated guess as to when the integration breaks.

        \subsection{Measuring the quality of the reference state in time}
            When evolving a system in time, we can -- and will -- get in a
            situation where the our initial state has little to no overlap with
            the time-evolved state.
            That is, we can get in a situation where
            \begin{align}
                \braket{\psi(t)}{\psi(0)} \to 0,
            \end{align}
            where $\ket{\psi(0)}$ is some initial state and $\ket{\psi(t)}$ is
            the time-evolved state at a later time $t$.
            In time-dependent configuration interaction theory\footnote{
                Without intermediate normalization.
                % TODO: Check if this applies in general
            } this is handled automatically by the
            zero-order amplitude.
            \begin{gather}
                \ket{\ci(t)} = C_0(t)\ketslat + C^{a}_{i}(t)\ket{\slat^{a}_{i}} + \dots
                \implies \braket{\slat}{\ci(t)} = C_0(t),
            \end{gather}
            where $\ketslat$ is the reference determinant and we have
            orthonormal determinants.
            In time-dependent coupled cluster theory where we assume
            intermediate normalization, there is however a different story to be
            told.
            For the time-dependent coupled cluster wavefunction we have that
            \begin{gather}
                \ket{\cc(t)} = e^{\clust(t)}\ketslat
                = \para{
                    \1
                    + \clust(t)
                    + \dots
                }\ketslat
                \implies
                \braket{\slat}{\cc(t)} = 1.
            \end{gather}
            This might not look like much, but for strong fields, or long
            time-evolution, we quickly find states which have little to no
            overlap with the original reference state.
            When this is the case the cluster amplitudes are left with the job
            of both ``removing'' the reference state from the cluster wave
            function \emph{and} providing contribution from higher excited
            determinants \cite{pedersen2018symplectic}.
            Frustratingly enough the formulation of time-dependent coupled
            cluster with static spin-orbitals is not able to solve this problem.
            When $\braket{\slat}{\cc(t)} \to 0$, the magnitude of the amplitudes
            sky-rocket, the energy is no longer conserved (when the
            time-dependence in the Hamiltonian is turned off), and the data
            produced can no longer be trusted.
            % TODO: This can be shown theoretically. See article by Thomas and
            % Simen for the steps.
            Luckily, there is a solution\footnote{
                As far as the author can tell.
            } where we allow the spin-orbitals change in time along with the
            amplitudes.
            We will in the coming sections explore two versions of this scheme
            and demonstrate that this fixes the problems described by
            \citeauthor{pedersen2018symplectic} \cite{pedersen2018symplectic}.

            But, before we try to solve the problem, we can formulate a
            ``zero-order'' amplitude for the time-dependent coupled cluster wave
            function which does not solve the problem, but at least lets us
            measure how good or bad the reference state is in time.
            This is done by introducing a phase factor $\clustamp_0(t) \in
            \mathbb{C}$ which we insert in the exponential ansatz.
            \begin{gather}
                \ket{\cc(t)}
                = e^{\clustamp_0(t) + \clust(t)}\ketslat
                = e^{\clustamp_0(t)} e^{\clust(t)}\ketslat,
                \\
                \bra{\bicc(t)}
                = \braslat\para{\1 + \clustl(t)}
                e^{-\clustamp_0(t) - \clust(t)}
                = \braslat\para{\1 + \clustl(t)}
                e^{-\clust(t)} e^{-\clustamp_0(t)},
            \end{gather}
            where we've used that $\clustamp_0(t)$ is a number to separate it
            from the cluster amplitudes in the exponential.
            Regardless if $\clustamp_0(t)$ is real or not, the inclusion of the
            phase does not change any of the equations used in coupled cluster.
            However, we can now see that
            \begin{align}
                \braket{\slat}{\cc(t)} = e^{\clustamp_0(t)},
            \end{align}
            which tells us how good the reference state $\ketslat$ is at a later
            time $t$.
            Note that the inclusion of $\clustamp_0(t)$ is in no way able to be
            used as a amplitude to lower the presence of the reference as in the
            configuration interaction method.
            We also see that for $\clustamp_0(t) = 0$ we recover intermediate
            normalization and the known time-dependent coupled cluster method.
            The question remains how we can evaluate $\clustamp_0(t)$ from the
            coupled cluster equations.
            In general we find the time derivative of the cluster amplitudes
            from
            \begin{align}
                i\hslash \dpd[]{}{t}\clustamp_{\mu}
                &=
                \bra{\slat_{\mu}} e^{-\clust(t)} \hamil(t) e^{\clust(t)}
                \ketslat,
            \end{align}
            where $\mu$ denotes the excitation level of the reference slater
            determinant and the order of the cluster amplitudes as in
            \autoref{eq:cluster-operator}.
            By choosing $\mu = 0$ we are left with
            \begin{align}
                i\hslash \dpd[]{}{t}\clustamp_{0}
                &=
                \bra{\slat} e^{-\clust(t)} \hamil(t) e^{\clust(t)}
                \ketslat
                =
                \bra{\slat} \hamil(t) e^{\clust(t)}
                \ketslat,
            \end{align}
            which should look familiar as the equation for the ground state
            energy in the time-independent coupled cluster method if the
            explicit time-dependence is removed from the Hamiltonian and the
            cluster amplitudes\footnote{%
                Note that we've removed cluster amplitudes from the left-hand
                side to get the same expression as
                \citeauthor{pedersen2018symplectic}.
            }.
            % TODO: Elaborate on why lambda_0(t) = 1.

\chapter{Many-body quantum mechanics}
    \epigraph{The underlying physical laws necessary for the mathematical
    theory of a large part of physics and the whole of chemistry are thus
    completely known, and the difficulty is only that the exact application of
    these laws leads to equations much too complicated to be soluble.}
    {--- P. A. M. Dirac}

    Having discussed the rather general formulation of quantum mechanics we now
    move to the more specialized field of many-body quantum mechanics.
    In this chapter we'll consider explicit wave functions and systems of more
    than a single particle.
    The results from the previous chapter are still applicable, but now we
    extend on the theory by introducing a more convenient formalism.

    \section{Summation convention}
        We will throughout this thesis use a summation convention that
        resembles the Einstein summation convention, but with slight
        variations.
        As we will be dealing with matrix elements with many indices and will
        perform quite a significant amount of contractions over these indices,
        we will refrain from writing the sums explicitly.
        The first difference from the Einstein summation convention is that our
        indices run over basis sets and not coordinates in a metric space.
        Furthermore, we will use different index sets for different sums, e.g.,
        some sums run over a shorter limit than others\footnote{%
            In particular, see the section on the Fermi vacuum.%
            % TODO: Add link to this section.
        }, or different basis sets are used\footnote{%
            For example, when we transform from one basis to another using the
            variational method.%
        }, etc.
        Whenever this is the case, we will inform the reader in advance.

        We will often diagonalize a matrix, and to avoid writing out the sums
        explicitly due to three indices being repeated we will introduce the
        ``rank 3 Kronecker-Delta'' defined by
        \begin{align}
            \delta^{i}_{jk} = \begin{cases}
                1 & i = j = k, \\
                0 & \text{else},
            \end{cases}
            \label{eq:rank-3-kd}
        \end{align}
        as this allows us to write a diagonal matrix $\vfg{A}$ with diagonal
        elements $a_i$ on index form, viz.
        \begin{align}
            A_{ij} = \delta^{n}_{ij} a_{n},
        \end{align}
        where we see that we have preserved the rank of the tensor $A_{ij}$ on
        both sides of the equality after we have performed the contraction along
        index $n$.
        % TODO: Discuss index placement
        The reason for using this index notation is two-fold. First, we remove
        the clutter of the summation signs, and second, the index notation
        resembles the implementation in Python as we use tensor contractions
        where the axes are specified.
        Thus, no explicit sums in the form of for-loops are done in the code.

    \section{Particle statistics}
        \label{sec:particle-statistics}
        The particles we concern ourselves with are \emph{identical}.
        This means that it is not possible to discern two particles of the
        same type from one another.
        This statement yields quite profound results in the sense that the
        ordering of the particles in a many-body wave function is in some sense
        arbitrary; the wave functions are the same up to a complex phase factor
        regardless of the ordering of the particles.
        As a consequence the probability density of our state must be
        permutation invariant since we are not able to distinguish between the
        ordering of identical particles.
        We define $\sigma \in S_{N}$ as a permutation of $N$ indices $\vf{x}
        = (x_1, \dots, x_N) \in X^{N}$ wherein $X^N$ is a coordinate space where
        both spin and position is incorporated.
        Furthermore, $S_{N}$ is the group of all permutations $\sigma$ where
        $S_{N}$ has $N!$ distinct permutations.
        We denote the permutation of the indices by
        \begin{align}
            \vf{x} = (x_1, \dots, x_N)
            \to \vf{x}_{\sigma} = (x_{\sigma(1)}, \dots, x_{\sigma(N)}).
            \label{eq:permutation-indices}
        \end{align}
        We can then formulate particle indistinguishability by
        \cite{leinaas1977, kvaal2017notes}
        \begin{align}
            \abs{
                \psi(\vf{x})
            }^2
            = \abs{
                \psi(\vf{x}_{\sigma})
            }^2.
            \label{eq:particle-indistinguishability}
        \end{align}
        This can be formulated as \cite{kvaal2017notes}
        \begin{align}
            \psi(\vf{x}) = \exp[i\alpha(\sigma)] \psi(\vf{x}_{\sigma}),
        \end{align}
        where $\alpha(\sigma) \in \mathbb{R}$ depends on $\sigma$.
        A transposition $\tau_{ij} \in S_{N}$ is a permutation exchanging a
        single pair $(i, j) \to (j, i)$ where $i \neq j$.
        We denote the transposition of two indices in a similar manner as in
        \autoref{eq:permutation-indices}, but where $\vf{x}_{ij}$ signifies that
        all indices in $\vf{x}$ are the same except for the pair $(i, j)$.
        We can construct any permutation $\sigma$ as a product of an even or an
        odd number of transpositions \cite{fraleigh2003first}
        \begin{align}
            \sigma = \prod_{k = 1}^{n} \tau_{i_k, j_k},
        \end{align}
        where $\abs{\sigma} \equiv n$ counts the number of transpositions and is
        always either even or odd.
        Stated differently, a permutation $\sigma$ created from a product of
        transpositions is not unique as the same permutation can be achieved
        from a different product of transpositions, however, all products are
        either even or odd.
        A permutation created from a even product of transpositions is said to
        have \emph{even parity} whereas a permutation created from an odd
        product of transpositions is said to have \emph{odd parity}.
        We define the \emph{exchange operator} $\hat{P}_{ij}$ as the operator
        that interchanges a pair of indices by
        \begin{align}
            \hat{P}_{ij}\psi(\vf{x})
            = \psi(\vf{x}_{ij}).
        \end{align}
        From this definition we can then see that
        \begin{align}
            \hat{P}^2_{ij}\psi(\vf{x})
            = \hat{P}_{ij}\psi(\vf{x}_{ij})
            = \psi(\vf{x}),
        \end{align}
        which means that the eigenvalues of $\hat{P}_{ij}$ is $p_{ij} = \pm
        1$, that is,
        \begin{align}
            \hat{P}_{ij}\psi(\vf{x})
            = \psi(\vf{x}_{ij})
            = p_{ij} \psi(\vf{x}).
        \end{align}
        As pointed out by \citeauthor{leinaas1977} in their seminal paper
        \citetitle{leinaas1977} \cite{leinaas1977}, this is only part of the
        truth as two-dimensional systems allow an infinite amount of
        eigenstates for the exchange operator.
        However, we will not concern ourselves with other eigenvalues for the
        exchange operator.
        % TODO: Verify that this is what dem bois did find out.
        Now, it is possible to write a transposition $\tau_{ij}$ as a product of
        three transpositions via an arbitrary index $k \neq i \neq j$.
        An illustration of this fact can be seen in
        \autoref{fig:transpositions}.
        As we can replace the action of a single exchange operator with three
        other exchange operators, we have that
        \begin{align}
            \hat{P}_{jk} \psi(\vf{x})
            &= \hat{P}_{ij} \hat{P}_{ik} \hat{P}_{ij} \psi(\vf{x})
            = p_{ij} p_{ik} p_{ij} \psi(\vf{x})
            = p_{ij}^2 p_{ik} \psi(\vf{x})
            = p_{ik} \psi(\vf{x})
             = p_{jk} \psi(\vf{x}),
        \end{align}
        which tells us that the eigenvalues of all the exchange operators are
        the same.
        Thus we have $p_{ij} = p_{jk} \equiv p = \pm 1$.
        A consequence of this is that the eigenvalue of an exchange operator is
        a charateristic of the wave function $\psi(\vf{x})$.
        Furthermore, by constructing a \emph{permutation operator}
        $\hat{P}_{\sigma}$ as a product of exchange operators, that is,
        \begin{align}
            \hat{P}_{\sigma}
            = \prod_{k = 1}^{n} \hat{P}_{i_k j_k},
        \end{align}
        we find that the eigenvalue of the permutation operator is
        \begin{align}
            \hat{P}_{\sigma}\psi(\vf{x})
            = p^{\abs{\sigma}}\psi(\vf{x}).
        \end{align}
        Now, depending on the wave function we can get two different situations.
        If $p = +1$, then we call $\psi(\vf{x})$ symmetric as $p^{\abs{\sigma}}
        = 1$ regardless of the parity of the permutation operator.
        A symmetric wave function describes a system of \emph{bosons}, e.g.,
        photons.
        On the other hand, if $p = -1$, then $\psi(\vf{x})$ is antisymmetric
        and
        \begin{align}
            p^{\abs{\sigma}} =
            \begin{cases}
                +1 & \text{even parity}, \\
                -1 & \text{odd parity}.
            \end{cases}
        \end{align}
        Particles described by an antisymmetric wave function are called
        \emph{fermions}, e.g., electrons.


        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{scope}
                    \draw (-4, 0) node[anchor=east]
                    {$\hat{P}_{13}\psi(x_i, x_j, x_k)$} -- (4, 0);
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=alice,
                        text=white
                    ]
                    (1) at (-3, 0) {$i$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerindigo,
                        text=white
                    ]
                    (2) at (0, 0) {$j$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerruby,
                        text=white
                    ]
                    (3) at (3, 0) {$k$};
                    \path[->, thick] (1) edge[bend right] node [left] {} (3);
                    \path[->, thick] (3) edge[bend right] node [left] {} (1);
                \end{scope}
                \begin{scope}[yshift=-2.5cm]
                    \draw (-4, 0) node[anchor=east]
                    {$\hat{P}_{12}\psi(x_k, x_j, x_i)$} -- (4, 0);
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerruby,
                        text=white
                    ]
                    (1) at (-3, 0) {$k$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerindigo,
                        text=white
                    ]
                    (2) at (0, 0) {$j$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=alice,
                        text=white
                    ]
                    (3) at (3, 0) {$i$};
                    \path[->, thick] (1) edge[bend right] node [left] {} (2);
                    \path[->, thick] (2) edge[bend right] node [left] {} (1);
                \end{scope}
                \begin{scope}[yshift=-5cm]
                    \draw (-4, 0) node[anchor=east]
                    {$\hat{P}_{13}\psi(x_j, x_k, x_i)$} -- (4, 0);
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerindigo,
                        text=white
                    ]
                    (1) at (-3, 0) {$j$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=darkerruby,
                        text=white
                    ]
                    (2) at (0, 0) {$k$};
                    \node[
                        draw,
                        circle,
                        black,
                        thick,
                        fill=alice,
                        text=white
                    ]
                    (3) at (3, 0) {$i$};
                    \path[->, thick] (1) edge[bend right] node [left] {} (3);
                    \path[->, thick] (3) edge[bend right] node [left] {} (1);
                \end{scope}
                \begin{scope}[yshift=-7.5cm]
                    \draw (-4, 0) node[anchor=east]
                    {$\psi(x_i, x_k, x_j)$} -- (4, 0);
                    \node[draw, circle, black, thick, fill=alice, text=white] at
                    (-3, 0) {$i$};
                    \node[draw, circle, black, thick, fill=darkerruby, text=white] at
                    (0, 0) {$k$};
                    \node[draw, circle, black, thick, fill=darkerindigo, text=white] at
                    (3, 0) {$j$};
                \end{scope}
            \end{tikzpicture}
            \caption{Here we illustrate how a single transposition
            $\tau_{jk}$ can be replaced by a product of three transpositions
            $\tau_{ij}\tau_{ik}\tau_{ij}$.
            In this figure the numbers represent a position inside the wave
            function arguments, that is, the exchange operators shuffle the
            ordering, and the labels $i$, $j$, and $k$ along with their colored
            spheres are there to distinguish the three coordinates from another.
            The arrows represent the action of the exchange operator from one
            line to the next (before the exchange has occured).
            Take care not to mistake the circles to mean particles, the
            particles are indistinguishable after all and such a labelling is
            not possible.}
            \label{fig:transpositions}
        \end{figure}

        \subsection{Pauli exclusion principle}
            An interesting result of the antisymmetric property of fermions is
            that we can never have a system containing two fermions \emph{in the
            same state}.
            We demonstrate this by considering an antisymmetric wave function
            $\psi(\vf{x})$ where $\vf{x} = (x_1, \dots, x_N) \in X^{N}$
            represents the coordinates of the $N$ particles in the system.
            We now have that the eigenvalue of $\hat{P}_{ij}$ on $\psi(\vf{x})$
            will be $p = -1$, that is,
            \begin{align}
                \hat{P}_{ij}\psi(\vf{x})
                = \psi(\vf{x}_{ij})
                = -\psi(\vf{x}),
            \end{align}
            where we interpret $\vf{x}_{ij}$ as the same collection of
            coordinates as $\vf{x}$ but with $x_i$ and $x_j$ interchanged.
            Now, if $x_i = x_j$ in $\vf{x}$ we have
            \begin{gather}
                \hat{P}_{ij}\psi(\vf{x})
                = \psi(\vf{x}_{ij})
                = \psi(\vf{x})
                = -\psi(\vf{x}),
            \end{gather}
            which means that $\psi(\vf{x}) = 0$ for the equation to be
            satisified.
            This observation is known as the \emph{Pauli exclusion
            principle}.
            It is not so much that fermions aren't \emph{allowed} to be in the
            same state, but a fact of life that such things do not exist as they
            would immediately annihilate one another.


    \section{Second quantization}
        So far, we have worked with quantum mechanics formulated in first
        quantization where observables are operators acting on states that are
        functions defined on some space.
        Moving to second quantization we will express wave functions as products
        of creation and annihilation operators acting on the vacuum state.
        These operators provide a way to express many-body wave
        functions\footnote{%
            Or more precisely, configurations of many-body wave functions.%
        } as a product of operators where each operator represents a particle
        state.\footnote{%
            It is not strictly a particle as we can not say that a particle is
            in this or that state, but it is a state which particles can occupy.
        }
        Depending on the algebra for the operators, we can look at antisymmetric
        fermions or symmetric bosons.
        Expressing the first quantized observables in the same creation and
        annihilation operators, we are able to unify much of quantum mechanics
        to a single set of elementary operators \cite{helgaker-molecular}.

        \subsection{Fock space}
            \label{subsec:fock-space}
            In second quantization, we express a general many-body wave function
            as a vector in the abstract linear vector space called \emph{Fock
            space}.

            \begin{definition}
                For a given single-particle Hilbert space $H$, we define Fock
                space as the direct sum of the tensor products of copies $H$,
                viz. \cite{fock-space}
                \begin{align}
                    F_{\nu}
                    = \bigoplus_{n = 0}^{\infty}
                    S_{\nu} H^{\otimes n}
                    = \mathbb{C}
                    \oplus H
                    \oplus \brak{
                        S_{\nu}
                        \para{
                            H \otimes H
                        }
                    }
                    \oplus \dots,
                \end{align}
                where $S_{\nu}$ is an operator which symmetrizes or
                antisymmetrizes the tensor product of Hilbert spaces depending
                on whether or not the system consists of bosons $\nu \equiv +$
                or fermions $\nu \equiv -$ respectively.
            \end{definition}

            We will be working with a finite basis set of $L$ orthonormal
            single-particle states, $\brac{\ket{p}}_{p = 1}^{L}$, which means
            that we truncate the infinite direct sum over the tensor products of
            $H$ constructing the truncated Fock space $F_{\nu}(L)$.
            A Fock state\footnote{%
                Also known as an occupation number vector
                \cite{helgaker-molecular}.
            } $\ket{\vfg{n}} \in F_{\nu}(L)$ is denoted
            \begin{align}
                \ket{\vfg{n}}
                &\equiv \ket{n_1, n_2, \dots, n_L},
            \end{align}
            where $n_i$ denotes how many of state $\ket{i}$ are contained in
            $\ket{\vfg{n}}$.\footnote{%
                This must not be confused with a \emph{product state} as
                $\ket{\vfg{n}}$ is either a symmetric ($\nu = +$) or an
                antisymmetric ($\nu = -$) state.%
            }
            We've defined the set $\vf{n}$ as the set containing all $n_i$.
            This formulation of the Fock states lets us incorporate the particle
            statistics depending on the system we are exploring by choosing the
            allowed values of $n_i$.
            \begin{align}
                n_i =
                \begin{cases}
                    0, 1 & \text{fermions} \iff \nu = -, \\
                    0, 1, 2, \dots & \text{bosons} \iff \nu = +,
                \end{cases}
            \end{align}
            where $n_i = 0$ means that the state is unoccupied and $n_i \geq 1$
            means that state $\ket{i}$ can be occupied by that amount of
            particles.
            We can decompose the truncated Fock space $F_{\nu}(L)$ into a direct
            sum of subspaces $F_{\nu}(L, N)$
            \begin{align}
                F_{\nu}(L)
                = \bigoplus_{N = 0}^{L}
                F_{\nu}(L, N),
            \end{align}
            where $F_{\nu}(L, N)$ is the Fock space with all Fock states
            $\ket{\vfg{n}}$ where $\abs{\vfg{n}} = N$, i.e., all states where
            all $N$ particles have been distributed among all $L$ basis states
            \cite{helgaker-molecular}.
            Due to the particles being indistinguishable we have
            \begin{gather}
                \dim[F_{+}(L, N)] = \binom{L + N}{N},
                \\
                \dim[F_{-}(L, N)] = \binom{L}{N},
            \end{gather}
            where the bosonic Fock states are in a much greater number as they
            are not subject to the Pauli exclusion principle.
            The inner product between two Fock states $\ket{\vfg{n}},
            \ket{\vfg{m}} \in F_{\nu}(L)$ is given by
            \begin{align}
                \braket{\vfg{n}}{\vfg{m}} = \prod_{i = 1}^{L} \delta_{pq}
                \equiv \delta_{\vfg{n}\vfg{m}}.
                \label{eq:inner-product-fock}
            \end{align}
            One of the convenient consequences of the Fock space formulation is
            that it opens up for a description of the inner product between two
            Fock states with an unequal amount of particles.\footnote{%
                The two Fock states must however be defined from the same basis
                set of $L$ basis functions.
            }
            From \autoref{eq:inner-product-fock} we can see that two Fock states
            with an unequal number of particles will yield a zero-overlap.
            Furthermore, we can construct the identity by
            \begin{align}
                \1 = \dyad{\vfg{n}}{\vfg{n}},
                \label{eq:fock-identity}
            \end{align}
            where we sum over over all $\ket{\vfg{n}} \in F_{\nu}(L)$.
            Of particular interest is the \emph{vacuum state} $\ket{\vac} \in
            F_{\nu}(L, 0)$ as the state with no particles.
            \begin{align}
                \ket{\vac} \equiv \ket{\vfg{0}}
                = \ket{0_1, 0_2, \dots, 0_L}.
            \end{align}
            From \autoref{eq:inner-product-fock} we have that the vacuum state
            is normalized to unity.

        \subsection{Creation and annihilation operators}
            We now introduce the \emph{creation} and \emph{annihilation}
            operators which act on Fock states by adding or removing single
            particle states.

            \begin{definition}
                \label{def:creation_1}
                A \emph{creation} operator $\acr{p}$ is an operator acting on
                Fock states in $F_{\nu}(L)$.
                It is a mapping $\acr{p}: F_{\nu}(L, N) \mapsto F_{\nu}(L, N +
                1)$.
                Its action on a Fock state $\ket{\vfg{n}} \in F_{\nu}(L, N)$ is
                defined as
                \begin{align}
                    \acr{p}\ket{\vfg{n}}
                    = (\Gamma_{\nu})^{\vfg{n}}_{p}
                    \sqrt{n_p + 1}
                    \ket{n_1, \dots, n_p + 1, \dots, n_L}
                    = (\Gamma_{\nu})^{\vfg{n}}_{p}
                    \sqrt{n_p + 1}
                    \ket{\vfg{n}'},
                    \label{eq:general_creation}
                \end{align}
                where $(\Gamma_{\nu})^{\vfg{n}}_{p}$ is a phase factor which
                depends on the particle type $\nu$.
                \begin{gather}
                    (\Gamma_{+})^{\vfg{n}}_{p} = 1, \\
                    (\Gamma_{-})^{\vfg{n}}_{p}
                    = \prod_{q = 1}^{p - 1} (-1)^{n_q}.
                    \label{eq:phase-fermion}
                \end{gather}
                We will denote fermionic creation operators by $\ccr{p}$ and the
                corresponding bosonic creation operators by $\bcr{p}$.
            \end{definition}
            The phase factor is again a way of incorporating the particle
            statistics of the system we are exploring.
            A bosonic wave function is symmetric with respect to its particles
            and its phase is therefore constant regardless of the ordering of the
            creation of its particle states.
            For a fermionic wave function, the interchange of two particles will
            incur a sign change as discussed in
            \autoref{sec:particle-statistics}.
            The fact that the ordering of the indices in a fermionic Fock state
            will depend on the overall sign of the state can lead to ambiguity.
            We therefore introduce \emph{canonical ordering} with respect to the
            particle indices,
            \begin{align}
                \ket{\vfg{n}}
                \equiv \brak{
                    \prod_{p = 1}^{L}
                    \para{\ccr{p}}^{n_p}
                }\ket{\vac}
                = \para{\ccr{1}}^{n_1}\dots\para{\ccr{L}}^{n_L}\ket{\vac},
                \label{eq:canonical-fock-state}
            \end{align}
            that is, we order the single-particle states in an increasing order.
            Recalling the Pauli exclusion principle that $n_p \in \brac{0, 1}$
            for a fermionic wave function, we have that
            \begin{align}
                \ccr{p}\ccr{p} = 0,
            \end{align}
            and the normalization factor $\sqrt{n_p + 1}$ will always be $1$ as
            long as the state is not annihilated by inserting an already
            existing state.
            From the phase in \autoref{def:creation_1} we have the commutation
            relation
            \begin{gather}
                \com{\bcr{p}}{\bcr{q}} = \bcr{p}\bcr{q} - \bcr{q}\bcr{p} = 0,
            \end{gather}
            for the bosonic system as the ordering of the creation of particle
            states in a bosonic wave function is arbitrary.
            Fermionic creation operators satisfy the anticommutation relation
            \begin{gather}
                \acom{\ccr{p}}{\ccr{q}} = \ccr{p}\ccr{q} + \ccr{q}\ccr{p} = 0,
            \end{gather}
            as $p > q$ or $q > p$ and the phase factor will give a sign change
            by inserting one before the other thus yielding the same state with
            an opposite sign.

            We define the \emph{annihilation operator} as the adjoint of the
            creation operator.
            The action can be inferred by utilizing the spectral decomposition
            of the identity in \autoref{eq:fock-identity}.
            \begin{align}
                \aan{p}\ket{\vfg{n}}
                = \ket{\vfg{m}}\mel{\vfg{m}}{\aan{p}}{\vfg{n}}
                =
                \ket{\vfg{m}}
                \para{
                    \mel{\vfg{n}}{\acr{p}}{\vfg{m}}
                }^{*}
                = \para{\Gamma_{\nu}}^{\vfg{m}}_{p}
                \delta_{\vfg{n}\vfg{m}'}
                \sqrt{m_p + 1}
                \ket{\vfg{m}},
            \end{align}
            where
            \begin{align}
                \acr{p}\ket{\vfg{m}}
                = \para{\Gamma_{\nu}}^{\vfg{m}}_{p}
                \sqrt{m_p + 1}
                \ket{\vfg{m}'}.
            \end{align}
            In order for the overlap between $\ket{\vfg{n}}$ and
            $\acr{p}\ket{\vfg{m}}$ to be non-zero we have to have $\abs{\vfg{n}
            - \vfg{m}} = 1$, that is, the two states $\ket{\vfg{n}}$ and
            $\ket{\vfg{m}}$ can only differ by a single state.
            Furthermore, as we are acting on $\ket{\vfg{m}}$ with $\acr{p}$ we
            have that $n_p = m_p + 1$, i.e., $\ket{\vfg{n}}$ has one more
            particle state $\ket{p}$ than $\ket{\vfg{m}}$.
            As all other states in $\ket{\vfg{n}}$ and $\ket{\vfg{m}}$ are the
            same, we have that $(\Gamma_{\nu})^{\vfg{m}}_{p} =
            (\Gamma_{\nu})^{\vfg{n}}_{p}$
            and $\sqrt{n_p} = \sqrt{m_p + 1}$.
            This means that
            \begin{align}
                (\Gamma_{\nu})^{\vfg{m}}_{p}
                \delta_{\vfg{n}\vfg{m}'}
                \sqrt{m_p + 1}
                =
                \para{\mel{\vfg{n}}{\acr{p}}{\vfg{m}}}^{*}
                =
                \mel{\vfg{m}}{\aan{p}}{\vfg{n}}
                =
                (\Gamma_{\nu})^{\vfg{n}}_{p}
                \sqrt{n_p}
                \delta_{\vfg{n}'\vfg{m}},
            \end{align}
            where $\ket{\vfg{n}'}$ is the state $\ket{\vfg{n}}$ with state
            $\ket{p}$ removed.
            We are thus left with our annihilation operator.
            \begin{definition}
                \label{def:annihilation_1}
                An \emph{annihilation} operator $\aan{p}$ is an operator acting
                on Fock states in $F_{\nu}(L)$.
                It is a mapping $\aan{p}: F_{\nu}(L, N) \mapsto F_{\nu}(L, N -
                1)$.
                Its action on a Fock state $\ket{\vfg{n}} \in F_{\nu}(L, N)$ is
                defined as
                \begin{align}
                    \aan{p}\ket{\vfg{n}}
                    = (\Gamma_{\nu})^{\vfg{n}}_{p}
                    \sqrt{n_p}
                    \ket{n_1, \dots, n_p - 1, \dots, n_L}
                    = (\Gamma_{\nu})^{\vfg{n}}_{p}
                    \sqrt{n_p}
                    \ket{\vfg{n}'},
                \end{align}
                where $(\Gamma_{\nu})^{\vfg{n}}_{p}$ is the same phase factor as
                in \autoref{def:creation_1}.
                We will denote fermionic annihilation operators by $\can{p}$ and
                the corresponding bosonic annihilation operators by $\ban{p}$.
            \end{definition}
            From the definition of the annihilation operator we have that
            \begin{align}
                \can{p}\can{p} = 0,
            \end{align}
            as there can only be one particle state of type $p$ in a given
            fermionic state.
            Furthermore, we have the commutation relation
            \begin{align}
                \com{\ban{p}}{\ban{q}} = \ban{p}\ban{q} - \ban{q}\ban{p} = 0,
            \end{align}
            for the bosonic states and the anticommutation relation
            \begin{align}
                \acom{\can{p}}{\can{q}} = \can{p}\can{q} + \can{q}\can{p} = 0,
            \end{align}
            for the fermionic system.
            These relations can be seen by taking the Hermitian conjugate of the
            commutation and anitcommutation relation for the creation operators.
            If the annihilation operator $\aan{p}$ acts on a Fock state
            $\ket{\vfg{n}}$ which does not contain the state $\ket{p}$, then
            \begin{align}
                \aan{p}\ket{\vfg{n}}
                = \aan{p}\ket{n_1, \dots, 0_p, \dots, n_L}
                = 0.
            \end{align}
            As a consequence, any annihilation operator will annihilate the
            vacuum.

            Now, in order to derive the fundamental properties of the second
            quantized operators we look at the combined action of a creation and
            an annihilation operator acting on a state in combination.
            For the bosonic operators we have
            \begin{align}
                \begin{drcases}
                    \ban{p}\bcr{p}\ket{\vfg{n}}
                    &= (n_p + 1)\ket{\vfg{n}}
                    \\
                    \bcr{p}\ban{p}\ket{\vfg{n}}
                    &= n_p \ket{\vfg{n}}
                \end{drcases}
                \implies
                \com{\ban{p}}{\bcr{p}}
                = (n_p + 1) - n_p = 1,
            \end{align}
            when we create and remove the same particle state $\ket{p}$.
            When $p \neq q$ we have
            \begin{align}
                \begin{drcases}
                    \ban{p}\bcr{q}\ket{\vfg{n}}
                    &= \sqrt{n_p}\sqrt{n_q + 1}\ket{\vfg{n}'}
                    \\
                    \bcr{q}\ban{p}\ket{\vfg{n}}
                    &= \sqrt{n_p}\sqrt{n_q + 1}\ket{\vfg{n}'}
                \end{drcases}
                \implies
                \com{\ban{p}}{\bcr{q}}
                = 0.
            \end{align}
            Collecting all three commutation relations for the bosonic states we
            find
            \begin{align}
                \com{\ban{p}}{\ban{q}} &= 0, \\
                \com{\bcr{p}}{\bcr{q}} &= 0, \\
                \com{\ban{p}}{\bcr{q}} &= \delta_{pq}.
            \end{align}
            Repeating this exercise for the fermionic states we start by noting
            that the fermionic phase factor squared is $1$.
            \begin{align}
                \begin{drcases}
                    \can{p}\ccr{p}\ket{\vfg{n}}
                    &= \delta_{n_p0}\ket{\vfg{n}}
                    \\
                    \ccr{p}\can{p}\ket{\vfg{n}}
                    &= \delta_{n_p1}\ket{\vfg{n}}
                \end{drcases}
                \implies
                \acom{\can{p}}{\ccr{p}}
                = \delta_{n_p 0} + \delta_{n_p 1}
                = 1,
            \end{align}
            where $n_p$ in the Kronecker-Deltas following the anticommutator
            expression are dummy indices.
            When $p \neq q$ we have
            \begin{align}
                \can{p}\ccr{q}\ket{\vfg{n}}
                &=
                (\Gamma_{+})^{\vfg{n}^{(1)}}_{p}
                (\Gamma_{+})^{\vfg{n}}_{q}
                \delta_{n_p 1} \delta_{n_q 0}
                \ket{\vfg{n}^{(3)}}
                \\
                \ccr{q}\can{p}\ket{\vfg{n}}
                &=
                (\Gamma_{+})^{\vfg{n}^{(2)}}_{q}
                (\Gamma_{+})^{\vfg{n}}_{p}
                \delta_{n_q 0} \delta_{n_p 1}
                \ket{\vfg{n}^{(3)}}
            \end{align}
            where we've defined the state $\ket{\vfg{n}^{(3)}}$ as state
            $\ket{\vfg{n}}$ with the single-particle states $\ket{q}$ added and
            $\ket{p}$ removed.
            Collecting the creation and annihilation pair into an anticommutator
            relation we have
            \begin{align}
                \acom{\can{p}}{\ccr{q}}
                =
                \delta_{n_q 0} \delta_{n_p 1}
                \brak{
                    (\Gamma_{+})^{\vfg{n}^{(1)}}_{p}
                    (\Gamma_{+})^{\vfg{n}}_{q}
                    +
                    (\Gamma_{+})^{\vfg{n}^{(2)}}_{q}
                    (\Gamma_{+})^{\vfg{n}}_{p}
                }.
            \end{align}
            In order to get a final expression for this anticommutator we need
            to find expressions for the phases
            $(\Gamma_{+})^{\vfg{n}^{(1)}}_{p}$ and
            $(\Gamma_{+})^{\vfg{n}^{(2)}}_{q}$ relative to the original state
            $\ket{\vfg{n}}$.
            We have two situations that needs to be explored, namely when $p >
            q$ and the opposite situation when $p < q$.
            Now, when $p > q$ we have
            \begin{align}
                (\Gamma_{+})^{\vfg{n}^{(1)}}_{p}
                (\Gamma_{+})^{\vfg{n}}_{q}
                =
                -
                (\Gamma_{+})^{\vfg{n}}_{p}
                (\Gamma_{+})^{\vfg{n}}_{q},
            \end{align}
            as $\ccr{q}$ inserts an extra state $\ket{q}$ between $n_1$ and
            $n_p$.
            Conversely, this sign change does not occur for the reverse
            situation when $\ccr{q}\can{p}$ acts on $\ket{\vfg{n}}$ and we get
            $(\Gamma_{+})^{\vfg{n}^{(2)}}_{p} = (\Gamma_{+})^{\vfg{n}}_{p}$.
            Thus, in total we have
            \begin{align}
                \acom{\can{p}}{\ccr{q}} = 0,
            \end{align}
            for $p > q$.
            When $p < q$ we get the same result as can be seen by taking the
            Hermitian conjugate of the anticommutator and reversing the dummy
            indices $p$ and $q$.
            In total we have the fundamental anticommutation relations
            \begin{align}
                \acom{\can{p}}{\can{q}} &= 0,
                \label{eq:anticom-cancan}
                \\
                \acom{\ccr{p}}{\ccr{q}} &= 0,
                \label{eq:anticom-ccrccr}
                \\
                \acom{\can{p}}{\ccr{q}} &= \delta_{pq}.
                \label{eq:anticom-canccr}
            \end{align}

            As stated at the start of this section on second quantization, the
            fundamental commutation relations for bosons and the fundamental
            anticommutation relations for fermions completely specifies the
            system we are exploring.
            In the rest of this thesis we will only look at fermions as we will
            be exploring electrons and electronic particles, but we wanted to
            include the discussion of both sets of creation and annihilation
            operators as it provides insight on how one would go about
            formulating the many-body methods we will explore for bosons as
            well.
            By replacing the fundamental anticommutation relations with the
            symmetric fundamental commutation relations\footnote{%
                And performing a substantial amount of algebra.%
            } one can look at bosonic systems.



    \section{Wick's theorem}
        We will discover that the evaluation of products of many-body operators
        quickly will yield large products of second quantized operators which
        will have to be evaluated using the anticommutation relations from
        \autoref{eq:anticom-cancan} to \autoref{eq:anticom-canccr}.
        To alleviate this process we introduce \emph{Wick's theorem}, first
        introduced by \citeauthor{wick} \cite{wick}.
        \begin{definition}
            \label{def:normal-ordered-form}
            The \emph{normal-ordered form} of a string of second quantized
            operators is defined as a form where all the annihilation operators
            are placed to the right of all the creation operators.
            For an operator $\hat{A}$ containing a string of creation and
            annihilation operators, we denote the normal-ordered form by
            $\normalord{\hat{A}}$.
        \end{definition}

        To see the usefulness of \autoref{def:normal-ordered-form}, consider an
        operator $\hat{A}$ containing a string of creation and annihilation
        operators on normal-ordered form, that is, $\hat{A} = \normalord{\hat{A}}$,
        we will then have
        \begin{align}
            \normalord{\hat{A}}\ket{\vac} = 0,
        \end{align}
        as all the annihilation operators will annihilate the vacuum.
        Note that the normal-ordered form is not unique.
        However, whilst in the normal-ordered form, a permutation of the
        operators will at most yield a sign change and thus no consideration of
        the Kronecker-Delta in \autoref{eq:anticom-canccr} needs to be taken.

        \begin{definition}
            \label{def:contraction}
            We define a \emph{contraction} between two arbitrary second
            quantized operators $\hat{A}$ and $\hat{B}$ to be
            \begin{align}
                \wick{
                    \c {\hat{A}}
                    \c {\hat{B}}
                }
                = \hat{A}\hat{B}
                - \normalord{\hat{A}\hat{B}},
            \end{align}
            where $\normalord{\hat{A}\hat{B}}$ is the normal-ordered form of the
            operator pair $\hat{A}\hat{B}$ relative to the vacuum state
            $\ket{\vac}$.
        \end{definition}
        Similarly to the anticommutation relations, we can find contraction
        relations for the second quantized operators.
        \begin{gather}
            \wick{
                \c {\can{p}}
                \c {\can{q}}
            }
            = \can{p}\can{q}
            - \normalord{\can{p}\can{q}}
            = \can{p}\can{q}
            - \can{p}\can{q}
            = 0,
            \\
            \wick{
                \c {\ccr{p}}
                \c {\ccr{q}}
            }
            = \ccr{p}\ccr{q}
            - \normalord{\ccr{p}\ccr{q}}
            = \ccr{p}\ccr{q}
            - \ccr{p}\ccr{q}
            = 0,
            \\
            \wick{
                \c {\ccr{p}}
                \c {\can{q}}
            }
            = \ccr{p}\can{q}
            - \normalord{\ccr{p}\can{q}}
            = \ccr{p}\can{q}
            - \ccr{p}\can{q}
            = 0,
        \end{gather}
        where these three contractions all yield zero because they are already
        on normal-ordered form.
        The only-nonzero contraction is
        \begin{align}
            \wick{
                \c {\can{p}}
                \c {\ccr{q}}
            }
            = \can{p}\ccr{q}
            - \normalord{\can{p}\ccr{q}}
            = \can{p}\ccr{q}
            + \ccr{q}\can{p}
            = \acom{\can{p}}{\ccr{q}}
            = \delta_{pq},
            \label{eq:vac-canccr-contraction}
        \end{align}
        where the sign-change comes from re-ordering of the operators to
        normal-ordered form.
        Wick's theorem provides a method of re-writing a string of creation and
        annihilation operators as a sum of normal-ordered strings.
        \begin{theorem}
            \label{theorem:wick}
            Let $\hat{A}\hat{B}\dots\hat{Z}$ be a string of second quantized
            operators, then
            \begin{align}
                \hat{A}\hat{B}\dots\hat{Z}
                = \normalord{\hat{A}\hat{B}\dots\hat{Z}}
                + \sum_{\text{singles}} \normalord{
                    \wick{
                        \c {\hat{A}}
                        \c {\hat{B}}
                    }
                    \dots
                    \hat{Z}
                }
                + \sum_{\text{doubles}} \normalord{
                    \wick{
                        \c {\hat{A}}
                        \c {\hat{B}}
                    }
                    \dots
                    \wick{
                        \c {\hat{Y}}
                        \c {\hat{Z}}
                    }
                }
                + \dots,
            \end{align}
            where the sums run over all singly, doubly, and higher, contracted
            normal-ordered strings.
        \end{theorem}
        Contractions inside normal-ordered braces are performed by permuting
        the two operators together where each permutation between operators
        introduce a sign-change.
        Once the pair has been collected, the contraction can be evaluated.
        We see that only \autoref{eq:vac-canccr-contraction} will provide a
        non-zero contraction.

        \subsection{Generalized Wick's theorem}
            An extension to Wick's theorem is the product of several
            normal-oredered operator strings.
            \begin{theorem}
                \label{theorem:wick-general}
                Let $\normalord{\hat{A}\hat{B}\dots}$ and
                $\normalord{\hat{X}\hat{Y}\dots}$ be two normal-ordered strings of
                second quantized operators, then
                \begin{align}
                    \normalord{\hat{A}\hat{B}\dots}
                    \normalord{\hat{X}\hat{Y}\dots}
                    &= \normalord{\hat{A}\hat{B}\dots\hat{X}\hat{Y}\dots}
                    + \sum_{\text{singles}}
                    \normalord{
                        \wick{
                            \c {\hat{A}}
                            {\hat{B}}
                            {\dots}
                            \c {\hat{X}}
                            {\hat{Y}}
                            {\dots}
                        }
                    }
                    \nonumber \\
                    &\qquad
                    + \sum_{\text{doubles}}
                    \normalord{
                        \wick{
                            \c1 {\hat{A}}
                            \c2 {\hat{B}}
                            {\dots}
                            \c1 {\hat{X}}
                            \c2 {\hat{Y}}
                            {\dots}
                        }
                    }
                    + \dots,
                \end{align}
                where the contractions are only done between the two
                normal-ordered strings.
            \end{theorem}
            To see the usefulness of Wick's theorem, we consider the evaluation
            of a matrix element between two Fock states $\ket{\vfg{k}},
            \ket{\vfg{n}} \in F_{-}(L, N)$ on the operator $\hat{A}$ consisting
            of a string of creation and annihilation operators.
            We have that
            \begin{align}
                \ket{\vfg{n}}
                = \brak{
                    \prod_{p = 1}^{L}\para{
                        \ccr{p}
                    }^{n_p}
                }\ket{\vac},
            \end{align}
            which is already on normal-ordered form.
            The Hermitian conjugate of this state is also on normal-ordered
            form.
            Now, the matrix element of $\hat{A}$ is given by
            \begin{align}
                \mel{\vfg{k}}{\hat{A}}{\vfg{n}}
                = \mel{\vac}{
                    \brak{
                        \prod_{p = 1}^{L}
                        \para{\can{p}}^{k_p}
                    }
                    \hat{A}
                    \brak{
                        \prod_{p = 1}^{L}\para{
                            \ccr{p}
                        }^{n_p}
                    }
                }{\vac}.
            \end{align}
            Using Wick's generalized theorem on the operator $\hat{A}$ we see
            that only the \emph{fully contracted} terms will survive, as any
            ``left-over'' normal-ordered strings will annihilate the vacuum
            state.


    \section{Spin-orbitals}
        As discussed in the previous section on Fock space, we build our
        many-body wave function by combining single-particle states from an
        underlying basis.
        Since we're exploring systems of fermions, we'll limit our attention to
        particles with spin-$1/2$ and our single-particle states must
        incorporate the spin.
        It is often more convenient to express the single-particle states as
        functions defined on position or momentum space and in a spin-basis.
        We call the spatial representation of the single-particle functions an
        \emph{orbital} and combined with spin, we have the \emph{spin-orbital},
        \begin{align}
            \braket{x}{\psi} = \psi(x)
            \equiv \psi(\vf{r}, m_s)
            = \braket{\vf{r}, m_s}{\psi},
        \end{align}
        where $x = (\vf{r}, m_s)$ is a generalized coordinate of both
        position, $\vf{r}$, and spin quantum number, $m_s$.
        For fermions we have only two allowed spin states
        \begin{align}
            s_z = \pm \half\hslash,
        \end{align}
        where $s_z$ is the spin along the $z$-direction.
        As there are only two allowed states we have that $m_s \in
        \brac{\upspin, \downspin}$, where a positive value for $s_z$ corresponds
        to $m_s = \upspin$, i.e., spin up, and a negative value for $s_z$ to
        $m_s = \downspin$, i.e., spin down.
        We denote
        \begin{align}
            \psi_1(\vf{r}) \equiv \psi\para{\vf{r}, \upspin},
            \qquad
            \psi_2(\vf{r}) \equiv \psi\para{\vf{r}, \downspin},
        \end{align}
        for the two different spin-directions.
        We can thus represent the generalized spin-orbital $\psi(x)$ as a
        two-dimensional vector
        \begin{align}
            \psi(x) = \begin{pmatrix}
                c_1\psi_1(\vf{r}) \\
                c_2\psi_2(\vf{r})
            \end{pmatrix},
        \end{align}
        where $c_i \in \mathbb{C}$ are coefficients satisfying $\abs{c_1}^2 +
        \abs{c_2}^2 = 1$.
        We separate the spin dependence from the spatial part of the
        spin-orbitals by introducing separate spin functions for spin-up and
        spin-down.
        For example, choosing the spin-basis
        \begin{align}
            \alpha \equiv \alpha(m_s) = \begin{pmatrix}
                1 \\
                0
            \end{pmatrix},
            \qquad
            \beta \equiv \beta(m_s) = \begin{pmatrix}
                0 \\
                1
            \end{pmatrix},
            \label{eq:spin-basis}
        \end{align}
        we use the same convention as in much of the many-body quantum mechanics
        literature in labelling $\alpha$ as spin up and $\beta$ as spin down in
        the $z$-direction.
        Evaluating the spin functions thus yields
        \begin{gather}
            \alpha\para{\upspin} = 1, \qquad \alpha\para{\downspin} = 0, \\
            \beta\para{\upspin} = 0, \qquad \beta\para{\downspin} = 1.
        \end{gather}
        Using \autoref{eq:spin-basis} we see that we can write the
        generalized spin-orbital as a linear combination of the spin basis
        functions by
        \begin{align}
            \psi(x)
            = c_1\psi_1(\vf{r})\alpha(m_s)
            + c_2\psi_2(\vf{r})\beta(m_s).
            \label{eq:general-spin-orbital-1}
        \end{align}
        % TODO: Consider adding theory on spin as in Mayer.
        We will for the most part work with spin-orbitals in a definite
        spin-direction, viz.
        \begin{align}
            \psi(x) = \phi(\vf{r})\sigma(m_s),
            \label{eq:spin-orbital}
        \end{align}
        where $\sigma(m_s)$ is either spin up $\alpha(m_s)$ or spin down
        $\beta(m_s)$ and we've denoted the spatial orbital by $\phi(\vf{r})$.
        The reason we avoid using a general spin-orbital as in
        \autoref{eq:general-spin-orbital-1} is reduction of computational
        complexity.
        It is more convenient to generate a basis of spin-orbitals where we use
        a definite basis of analytical orbitals, e.g., harmonic oscillator basis
        functions, Gauss functions, etc, before tacking on the spin direction of
        each orbital.
        When labelling the different spin-orbitals from
        \autoref{eq:spin-orbital} we use the notation
        \begin{align}
            \psi_P(x) = \phi_p(\vf{r})\sigma(m_s),
        \end{align}
        where $P = (p, \sigma)$ is a composite index with $p$ labelling a
        specific orbital and $\sigma$ a specific spin-function.
        In the spin basis shown in \autoref{eq:spin-basis} we have that the
        inner product of two spin functions is given by
        \begin{align}
            \braket{\sigma}{\tau}
            &=
            \sigma(\upspin)\tau(\upspin)
            + \sigma(\downspin)\tau(\downspin)
            = \delta_{\sigma\tau},
        \end{align}
        that is, they are orthonormal.
        The inner product of two spin-orbitals from \autoref{eq:spin-orbital} is
        then separated into an orbital and a spin inner product,
        \begin{align}
            \braket{\psi_P}{\psi_Q}
            &= \braket{\phi_p}{\phi_q}\braket{\sigma}{\tau}
            = \delta_{\sigma\tau}
            \int\dd\vf{r}\phi^{*}_{p}(\vf{r})\phi_{q}(\vf{r}).
            \label{eq:inner-spin-orbital}
        \end{align}
        This equation is quite suggestive in the sense that we can see that the
        spin decouples from the spatial part of the wave function.
        Spin-$1/2$ is a two-level system that can be represented as a vector
        in a two-dimensional Hilbert space.
        Unless an operator contains a spin-coupling, the two spin-directions are
        completely independent of one another.
        For example, given a spin-independent operator, $\hat{O}$, the
        matrix element between two spin-orbitals become
        \begin{align}
            \mel{\psi_P}{\hat{O}}{\psi_Q}
            &= \mel{\phi_p}{\hat{O}}{\phi_q}\braket{\sigma}{\tau}
            = \delta_{\sigma\tau}
            \int\dd\vf{r}\phi^{*}_{p}(\vf{r})O(\vf{r})\phi_q(\vf{r}).
            \label{eq:example-spin-decoupling}
        \end{align}
        This motivates the coordinate independent notation
        \begin{align}
            \ket{\psi_P}
            &= \ket{\phi_p}\otimes\ket{\sigma},
        \end{align}
        where the tensor product combines the two-dimensional Hilbert space from
        the spin $\ket{\sigma}$ and the one-dimensional Hilbert space containing
        the orbital basis function.
        % TODO: Are these Hilbert spaces?
        % Aren't spin defined in R^2?
        % And the functions are in C^{d}, where d is the number dimensions?
        A general operator on the combined Hilbert space can thus be represented
        by
        \begin{align}
            \hat{O}
            &= \hat{R}_i \otimes \hat{S}_j,
        \end{align}
        where $\hat{R}_i$ is an operator on the one-dimensional Hilbert space
        containing the orbitals and $\hat{S}_j$ an operator on the
        two-dimensional Hilbert space containing the spin functions.
        % TODO: Verify that this is Hilbert space.
        The matrix elements of this operator can be computed by
        \begin{align}
            \mel{\psi_{P}}{\hat{O}}{\psi_{Q}}
            &=
            \mel{\phi_p}{\hat{R}_i}{\phi_q}
            \mel{\sigma}{\hat{S}_j}{\tau}.
        \end{align}
        Looking back at \autoref{eq:example-spin-decoupling} we see that a
        spin-independent operator $\hat{O}$ corresponds to $\hat{S}_j = \1$.
        % TODO: Consider skipping this step with the "general operator".

        \subsection{Restrictions on the choice of spin-orbitals}
            \label{subsec:restrictions-on-spin-orbitals}
            Many-body methods are often defined by restrictions on the
            spin-orbitals.
            Below we list some of the more common restrictions.
            \begin{enumerate}
                \item The general spin-orbital is on the form
                    \begin{align}
                        \psi(x, t)
                        = c_1\psi_1(\vf{r}, t) \alpha(m_s)
                        + c_2\psi_2(\vf{r}, t) \beta(m_s).
                        \label{eq:general-spin-orbital}
                    \end{align}
                    These spin-orbitals can lead to mixing between both
                    spin-directions, known as spin-contamination, that is, the
                    spin-orbitals are no longer eigenstates of the
                    spin-projection operator $\spinproj$.
                    % TODO: Is this correct?
                    This is often an unwanted effect as this greatly limits some
                    of the optimizations that can be employed on some of the
                    computational methods.
                \item The spin-unrestricted spin-orbital is on the form
                    \begin{align}
                        \psi(x, t)
                        = \psi_{\sigma}(\vf{r}, t) \sigma(m_s),
                        \label{eq:unrestricted-spin-orbital}
                    \end{align}
                    where the orbital $\psi_{\sigma}$ depends on the
                    spin-direction $\sigma$.
                    Often this type of spin-orbitals are dubbed unrestricted
                    spin-orbitals, which is somewhat of a misnomer as the
                    spin-orbitals are restricted in the choice of spin-direction
                    as opposed to the (truly) unrestricted generalized
                    spin-orbitals shown in \autoref{eq:general-spin-orbital}.
                \item The spin-restricted spin-orbital is given by
                    \begin{align}
                        \psi(x, t)
                        = \psi(\vf{r}, t) \sigma(m_s),
                        \label{eq:restricted-spin-orbital}
                    \end{align}
                    where each orbital is doubly occupied.
                    If the system we are exploring exhibits no spin-effects,
                    then choosing restricted spin-orbitals can often reduce the
                    complexity of the problem.
                    Furthermore, the system remains eigenstates of the
                    spin-projection operator.
            \end{enumerate}

        \subsection{Basis transformations}
            \label{subsec:basis-transformation}
            Much of what will be done in this thesis boils down to basis
            transformations of spin-orbitals.
            For a given basis of spin-orbitals
            $\brac{\chi_{\alpha}}_{\alpha = 1}^{L}$, a basis
            transformation to a new basis $\brac{\phi_{i}}_{i = 1}^{K}$ is
            done by
            \begin{align}
                \ket{\phi_{i}}
                = C_{\alpha i}\ket{\chi_{\alpha}},
            \end{align}
            where we for the sake of generality allow the two basis sets to be
            of differing sizes.
            The coefficient matrix $\vfg{C} \in \mathbb{C}^{L \times K}$,
            defines the transformation.
            We will often denote the known set of spin-orbitals as \emph{atomic
            orbitals} as done in the field of quantum chemistry.

            %If the basis of atomic orbitals is non-orthogonal, that is,
            %\begin{align}
            %    \braket{\chi_{\alpha}}{\chi_{\beta}}
            %    = \overlapten_{\alpha\beta}
            %    \neq \delta_{\alpha\beta},
            %\end{align}
            %where $\overlapten_{\alpha\beta}$ is an element in the overlap
            %matrix $\overlapmat \in \mathbb{C}^{L \times L}$, we can transform
            %to a new basis of orthonormal basis states $\brac{\xi_{\mu}}_{\mu =
            %1}^{L}$ \cite{szabo1996modern, mayer2002lowdin}.
            %The transformation from the atomic orbitals to the orthonormal basis
            %states is given by
            %\begin{align}
            %    \ket{\chi_{\mu}}
            %    = X_{\alpha\mu}\ket{\chi_{\alpha}},
            %\end{align}
            %where $\vfg{X} \in \mathbb{C}^{L \times L}$ is the coefficient
            %matrix.
            %In order for the new basis set to be othonormal, we require
            %\begin{align}
            %    \braket{\xi_{\mu}}{\xi_{\nu}}
            %    = X^{*}_{\alpha\mu}\overlapten_{\alpha\beta} X_{\beta\nu}
            %    = \delta_{\mu\nu}
            %    \implies
            %    \vfg{X}^{\dagger}\overlapmat\vfg{X}
            %    = \1.
            %\end{align}
            %Furthermore, we have that $\vfg{X}$ must be non-singular as we need
            %to compute the inverse $\vfg{X}^{-1}$ which we'll see shortly.
            %The overlap matrix $\overlapmat$ is Hermitian by construction, and
            %we can therefore diagonalize $\overlapmat$ by a unitary matrix
            %$\vfg{U}$, viz.
            %\begin{align}
            %    \vfg{U}^{\dagger}\overlapmat\vfg{U} = \vfg{s},
            %\end{align}
            %where $\vfg{s} = \diag(\lambda_1, \dots, \lambda_L)$ is a diagonal
            %matrix with the eigenvalues $\lambda_i$ of $\overlapmat$.
            %We know that the eigenvalues $\lambda_i > 0$ as the overlap matrix
            %is positive definite.
            %For a proof of the overlap matrix being positive definite see
            %\autoref{app:positive-definite-overlap}.

            %To find an equation for $\vfg{X}$ we wil use a procedure known as
            %\emph{symmetric orthogonalization} \cite{szabo1996modern,
            %mayer2002lowdin}.
            %We define
            %\begin{align}
            %    \vfg{X} \equiv \overlapmat^{-1/2}
            %    = \vfg{U}\vfg{s}^{-1/2}\vfg{U}^{\dagger},
            %\end{align}
            %where the square root is defined as the square root of the
            %eigenvalues of $\overlapmat$ as seen in the last equality.
            %Now, since $\overlapmat$ is positive definite, the square root and
            %inverse of $\overlapmat$ will always be defined.

            %We are now in a position to return to the original basis
            %transformation by
            %\begin{align}
            %    \ket{\phi_i}
            %    = C_{\alpha i}\ket{\chi_{\alpha}}
            %    = C_{\alpha i}\para{X^{-1}}_{\mu \alpha}
            %    \ket{\xi_{\mu}}
            %    = C_{\mu i}' \ket{\xi_{\mu}},
            %\end{align}
            %where we've defined the transformed coefficient matrix
            %\begin{align}
            %    \vfg{C}'
            %    = \vfg{X}^{-1}\vfg{C},
            %\end{align}
            %where $\vfg{C}' \in \mathbb{C}^{L \times K}$.

            \begin{lemma}
                \label{lemma:unitary-transformation-orthonormality}
                Let $\brac{\xi_{\mu}}$ be an orthonormal set of $L$
                spin-orbitals.
                Performing a unitary transformation of this basis set will yield
                a new basis set $\brac{\phi_{p}}$ of $L$ orthonormal
                spin-orbitals.
            \end{lemma}
            \begin{proof}
                Performing a unitary transformation from the orthonormal basis
                of atomic orbitals $\brac{\xi_{\mu}}_{\mu = 1}^{L}$ to a new
                basis set $\brac{\phi_p}_{p = 1}^{L}$ is done via
                \begin{align}
                    \ket{\phi_p} = U_{\mu p}\ket{\xi_{\mu}},
                \end{align}
                where $U_{\mu p}$ is an element in the unitary matrix $\vfg{U}
                \in \mathbb{C}^{L \times L}$.
                As the atomic orbitals are orthonormal, we find
                \begin{align}
                    \braket{\phi_{p}}{\phi_{q}}
                    =
                    U^{*}_{\mu p} \braket{\xi_{\mu}}{\xi_{\nu}}
                    U_{\nu q}
                    = U^{*}_{\mu p} U_{\mu q}
                    = \delta_{pq},
                \end{align}
                due to the unitarity of the matrix $\vfg{U}$.
                This proves
                \autoref{lemma:unitary-transformation-orthonormality}.
            \end{proof}


    \section{Slater determinants}
        \label{sec:slater-determinants}
        So far we have established that the full many-body wave function of a
        fermionic system should be antisymmetric with respect to its particles.
        The creation and annihilation operators for the Fock space
        representation of many-body configurations incorporates the
        anti-symmetry requirement, but we are no closer to establishing what our
        many-body wave function looks like in a coordinate representation making
        it hard to compute integrals in order to find matrix elements.

        A start is to consider a system of non-interacting particles with a
        Hamiltonian on the form
        \begin{align}
            \hamil = \sum_{i = 1}^{N} \onehamil_i,
        \end{align}
        where $\onehamil_i$ is a one-body Hamiltonian acting on particle $i$. We
        are able to find the spectrum of $\onehamil$, and we can use the $N$
        first eigenstates $\ket{\psi_i}$ as a basis of spin-orbitals.
        This lets us construct a many-body wave function as a product state from
        these spin-orbitals, viz.
        \begin{align}
            \ket{\Psi}
            = \bigotimes_{i = 1}^{N}\ket{\psi_i}
            = \ket{\psi_1}\otimes\dots\otimes\ket{\psi_n}.
        \end{align}
        The coordinate representation of this state can be found by
        \begin{align}
            \braket{x_1, \dots, x_n}{\Psi}
            = \psi_1(x_1)\dots\psi_n(x_n),
        \end{align}
        where $\psi_i(x_i)$ is the coordinate representation of the
        spin-orbitals.
        Since each eigenstate $\ket{\psi_i}$ is an eigenstate of the one-body
        Hamiltonian with eigenenergy $\epsilon_i$ we can find the total energy
        of the full Hamiltonian by
        \begin{align}
            \hamil\ket{\Psi}
            = E\ket{\Psi}
            = \brak{
                \sum_{i = 1}^{N}
                \epsilon_i
            }\ket{\Psi}.
        \end{align}
        This particular product state is in quantum chemistry and nuclear
        physics often known as the \emph{Hartree product}.
        However, a product state is neither symmetric nor antisymmetric with
        respect to exchange of particles as a product state is not an eigenstate
        of the exchange operator.
        A way to introduce particle indistinguishability and the anti-symmetry
        requirement to the product state is to create a linear combination of
        product states using the permutation operator $\hat{P}_{\sigma}$ defined
        in a similar manner as in \autoref{sec:particle-statistics}.
        Defining the action of the permutation operator on the product state to
        be
        \begin{align}
            \hat{P}_{\sigma}\ket{\Psi}
            = \hat{P}_{\sigma}\bigotimes_{i = 1}^{N}\ket{\psi_i}
            = \bigotimes_{i = 1}^{N}\ket{\psi_{\sigma(i)}},
        \end{align}
        where $\sigma(i)$ is a permutation.
        Now we construct the \emph{antisymmetrizer} $\hat{A}$ defined as the
        operator
        \begin{align}
            \hat{A} = \frac{1}{N!}\sum_{\sigma \in S_{N}}\hat{P}_{\sigma},
        \end{align}
        that is, the operator that performs all $N!$ permutations in $S_{N}$.
        Using the antisymmetrizer we can construct a totally antisymmetric wave
        function $\ket{\Phi}$ by
        \begin{align}
            \ket{\Phi}
            = \sqrt{N!}\hat{A}\ket{\Psi}
            = \frac{1}{\sqrt{N!}}\sum_{\sigma \in S_{N}}
            \hat{P}_{\sigma}
            \bigotimes_{i = 1}^{N}\ket{\psi_i},
            \label{eq:slater-determinant-abstract}
        \end{align}
        where the factor $\sqrt{N!}$ is added to ensure that $\ket{\Phi}$ is
        normalized.
        As the non-interacting many-body Hamiltonian only acts on a single
        spin-orbital at a time, the ordering does not matter.
        This means that
        \begin{align}
            \com{\hamil}{\hat{P}_{\sigma}} = 0,
        \end{align}
        and the state $\ket{\Phi}$ is also an eigenstate of $\hamil$ with the
        same energy $E$ as the product state $\ket{\Psi}$.
        The coordinate representation of $\ket{\Phi}$ now takes on the familiar
        form of a determinant,
        \begin{align}
            \Phi(x_1, \dots, x_N)
            &=
            \braket{x_1, \dots, x_N}{\Phi}
            = \frac{1}{\sqrt{N!}}
            \sum_{\sigma \in S_{N}}
            \prod_{i = 1}^{N}
            \psi_{\sigma(i)}(x_i)
            \\
            &=
            \frac{1}{\sqrt{N!}}
            \begin{vmatrix}
                \psi_1(x_1) & \dots & \psi_N(x_1) \\
                \vdots & \ddots & \vdots \\
                \psi_1(x_N) & \dots & \psi_N(x_N)
            \end{vmatrix}.
            \label{eq:coord_slater}
        \end{align}
        Here $\Phi(x_1, \dots, x_N)$ is known as the \emph{Slater determinant}
        of $N$ particles.
        Exchanging a row or a column in the determinant results in a sign change
        as required from the antiysmmetric full wave function for the many-body
        problem.
        This means that there can not be two, or more, of the same spin-orbitals
        in the wave function perfectly encapsulating the Pauli principle as two
        of the same spin-orbitals translates to two particles being in the same
        state.
        The spin-orbitals in a Slater determinant are linearly independent,
        otherwise $\Phi(x_1, \dots, x_N) = 0$ and thus constitute a basis.
        This is a consequence of the properties of a determinant that adding a
        scalar multiple of a column to another column does not change the
        determinant.

        In Fock space the Slater determinants are represented as the occupation
        number vectors $\ket{\vfg{n}}$, that is, projecting the occupation
        number vectors on a spatial basis yields the Slater determinants.
        This is somewhat of a misnomer where an abstract occupation number
        vector is named a Slater determinant which stricly speaking is defined
        on a coordinate system.
        However, we will continue this tradition and name the fermionic
        occupation number vectors Slater determinants.
        As Slater determinants are the occupation number vectors we see that the
        creation and annihilation operators build states which are Slater
        determinants and the Slater determinants will form a basis in Fock
        space.
        The action of a creation operator on a Slater determinant will be to add
        a new column in the determinant, whereas an annihilation operator
        removes a column.

        \subsection{Reference determinant}
            When working with many-body methods we typically start from a single
            Slater determinant $\ket{\slat}$ called the \emph{reference state}
            or \emph{reference determinant} and build a basis of Slater
            determinants using the creation and annihilation operators to create
            \emph{excited determinants}.
            The reference determinant is defined as the determinant with lowest
            energy in the non-interacting case.
            Using canonical ordering it is given by
            \begin{align}
                \ket{\slat}
                = \brak{
                    \prod_{i = 1}^{N} \ccr{i}
                } \ket{\vac}
                = \ccr{N}\dots\ccr{1}\ket{\vac},
            \end{align}
            where $N$ is the number of particles in the system we are exploring.

        \subsection{Fermi vacuum}
            \label{subsec:fermi-vacuum}
            Having introduced the reference state as the Slater determinant
            consisting of the $N$ lowest single-particle states, and being the
            determinant that all other higher-order determinants are built from,
            we define a ``new vacuum'' called the \emph{Fermi vacuum}.
            That is, for a given basis of single-particle states
            $\brac{\phi_{p}}_{p = 1}^{L}$, we split the basis into an
            \emph{occupied} basis and a \emph{virtual} basis,
            \begin{align}
                \brac{\phi_{p}}_{p = 1}^{L}
                = \brac{\phi_{i}}_{i = 1}^{N}
                \cup
                \brac{\phi_{a}}_{a = N + 1}^{L},
            \end{align}
            where $N$ is the number of particles in our reference determinant
            $\ket{\slat}$.
            The occupied states are single-particle states that are contained in
            the reference determinant $\ket{\slat}$.
            We denote the occupied index set by $o = \brac{1, \dots, N}$.
            The virtual states are all $M = L - N$ other states in the
            single-particle basis that are not contained in the reference
            determinant.
            The virtual index set is denoted by $v = \brac{N + 1, \dots, L}$.
            As is the convention in the field of many-body quantum mechanics, we
            use the indices $i, j, k, l, \dots \in o$ to signify occupied
            indices.
            Repeated occupied indices means that we only sum over occupied
            states.
            For the virtual indices we use $a, b, c, d, \dots \in v$ and
            repeated indices are only summed over virtual states.
            Lastly, we use $p, q, r, s, \dots \in o \cup v$ for general states.

            Recalling the definition of the creation and annihilation operator,
            we have that an annihilation operator destroys the vacuum whereas a
            creation operator will populate the vacuum.
            Shifting the vacuum to mean the reference determinant we see that we
            get a new definition for the creation and the annihilation
            operators.
            That is, our new annihilation operators will destroy the reference
            determinant, whereas the new creation operators will populate the
            reference determinant.
            This means that $\ccr{i}$ and $\can{a}$ will be our new annihilation
            operators as
            \begin{align}
                \ccr{i}\ket{\slat} = \can{a}\ket{\slat} = 0.
            \end{align}
            Our new creation operators will be $\ccr{a}$ and $\can{i}$ as their
            action on the reference state will either add or remove a
            single-particle state without annihilating the determinant.
            \begin{gather}
                \ccr{a}\ket{\slat}
                = \para{\Gamma_{-}}^{\slat}_{a}\ket{\slat'},
                \\
                \can{i}\ket{\slat}
                = \para{\Gamma_{-}}^{\slat}_{i}\ket{\slat''},
            \end{gather}
            where $\ket{\slat'}$ is $\ket{\slat}$ with particle state $\ket{a}$
            added and $\ket{\slat''}$ is $\ket{\slat}$ with particle state
            $\ket{i}$ removed.

            From the Fermi vacuum formalism we can extend the anticommutation
            relations by splitting up into occupied and virtual states.
            We have that
            \begin{align}
                \acom{\can{a}}{\ccr{i}}_F
                = \acom{\ccr{a}}{\can{i}}_F
                = 0,
                \label{eq:fermi-anticommutation-zero}
            \end{align}
            as $a \neq i$, and similarly for the other virtual and occupied
            indices.
            We've denoted the anticommutators by an $F$ to emphasize that we
            are using Fermi vacuum indices.
            % TODO: Introduce the anticommutation relations for Fermi vacuum.
            % TODO: This might be related to Wick's theorem.

        \subsection{Excited determinants}
            \label{subsec:excited-determinants}
            From the reference determinant we can create excited determinants by
            acting on the reference determinant with a creation operator and an
            annihilation operator.
            An excited determinant is defined as a Slater determinant containing
            the same number of single-particle states $N$ as the reference
            determinant, but with higher-order single-particle states.
            That is, in the non-interacting case, an excited determinant will
            yield a higher, or equal, eigenenergy than the reference
            state.\footnote{%
                It is not necessarily true that the eigenenergy of an excited
                state will be higher than the eigenenergy of the reference
                state. If we are dealing with degenerate reference determinants
                we can very well get the same eigenenergy for an excited
                determinant as the reference state.%
            }
            \begin{definition}
                \label{def:excitation-operator}
                An \emph{excitation operator} is defined in terms of creation
                and annihilation operators as
                \begin{align}
                    \hat{X}^{a}_{i} \equiv \ccr{a}\can{i},
                \end{align}
                and conversely the \emph{relaxation operator} as the Hermitian
                conjugate of the excitation operator, viz.
                \begin{align}
                    \para{\hat{X}^{a}_{i}}^{\dagger} = \ccr{i}\can{a},
                \end{align}
                where the indices are defined according to the formalism used
                for the Fermi vacuum.
            \end{definition}
            Acting with the excitation operator in
            \autoref{def:excitation-operator} on the reference state, we get
            \begin{align}
                \ket*{\slat^{a}_{i}}
                \equiv
                \hat{X}^{a}_{i}\ket*{\slat},
            \end{align}
            where we denote the excited state by $\ket*{\slat^{a}_{i}}$.
            If $\ket*{\slat} \in F_{-}(L, N)$ we see that $\ket*{\slat} \in
            F_{-}(L, N)$ as we remove state $\ket{i}$ and inserts state
            $\ket{a}$ thus preserving the number of particles $N$ in the excited
            state.
            From the Fermi vacuum formalism we have $i < a$ which means that
            neither the excitation nor the relaxation operator incurs a sign
            change.
            Furthermore, from the fundamental anticommutation relations and with
            the addition of the Fermi vacuum in
            \autoref{eq:fermi-anticommutation-zero} we see that
            \begin{align}
                \acom{\hat{X}^{a}_{i}}{\hat{X}^{b}_{j}}
                = 0,
            \end{align}
            and similarly for the relaxation operators.
            In fact, as the excitation and relaxation operators consist of an
            even number of second quantized operators they also commute, viz.
            \begin{align}
                \com{\hat{X}^{a}_{i}}{\hat{X}^{b}_{j}} = 0.
            \end{align}
            % TODO: Should we use general excitaton level?
            By repeating the action of the excitation operator on the reference
            state, we can create any $\ket*{\slat_{\mu}} \in F_{-}(L, N)$, where
            $\mu$ is used as a placeholder for any excitation level.
            That is,
            \begin{align}
                \ket*{\slat^{abc\dots}_{ijk\dots}}
                = \hat{X}^{a}_{i}\hat{X}^{b}_{j}\hat{X}^{c}_{k}\dots
                \ket*{\slat}
                = \hat{X}^{abc\dots}_{ijk\dots}\ket*{\slat},
                \label{eq:antisymmetric-excitation}
            \end{align}
            where we've defined the compound excitation operator
            $\hat{X}^{abc\dots}_{ijk\dots}$ as the product of several excitation
            operators.
            As the excitation operators anticommute we get the following
            antisymmetry requirements on the compound excitation operators,
            \begin{align}
                \hat{X}^{abc\dots}_{ijk\dots}
                =
                -\hat{X}^{bac\dots}_{ijk\dots}
                =
                -\hat{X}^{abc\dots}_{jik\dots}
                =
                \hat{X}^{bac\dots}_{jik\dots}.
            \end{align}
            Note that we get a natural truncation of $N$ excitation operators on
            any reference determinant with $N$ particles as $N + 1$ excitation
            operators, or more, will annihilate the reference determinant.
            As discussed in \autoref{subsec:fock-space}, if the basis of single-particle
            states is orthonormal, then all excited states and the reference
            state will be orthonormal to one another.

        \subsection{Operator representation}
            Having found the coordinate representation of the Slater
            determinants we are in a position to determine how we can evaluate
            the expectation values of an operator $\hat{Q}$ as an integral, viz.
            \begin{align}
                \expval{Q}
                = \mel{\Phi}{\hat{Q}}{\Phi}
                = \int\dd\vfg{x}\Phi^{*}(\vfg{x})\hat{Q}\Phi(\vfg{x}),
            \end{align}
            but this quickly becomes tedious as the $dN$-dimensional integral --
            where $d$ is the dimensionality of a single coordinate $x$ -- over
            determinants of single-particle functions is quite involved.
            Luckily, the second quantized formulation lets us collect any
            operator $\hat{Q}$ as a sum of $N$-body operators $\hat{Q}_i$ which
            we can evaluate using tensor contractions over $N$-body matrix
            elements.
            That is, we can write
            \begin{align}
                \hat{Q}
                = \sum_{i = 0}^{N}
                \hat{Q}_i
                = q_0\1
                + q^{p}_{q}\ccr{p}\can{q}
                + \frac{1}{2!}
                q^{pq}_{rs}\ccr{p}\ccr{q}\can{s}\can{r}
                + \dots,
                \label{eq:many-body-operator}
            \end{align}
            where each $N$-body operator is symmetrical in its indices, and includes
            a $(N!)^{-1}$ factor to account for double counting.
            The matrix elements of the $N$-body operator is given by
            \begin{gather}
                q^{p}_{q}
                \equiv
                \mel{\phi_p}{\hat{Q}_1}{\phi_q}
                = \int\dd x \phi^{*}_{p}(x)\hat{Q}_1\phi_q(x),
                \\
                q^{pq}_{rs}
                \equiv
                \mel{\phi_p\phi_q}{\hat{Q}_2}{\phi_r\phi_s}
                =
                \int\dd x_1\dd x_2
                \phi^{*}_{p}(x_1)\phi^{*}_{q}(x_2)
                \hat{Q}_2
                \phi_r(x_1)
                \phi_s(x_2),
                \\
                \vdots
            \end{gather}
            Here we have specified a label for single-particle states, but
            these expressions are valid for any basis of single-particle states.
            In this thesis we will limit ourselves to at most two-particle
            operators.
            A proof of why this representation of the one- and two-body
            operators is valid is shown in
            \autoref{app:operator-representation}.

        \subsection{The Slater-Condon rules}
            The Slater-Condon rules \cite{slater-rules, condon-rules} gives all
            non-zero contributions to matrix elements of one- and two-body
            operators over Slater determinants constructed from an orthonormal
            basis of single-particle states.
            The notation used to describe these rules are widely different, and
            the rules are notoriously difficult to express in a straightforward
            manner.
            Wikipedia gives a relatively clear description
            \cite{wiki:slater-condon}, but they give the impression that the
            rules only apply for a reference determinant and determinants
            excited at most twice from this reference.
            Furthermore, the sign of the matrix elements is completely ignored
            in this description.

            We will use the occupation number representation of the Slater
            determinants to describe the Slater-Condon rules.
            Thus, $\ket{\vfg{n}}$ describes a Slater determinant containing the
            states in the set $\vfg{n}$.
            To denote an index being contained in a given set we use the
            Kronecker-Delta notation $\delta_{p \in \vfg{n}}$ which is read as
            ``all states $p$ in the set $\vfg{n}$''.
            In the jargon of the Fermi vacuum, this corresponds to the occupied
            states in $\ket{\vfg{n}}$.
            The difference in the number of states in two states $\ket{\vfg{n}}$
            and $\ket{\vfg{m}}$ is given by $\abs{\vfg{n} - \vfg{m}}$.
            Note that we only look at states with the same number of particles
            $N$, which means that the difference between two states will always
            be an even number as an excitation is done by replacing
            single-particle states.
            We are now ready to state the Slater-Condon rules.
            \begin{lemma}
                \label{lemma:slater-condon-one-body}
                Given two Fock states $\ket{\vfg{n}}, \ket{\vfg{m}} \in F_{-}(L,
                N)$ and a one-body operator on the form
                \begin{align}
                    \hat{g} = g^{p}_{q}\ccr{p}\can{q},
                \end{align}
                the Slater-Condon rules for this operator gives the value of the
                matrix elements $\mel{\vfg{n}}{\hat{g}}{\vfg{m}}$.
                The three cases are:
                \begin{gather}
                    \mel{\vfg{n}}{\hat{g}}{\vfg{m}}
                    = \begin{cases}
                        g^{p}_{p}\delta_{p \in \vfg{m}},
                        & \abs{\vfg{n} - \vfg{m}} = 0,
                        \\
                        g^{p}_{q}
                        (\Gamma_{-})^{\vfg{n}}_{p}
                        (\Gamma_{-})^{\vfg{m}}_{q}
                        \delta_{p \in \vfg{n}}
                        \delta_{q \in \vfg{m}},
                        & \abs{\vfg{n} - \vfg{m}} = 2,
                        \\
                        0, & \abs{\vfg{n} - \vfg{m}} > 2,
                    \end{cases}
                \end{gather}
                where the phase $(\Gamma_{-})^{\vfg{n}}_{p}$ is the same as in
                \autoref{def:creation_1}.
                Sums are only over repeated indices in the matrix elements.
            \end{lemma}
            From \autoref{lemma:slater-condon-one-body} we see that two
            determinants can differ by at most a single-excitation for the
            matrix element to be non-zero.
            This greatly limits the number of matrix elements that needs to
            evaluated when working with orthonormal Slater determinants acting
            on one-body operators.
            \begin{lemma}
                \label{lemma:slater-condon-two-body}
                Given two Fock states $\ket{\vfg{n}}, \ket{\vfg{m}} \in F_{-}(L,
                N)$ and a two-body operator on the form
                \begin{align}
                    \hat{g} = \frac{1}{4}g^{pq}_{rs}\ccr{p}\ccr{q}\can{r}\can{s},
                \end{align}
                where we assume that the two-body matrix elements $g^{pq}_{rs}$
                are antisymmetric, that is,
                \begin{align}
                    g^{pq}_{rs}
                    = \mel{\phi_p\phi_q}{\hat{g}}{\phi_r\phi_s}
                    - \mel{\phi_p\phi_q}{\hat{g}}{\phi_s\phi_r}.
                \end{align}
                The Slater-Condon rules for this operator gives the value of the
                matrix elements $\mel{\vfg{n}}{\hat{g}}{\vfg{m}}$.
                The four cases are:
                \begin{gather}
                    \mel{\vfg{n}}{\hat{g}}{\vfg{m}}
                    = \begin{cases}
                        \half g^{pq}_{pq}(1 - \delta_{pq})
                        \delta_{p \in \vfg{m}}
                        \delta_{q \in \vfg{m}},
                        & \abs{\vfg{n} - \vfg{m}} = 0,
                        \\
                        g^{pr}_{qr}
                        (\Gamma_{-})^{\vfg{n}}_{p}
                        (\Gamma_{-})^{\vfg{m}}_{q}
                        \delta_{p \in \vfg{n}}
                        \delta_{q \in \vfg{m}}
                        \delta_{r \in \vfg{n}},
                        & \abs{\vfg{n} - \vfg{m}} = 2,
                        \\
                        g^{pq}_{rs}
                        (\Gamma_{-})^{\vfg{n}}_{p}
                        (\Gamma_{-})^{\vfg{n}}_{q}
                        (\Gamma_{-})^{\vfg{m}}_{r}
                        (\Gamma_{-})^{\vfg{m}}_{s}
                        \delta_{p, q \in \vfg{n}}
                        \delta_{r, s \in \vfg{m}}
                        & \abs{\vfg{n} - \vfg{m}} = 4,
                        \\
                        0, & \abs{\vfg{n} - \vfg{m}} > 4,
                    \end{cases}
                \end{gather}
                where the phase $(\Gamma_{-})^{\vfg{n}}_{p}$ is the same as in
                \autoref{def:creation_1}.
                The factor $(1 - \delta_{pq})$ in the first case comes about as
                a consequence of the Pauli exclusion principle where
                $\can{p}\can{p}$ always destroys an antisymmetric state.
                Pay extra close attention to the Kronecker-Deltas in the
                evaluation of the matrix elements when $\abs{\vfg{n} - \vfg{m}}
                = 4$ as we've added the notation $\delta_{p, q \in \vfg{n}}$
                denoting that both $i$ and $j$ must be contained in $\vfg{n}$.
                Sums are only over repeated indices in the matrix elements.
            \end{lemma}
            % TODO: Add proof the Slater-Condon rules.

        \subsection{Orbital rotations}
            As demonstrated in
            \autoref{lemma:unitary-transformation-orthonormality}, a unitary
            transformation of the spin-orbital basis preserves orthonormality.
            An extension to this lemma is therefore that the normalization of a
            Slater determinant built from an orthonormal basis of spin-orbitals
            is preserved when transforming to a new basis by a unitary
            transformation.
            \begin{lemma}
                \label{lemma:unitary-transformation-slater}
                Let $\ket{\slat}$ be a Slater determinant built from $N$
                single-particle states from an orthonormal basis
                $\brac{\phi_i}_{i = 1}^{L}$.
                We can then perform a unitary transformation to a new
                orthonormal basis $\brac{\psi_i}_{i = 1}^{L}$ building a new
                $N$-particle Slater determinant $\ket{\Psi}$, where the
                single-particle states in $\ket{\Psi}$ are obtained by the
                unitary transformation of the $N$ single-particle states in
                $\ket{\slat}$.
                This unitary transformation will leave the determinant invariant
                up to a complex phase.
            \end{lemma}
            See \autoref{sec:orbital-rotations} for a proof of this lemma.
            Another important theorem for computational many-body quantum
            mechanics is \emph{Thouless theorem} as it explains the role and the
            influence of the singles excitations operators
            \cite{thouless1960225}.
            \begin{theorem}
                \label{theorem:thouless}
                Given an $N$-particle Slater determinant $\ket{\slat}$, we can
                write any other $N$-particle Slater determinant $\ket{\Psi}$
                where $\braket{\slat}{\Psi} \neq 0$, by
                \begin{align}
                    \ket{\Psi}
                    = \exp[\clust]\ket{\slat},
                \end{align}
                where $\clust = \clustamp^{a}_{i}\hat{X}^{a}_{i}$ is a singles
                excitation operator with the coefficients $\clustamp^{a}_{i}$
                determined uniquely.
            \end{theorem}
            % TODO: Add proof in appendix
            Stated in words, Thouless theorem tells us that we can construct any
            other $N$-particle determinant $\ket{\Psi}$ from an arbitrary
            $N$-particle determinant $\ket{\slat}$ using an exponential singles
            excitation operator as long as the two determinants are not
            orthogonal to one another.

        \subsection{Determinant overlap}
            \label{subsec:determinant-overlap}
            So far we've limited our attention to an orthonormal set of basis
            states, thus making the Slater determinants orthonormal.
            However, we will discover situations where the determinants no
            longer are orthonormal.
            This will mainly be due to time evolution of the single-particle
            states.
            In some sense we are computing the overlap between two determinants
            in differing bases, but this can be represented as two expansions of
            the same underlying basis.
            Consider the two spin-orbital expansions
            \begin{gather}
                \ket{\phi_i} = C_{\alpha i}\ket{\chi_{\alpha}}, \\
                \ket{\psi_i} = D_{\alpha i}\ket{\chi_{\alpha}},
            \end{gather}
            where $\brac{\ket{\chi_{\alpha}}}_{\alpha = 1}^{L}$ is an underlying
            basis of spin-orbitals with overlap
            \begin{align}
                \overlapten_{\alpha\beta}
                = \braket{\chi_{\alpha}}{\chi_{\beta}},
            \end{align}
            not necessarily orthonormal.
            The overlap between the two spin-orbital expansions is thus given by
            \begin{align}
                \braket{\psi_i}{\phi_j}
                = D^{*}_{\alpha i}
                \braket{\chi_{\alpha}}{\chi_{\beta}}
                C_{\beta j}
                = D^{*}_{\alpha i}
                \overlapten_{\alpha\beta}
                C_{\beta j}
                \equiv
                T_{ij},
            \end{align}
            where we've defined the overlap elements $T_{ij}$.
            In matrix notation the overlap matrix $\vfg{T}$ is found from the
            coefficient matrices $\vfg{C}$ and $\vfg{D}$ along with the overlap
            matrix $\overlapmat$ by
            \begin{align}
                \vfg{T} = \vfg{D}^{\dagger}\overlapmat\vfg{C}.
            \end{align}
            We now construct two Slater determinants $\ket{\slat}$ and
            $\ket{\Psi}$ from the $N$ first spin-orbitals $\ket{\phi_i}$ and
            $\ket{\psi_i}$, respectively.
            Using the antisymmetrizer, the overlap between the two determinants
            is given by
            \begin{align}
                \braket{\Psi}{\slat}
                &=
                \frac{1}{N!}
                \sum_{\sigma, \tau \in S_N}
                (-1)^{\abs{\sigma}\abs{\tau}}
                \prod_{i = 1}^{N}
                \braket{\psi_{\sigma(i)}}{\phi_{\tau(i)}}
                \\
                &=
                \frac{1}{N!}
                \sum_{\sigma, \tau \in S_N}
                (-1)^{\abs{\sigma}\abs{\tau}}
                \prod_{i = 1}^{N}
                T_{\sigma(i)\tau(i)},
            \end{align}
            where we now have a double sum over all permutations $\sigma$ and
            $\tau$.
            By keeping one of the permutation sums fixed, we see that the
            product over $i$ will yield all unique combinations of $T_{ij}$.
            Thus, summing over both permutations will yield the same terms $N!$
            times and we can remove one of the permutation sums at the cost of
            multiplying by $N!$.
            This leaves us with
            \begin{align}
                \braket{\Psi}{\slat}
                &=
                \frac{1}{N!} N!
                \sum_{\sigma \in S_N}
                (-1)^{\abs{\sigma}}
                \prod_{i = 1}^{N}
                T_{i\sigma(i)}
                =
                \det(\vfg{T}),
            \end{align}
            where we've recognized the determinant of $T$.


    \section{The many-body Hamiltonian}
        A general many-body Hamiltonian can be described by
        \begin{align}
            \hamil \equiv \sum_{i = 0}^{\infty} \hamil_i,
        \end{align}
        where we denote the $N$-body Hamiltonian by $\hamil_i$.
        From the postulates of quantum mechanics we require that
        $\hamil^{\dagger} = \hamil$, that is, the Hamiltonian should be
        Hermitian.
        This in turn implies that $\hamil_i^{\dagger} = \hamil_i$ for all
        $N$-body terms.
        We can compute the energy, i.e., the expectation value of the
        Hamiltonian, by
        \begin{align}
            \mel{\psi}{\hamil}{\psi}
            &= \sum_{i = 0}^{\infty} \mel{\psi}{\hamil_i}{\psi}
            = \mel{\psi}{\hamil_0}{\psi}
            + \mel{\psi}{\hamil_1}{\psi}
            + \mel{\psi}{\hamil_2}{\psi}
            + \dots,
        \end{align}
        where each term involves the \emph{interaction} between $i$ particles.
        For $i = 0$ we have $\hamil_0$ which we take to signify a constant term,
        e.g., the nuclear repulsion energy of an atomic system where we limit
        our attention to electrons.
        This term contributes with a constant energy shift in the expectation
        value.
        The one-body term, $\hamil_1$, is the familiar Hamiltonian from
        introductory courses in quantum mechanics.
        This term describes one-particle contributions, e.g., the kinetic
        energy, external potentials of the system, external fields, etc.
        Higher order terms describe interactions between particles in the
        system.
        For example, the Coulomb interaction is a two-body interaction between
        particle pairs and is described by $\hamil_2$.
        More exotic higher-order interactions can occur in nuclear physics and
        the sort.
        However, it is common to truncate the interactions in the many-body
        Hamiltonian as higher-order terms leads to complicated equations which
        become intractable unless clever approximations are introduced.

        Luckily, much of solid-state physics, and almost all of quantum
        chemistry, can be described by the Coulomb interaction as the dynamics
        of the system is mainly governed by the electrons.
        This means that we will truncate the many-body Hamiltonian to
        second-order interactions.
        Furthermore, we ignore the constant term in the Hamiltonian as this can
        always be added when we compute the energy and will not contribute when
        we look for a solution of the many-body problem.
        We will denote the general electronic Hamiltonian by
        \begin{align}
            \hamil = \onehamil + \twohamil,
        \end{align}
        where $\onehamil$ is the one-body term and $\twohamil$ describes
        two-body interactions, which in our case is the Coulomb interaction.

        \subsection{The Born-Oppenheimer approximation}
            The Born-Oppenheimer approximation first occured in a seminal paper
            by \citeauthor{born1927quantentheorie}
            \cite{born1927quantentheorie}.
            It is a procedure describing how we can solve a molecular system
            consisting of electrons and nucleons where we assume that the total
            wave function can approximately be separated into an electronic and
            a nuclear part, viz.
            \begin{align}
                \ket{\Psi} \approx \ket{\Psi_e}\otimes\ket{\Psi_n},
            \end{align}
            where we denote the electronic wave function by $\ket{\Psi_e}$ and
            the nuclear counterpart as $\ket{\Psi_n}$.
            This lets us separate the full Hamiltonian in a nuclear Hamiltonian
            and an electronic Hamiltonian.
            We say that this approximation is valid as the electrons move much
            faster than the nucleons and that the electrons therefore
            experiences the nucleus as having a fixed position in time
            \cite{mayer2003simple}.
            The electronic Hamiltonian desribed above therefore only includes
            the nucleus-nucleus terms as a constant energy shift, the
            electron-nucleus interaction as a potential well and the rest of the
            system is described by the Coulomb interaction and the kinetic
            energy.
            % TODO: Review this text.
            % TODO: Consider including the full Hamiltonian.


        \subsection{One-body Hamiltonian}
            The one-body Hamiltonian describes the non-interacting system we are
            examining.
            In the time-independent case, we typically describe the system by a
            sum of kinetic and potential terms,
            \begin{align}
                \onehamil
                &= \sum_{i = 1}^{N}\onehamil_i
                = \sum_{i = 1}^{N}\para{
                    \kinetic_i + \potential_i
                }
                = \sum_{i = 1}^{N}\para{
                    \frac{\momentumvec^2_i}{2m_i} + \potential_i
                },
            \end{align}
            where the sum runs over all particles in the system separately.
            The potential term can come from many different sources, e.g., an
            external field, mean-field approximations, the electron-nucleon
            interaction, etc.
            We will discsuss these more in depth when we start looking at
            specific systems.
            % TODO: Perhaps include the grid representation of the operators?
            Often when solving the many-body problem we seek a solution to the
            one-body Hamiltonian in terms of a reference Slater determinant.
            This will in many cases provide us with a good starting guess for
            the system before using more sophisticated methods such as the
            Hartree-Fock method to improve on our reference state.

            \subsubsection{Time-dependency}
                In general the time-dependency can occur in all the terms in the
                full many-body Hamiltonian, but the most common scenario is an
                external interaction occuring in the one-body Hamiltonian, e.g.,
                a laser field, time-varying potential, etc.
                In this thesis we will only concern ourselves with an external
                laser field.
                We can then write the time-dependent one-body Hamiltonian on the
                form
                \begin{align}
                    \onehamil(t)
                    &= \sum_{i = 1}^{N} \onehamil_i(t)
                    = \sum_{i = 1}^{N}\para{
                        \kinetic_i
                        + \potential_i
                        + \laserfield_i(t)
                    },
                \end{align}
                where the time-dependence is represented by the time-dependent
                operator $\laserfield_i(t)$.


        \subsection{Two-body Hamiltonian}
            The two-body Hamiltonian provides interactions between pairs of
            particles.
            This complicates the matter by introducing a double sum over all
            particles to include all pairs.
            \begin{align}
                \twohamil
                = \sum_{i = 1}^{N} \sum_{j = 1}^{N} \twohamil_{ij}.
            \end{align}
            Often some care must be taken when $i = j$ as this results in
            self-interaction which can yield unphysical results, but we have
            for the sake of generality written the full sum.
            % TODO: Verify this.
            % Remember that the overlap occurs in the integral.
            The two-body operator is often the bottle-neck in terms of
            complexity for the electronic Hamiltonian.

            \subsubsection{Coulomb interaction}
                We will in this thesis concern ourselves with electronic
                interactions and will therefore limit ourselves to the Coulomb
                interaction as our two-body operator.
                This operator is given by
                \begin{align}
                    \twohamil
                    &= \sum_{i = 1}^{N}\sum_{j = i + 1}^{N}
                    \twohamil_{ij}
                    = \sum_{i = 1}^{N}\sum_{j = 1}^{N}
                    \frac{1}{4\epsilon_0\pi}\frac{e^2}{\abs{\positionvec_i -
                    \positionvec_j}},
                \end{align}
                The Coulomb interaction is a quantized version of the Coulomb
                potential with $\epsilon_0$ representing the vacuum
                permittivity and $e^2$ the charge of the particles, which we
                assume to be of the same type.
                % TODO: Expand on the physical interpretation of Coulomb's law
                % and the quantized version.

        \subsection{Second quantized formulation}
            Having introduced the second quantized formulation of many-body
            quantum mechanics we wish to represent the Hamiltonian in this
            formalism.
            This introduces a generalization which will prove very useful for
            the later many-body methods as it removes the explicit grid
            representation of the operators and introduces abstract matrix
            elements as coefficients to the second quantized operators.
            For a given basis of $L$ orthonormal single-particle states
            $\brac{\phi_{p}}$ we can write the second quantized formulation of
            the electronic Hamiltonian as
            \begin{align}
                \hamil
                =
                \onehamil
                + \twohamil
                =
                \oneten^{p}_{q}
                \ccr{p}
                \can{q}
                +
                \twoten^{pq}_{rs}
                \ccr{p}
                \ccr{q}
                \can{s}
                \can{r},
                \label{eq:electronic-hamiltonian}
            \end{align}
            where we denote the antisymmetric two-body elements by
            \begin{align}
                \twoten^{pq}_{rs}
                \equiv
                \mel*{\phi_p\phi_q}{\twohamil}{\phi_r\phi_s}_{AS}
                =
                \mel*{\phi_p\phi_q}{\twohamil}{\phi_r\phi_s}
                -
                \mel*{\phi_p\phi_q}{\twohamil}{\phi_s\phi_r}.
                \label{eq:antisymmetric_two_body}
            \end{align}
            The matrix elements of the one- and two-body elements are given by
            \begin{gather}
                \oneten^{p}_{q}
                \equiv
                \mel*{\phi_{p}}{\onehamil}{\phi_{q}}
                =
                \int\dd x\phi^{*}_{p}(x)\onehamil\phi_q(x),
                \label{eq:h_pq}
                \\
                \mel*{\phi_p\phi_q}{\twohamil}{\phi_r\phi_s}
                =
                \int\dd x_1\dd x_2
                \phi^{*}_p(x_1)
                \phi^{*}_q(x_2)
                \twohamil
                \phi_{r}(x_1)
                \phi_{s}(x_2),
                \label{eq:u_pqrs}
            \end{gather}
            where $x$ is a generalized coordinate of spin, and position or
            momentum.

        \subsection{The reference energy}
            \label{subsec:reference-energy}
            Given a basis of $L$ orthonormal single-particle states
            $\brac{\phi_p}$ we construct a Slater determinant from the $N$ first
            states, viz.
            \begin{align}
                \ket*{\slat} = \ket*{\phi_1 \dots \phi_N},
            \end{align}
            that is, we have $N$ occupied states and $M = L - N$ virtual states
            using the same convention for the indices as discussed in
            \autoref{subsec:fermi-vacuum} on the Fermi vacuum.
            We dub this state the \emph{reference state} for reasons which will
            become clear when we start working on the many-body methods.
            For a general electronic Hamiltonian with one- and two-body
            operators, we can compute the expectation value of the energy from
            the reference state.
            \begin{align}
                \mel*{\slat}{\hamil}{\slat}
                &=
                \oneten^{p}_{q}
                \mel*{\slat}{\ccr{p}\can{q}}{\slat}
                + \frac{1}{4}
                \twoten^{pq}_{rs}
                \mel*{\slat}{\ccr{p}\ccr{q}\can{s}\can{r}}{\slat},
            \end{align}
            where we use the antisymmetric two-body elements.
            Using Wick's theorem\footnote{%
                Or the anti-commutation rules manually.
            } we can evaluate the overlap strings on the reference state.
            This yields the \emph{reference energy} given by
            \begin{align}
                \energyref
                &\equiv
                \mel*{\slat}{\hamil}{\slat}
                =
                \oneten^{i}_{i}
                + \frac{1}{2}\twoten^{ij}_{ij}.
                \label{eq:reference-energy}
            \end{align}
            The derivation of this expression can be found in
            \autoref{sec:deriving-the-reference-energy}.

        \subsection{The normal-ordered Hamiltonian}
            \label{subsec:normal-ordered-hamiltonian}
            Starting from the general electronic Hamiltonian on second quantized
            form in \autoref{eq:electronic-hamiltonian}, we can write the
            operators on normal-ordered form relative to the Fermi vacuum.
            We then get
            \begin{align}
                \hamil_N
                = \fock_N + \twohamil_N
                = \fockten^{p}_{q}\normalord{
                    \ccr{p}
                    \can{q}
                }
                + \frac{1}{4}\twoten^{pq}_{rs}\normalord{
                    \ccr{p}
                    \ccr{q}
                    \can{s}
                    \can{r}
                },
            \end{align}
            where the matrix elements of the normal-ordered Fock operator is
            given by
            \begin{align}
                \fockten^{p}_{q}
                = \oneten^{p}_{q}
                + \twoten^{pi}_{qi}.
            \end{align}
            The complete derivation of the normal-ordered Hamiltonian is shown
            in \autoref{app:normal-ordered-hamiltonian}


    \section{Many-body density matrices}
        \label{sec:mb-density-matrices}
        In a seminal paper by \citeauthor{lowdin-density-matrices}
        \cite{lowdin-density-matrices}, the concept of a many-body density
        matrix in terms of the orbitals of a Slater determinant is discussed.
        These are dubbed $N$-body density matrices, where $N$ depends on the
        $N$-body interaction, that is, the number of particles included in the
        interaction.
        Consider the Hermitian operator $\hat{Q}$ from
        \autoref{eq:many-body-operator}, then for a normalized, pure state
        $\ket{\psi}$, we are able to compute the expectation value of the
        operator $\hat{Q}$ by
        \begin{align}
            \expval{Q} &= \mel{\psi}{\hat{Q}}{\psi}
            = \tr(\density \hat{Q}),
        \end{align}
        where we've introduced the density operator $\ket{\psi}$ by
        \begin{align}
            \density = \dyad{\psi}{\psi}.
        \end{align}
        Now, if $\ket{\psi}$ is a wave function describing a system of $N$
        particles, we can write the expectation value of the operator $\hat{Q}$
        as
        \begin{align}
            \expval{Q}
            &= \tr(\density \hat{Q})
            = \braket{\psi}\mel{\psi}{\hat{Q}}{\psi}
            = \sum_{i = 0}^{N} \mel{\psi}{\hat{Q}_i}{\psi}
            \\
            &=
            Q_0 \mel{\psi}{\1}{\psi}
            + Q^{p}_{q}\mel{\psi}{\ccr{p}\can{q}}{\psi}
            + \frac{1}{2!}
            Q^{pq}_{rs}
            \mel{\psi}{\ccr{p}\ccr{q}\can{s}\can{r}}{\psi}
            + \dots
            \\
            &= Q_0 + Q^{p}_{q}\densityten^{q}_{p}
            + \frac{1}{2!} Q^{pq}_{rs} \densityten^{rs}_{pq}
            + \dots,
        \end{align}
        where we ask the reader to direct special attention to the index
        ordering of the $N$-body density matrix indices $\densityten$ as the
        ``opposite'' direction of the index ordering from the $N$-body matrix
        elements.
        % TODO: Prove this ordering from Szabo and Ostlund.
        We thus observe that all information about the wave function that is
        needed for the evaluation of the expectation value $\expval{Q}$ is
        contained in the $N$-body density matrices, where the elements are given
        by
        \begin{gather}
            \rho^{q}_{p}
            = \mel{\psi}{\ccr{p}\can{q}}{\psi},
            \label{eq:one-body-density-elements}
            \\
            \rho^{rs}_{pq}
            = \mel{\psi}{\ccr{p}\ccr{q}\can{s}\can{r}}{\psi},
            \label{eq:two-body-density-elements}
            \\
            \vdots
        \end{gather}
        Of all the $N$-body density matrices, the one- and two-body density
        matrices are the ones that are most applicable for our work as the
        many-body Hamiltonian we are looking at is limited to two-body
        interactions and we are only interested in observables expressable as
        one-body operators.

        \subsection{One-body density matrix}
            We will denote the one-body density operator by $\density_1$ where
            the elements are given by \autoref{eq:one-body-density-elements}.
            Comparing the one-body density operator with the general density
            operator as discussed in \autoref{sec:density-operators} we have
            that $\density^{\dagger}_1 = \density_1$, i.e., it is Hermitian.
            This can be seen from the elements by
            \begin{align}
                (\densityten^{q}_{p})^{*}
                = \mel{\psi}{\ccr{p}\can{q}}{\psi}^{*}
                = \mel{\psi}{\ccr{q}\can{p}}{\psi}
                = \densityten^{p}_{q}.
            \end{align}
            The one-body density is positive semidefinite, which means it
            satisifies the positivity condition for density operators.
            % TODO: Back this up.
            The normalization of the one-body density is however a little
            different from the general density operator.
            We have that
            \begin{align}
                \tr(\density_1)
                &= \densityten^{p}_{p}
                = \mel{\psi}{\ccr{p}\can{p}}{\psi}
                = N,
            \end{align}
            where $N$ is the number of particles contained in $\ket{\psi}$.
            The formalism of the one-body density operator can also be extended
            to a mixed many-body states similar to the general density operator.

        \subsection{Particle density}
            \label{subsec:particle-density}
            A quantity we will be concerned with is the one-particle density --
            also known as the first-order reduced density matrix -- which
            describes the simulatanous distribution of all the particles in the
            system.
            As an integral it is defined as
            \begin{align}
                \densityten(x_1)
                &= N\para{\prod_{i = 2}^{N} \int \dd x_i}
                \abs{\psi(x_1, x_2, \dots, x_N)}^2,
            \end{align}
            where the integral runs over all generalized coordinates $x_i$
            except for one \cite{lowdin-density-matrices, hogberget2013quantum}.
            Due to the indistinguishability of the particles, the particle
            density is a measure of where any particle is located in space under
            the influence of all the other particles.
            The one-body density provides insight as to where particles in a
            system will be positioned, but not which particles are where nor how
            they behave relative to each other.
            Using the one-body density matrix we are able to find the
            distribution of all the particles by the single-particle functions.
            This is given by
            \begin{align}
                \densityten(x)
                =
                \phi^{*}_q(x) \densityten^{q}_{p} \phi_p(x).
                \label{eq:particle-density}
            \end{align}
            An interesting property of the particle density is that we can
            define a sort of ad-hoc ionization description.
            The process of ionization can be described by a bound particle
            leaving the confinement of either the core of an atom or the a more
            general potential well.
            If we define a radius $R$ as the distance from the centre of the
            well to the edge where the influence of the well is zero, or close
            to zero, then we can measure the amount of ionization by
            \begin{align}
                I(R) = N\int_{\abs{x} \leq R}\dd x\densityten(x),
            \end{align}
            where $N$ is a normalization factor which we take to be the particle
            density integrated over the entire coordinate space such that $I(R)
            \in [0, 1]$.
            Note that the choice of $R$ depends on the system.
            Some systems such as the infinite harmonic oscillator will always
            have bound states and the ionization can thus be interpreted as a
            measure of how much of the state is still distributed in the centre
            of the well.

        \subsection{Two-body density matrix}
            We denote the two-body density operator by $\density_2$ with
            elements from \autoref{eq:two-body-density-elements}.
            Due to the anticommutation relations between the second quantized
            operators we have the anti-symmetry
            \begin{align}
                \densityten^{rs}_{pq}
                = -\densityten^{sr}_{pq}
                = -\densityten^{rs}_{qp}
                = \densityten^{sr}_{qp}.
            \end{align}
            As a consequence, the Pauli principle is baked into the elements by
            \begin{align}
                \densityten^{rr}_{pq}
                = \densityten^{rs}_{pp}
                = \densityten^{rr}_{p}
                = 0,
            \end{align}
            in the same way as the two-body Hamiltonian.
            The two-body density operator is also Hermitian in the sense that
            \begin{align}
                (\densityten^{rs}_{pq})^{*}
                = \mel{\psi}{\ccr{p}\ccr{q}\can{s}\can{r}}{\psi}^{*}
                = \mel{\psi}{\ccr{r}\ccr{s}\can{q}\can{p}}{\psi}
                = \densityten^{pq}_{rs}.
            \end{align}
            The two-body density operator is also positive semidefinite in the
            same manner as the one-body density operator.
            The normalization of the two-body density operator can be found from
            \begin{align}
                \densityten^{pq}_{pq}
                &= \mel{\psi}{\ccr{p}\ccr{q}\can{q}\can{p}}{\psi}
                = -\mel{\psi}{\ccr{p}\ccr{q}\can{p}\can{q}}{\psi}
                = -\mel{\psi}{
                    \ccr{p}(\delta_{pq} - \can{p}\ccr{q})\can{q}
                }{\psi}
                \\
                &=
                \mel{\psi}{\nop{p}\nop{q}}{\psi}
                - \mel{\psi}{\nop{p}}{\psi}
                = N^2 - N
                = N(N - 1).
            \end{align}
            % TODO: Check that this is correct.
            % Helgaker operates with N(N - 1) / 2, but this might be due to the
            % counting of the matrix version of the elements.
            The two-body density matrix can used when computing the energy
            contribution from the two-body Hamiltonian.

    \section{The multireference problem}
        A common topic in many-body quantum mechanics is the multireference
        problem.
        Most many-body methods require a single reference, i.e., a single Fock
        state, as a starting point and then build higher excited states from
        this state.
        In the case of degenerate reference states, we are in the multireference
        regime.
        As an example, consider the Lithium atom with three electrons, thus
        requiring a fourth electron in order to get a closed shell.
        In the case of a non-interacting Lithium atom in a given spin-orbital
        basis $\brac{\ket{\psi_i}}_{i = 1}^{L}$, the ground state will consist
        of the two Slater determinants
        \begin{align}
            \ket{\slat_1} &= \ket{\psi_1\psi_2\psi_3}, \\
            \ket{\slat_2} &= \ket{\psi_1\psi_2\psi_4},
        \end{align}
        where both states will have the same eigenenergy $E_1 = E_2$ from the
        non-interacting Hamiltonian $\onehamil$.
        The true ground state of this system will then be a linear combination
        of these two Fock states yielding
        \begin{align}
            \ket{\Psi}
            = \frac{1}{\sqrt{2}}\brak{
                \ket{\slat_1}
                \pm
                \ket{\slat_2}
            }.
        \end{align}
        % TODO: Check if this is correct.
        Most second quantized many-body methods rely on the single-reference
        assumption and will not work in the multireference regime.
        % TODO: Discuss this in the coupled cluster and Hartree-Fock methods.
        % TODO: See static vs dynamic correlation in Helgaker.

\clearemptydoublepage

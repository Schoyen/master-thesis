\chapter{Hartree-Fock theory}
    One can not tackle the subject of many-body theory without a discussion of
    the Hartree-Fock method. It serves as an excellent initial approximation,
    and in many cases the \emph{only} approximation, to the many-body
    wavefunction for a given system. It is a rather cheap method, in terms of
    computational intensity, and explains much of the underlying physics of a
    given system of many particles.

    \section{Assumptions used in the Hartree-Fock method}
        In the Hartree-Fock method we make five assumptions in order to make the
        many-body problem tractable.
        \begin{enumerate}
            \item We assume that the \emph{Born-Oppenheimer approximation} is a
                good approximation.
                % TODO: Add theory on the Born-Oppenheimer approximation
            \item We assume that the motion of the electrons can be treated in
                the non-relativistical limit.
            \item We assume that the solution to the variational problem can be
                represented as a linear combination of a finite number of basis
                functions.
            \item The energy eigenfunctions of the time-independent Schrödinger
                equation can be described by a single Slater determinant.
            \item We assume that correlation between particles can be described
                in the \emph{mean-field approximation}.
        \end{enumerate}
        These assumptions provide the basis for the Hartree-Fock method. We
        shall see later that we quickly reach a limit where these assumptions
        break apart thus motivating the use of \emph{post Hartree-Fock methods}
        such as the coupled cluster method.
    \section{Time-independent Hartree-Fock theory}
        Much of the theory shown in this section draws from the excellent
        lecture notes by \citeauthor{kvaal2017notes} \cite{kvaal2017notes} and
        the book \citetitle{szabo1996modern} by \citeauthor{szabo1996modern}
        \cite{szabo1996modern}.
        Starting from the Schrödinger equation
        \begin{align}
            \hamil\ket{\Psi} = \energy\ket{\Psi},
        \end{align}
        where $\hamil$ is the electronic Hamiltonian with at most two-body
        interactions on the form
        \begin{align}
            \hamil = \onehamil + \twohamil,
        \end{align}
        where $\onehamil$ is the one-body part of the Hamiltonian and
        $\twohamil$ the higher order correlations.
        We know that the ground state of $\onehamil$ will be a single Slater
        determinant.
        If the two-body interactions are ``small'' we can assume that there will
        exist a Slater determinant which will capture most of the true ground
        state of the full Hamiltonian\footnote{We will see that it does not take
        much before the two-body interaction becomes a little more than just a
        small perturbation.}.
        This motivates the approximation that our many-body wave function
        $\ket{\Psi}$ can be approximated by a single Slater determinant.
        \begin{align}
            \ket{\Psi} = \ketslat = \ket{\phi_1, \phi_2, \dots, \phi_N},
        \end{align}
        where the \emph{molecular orbitals} $\brac{\phi_i}_{i = 1}^{N}$ are the
        primary unknowns.
        They are subject to the constraint that they are orthonormal.
        That is,
        \begin{align}
            \braket{\phi_i}{\phi_j} = \delta_{ij}
            \implies \braket{\slat}{\slat} = 1.
            % TODO: Check if this is an actual implication
        \end{align}

        \subsection{Non-canonical Hartree-Fock equations}
            Defining the energy functional
            \begin{align}
                \energyfunc{\slat}
                \equiv \braslat\hamil\ketslat
                =
                \bra{\phi_i}\onehamil\ket{\phi_i}
                + \half\bra{\phi_i\phi_j}\twohamil\ket{\phi_i\phi_j}_{AS},
                \label{eq:energy_func_hf}
            \end{align}
            where the Einstein summation convention is understood.
            The variational principle\footnote{%
                Note that we treat the Slater determinants as orthonormal thus
                removing the need to include the normalization factor in the energy
                functional.
            }
            tells us that the true ground state energy, $\energygs$, will be a lower
            bound to the energy found from the energy functional in
            \autoref{eq:energy_func_hf} for any normalized trial wavefunction
            $\ketslat$.
            That is,
            \begin{align}
                \energygs
                \leq \energyfunc{\slat} = \braslat\hamil\ketslat.
            \end{align}
            Our task is now to find the molecular orbitals $\brac{\phi_i}_{i =
            1}^{N}$ that minimizes the energy functional%
            \footnote{%
                This is done by finding a stationary state for $\energyfunc{\slat}$,
                which does not guarantee that we have found a minimum, but often the
                stationary state will be a minimum.
            }.
            By performing a variation in the Slater determinant,
            \begin{align}
                \slat \to \slat + \delta\slat,
            \end{align}
            we find the that the energy functional is changed by
            \begin{align}
                \energyfunc{\slat + \delta\slat}
                &=
                \bra{\slat + \delta\slat}\hamil\ket{\slat + \delta\slat}
                \\
                &= \energyfunc{\slat}
                + \bra{\delta\slat}\hamil\ketslat + \braslat\hamil\ket{\delta\slat}
                + \dots
                \\
                &= \energyfunc{\slat} + \delta\energyfunc{\slat}
                + \dots,
            \end{align}
            where the \emph{first variation} in $\energyfunc{\slat}$ is given by
            \begin{align}
                \delta\energyfunc{\slat}
                \equiv
                \bra{\delta\slat}\hamil\ketslat + \braslat\hamil\ket{\delta\slat},
            \end{align}
            where we treat $\delta$ as a linear differential operator.
            Higher order variations are ignored and we are thus only interested in
            finding the Slater determinant, $\ketslat$, for which
            \begin{align}
                \delta\energyfunc{\slat} = 0,
            \end{align}
            i.e., the stationary point of the energy functional in terms of the
            function $\slat$.
            However the energy functional, $\energyfunc{\slat}$, does not
            incorporate the constraint that the molecular orbitals should be
            orthonormal.
            To ensure this constraing we use the method of Lagrange multipliers,
            with one multiplier for every constraint.
            We thus construct the Lagrangian functional
            \begin{align}
                \lagrangianfunc{\slat, \lambda}
                &= \energyfunc{\slat}
                - \lambda_{ji}\para{
                    \braket{\phi_i}{\phi_j}
                    - \delta_{ij}
                }.
            \end{align}
            As the Lagrangian functional, $\lagrangianfunc{\slat, \lambda}$, is
            real, and as the constraint is Hermitian, the Lagrange multipliers,
            $\lambda_{ji}$, can be taken to be Hermitian as well.

            \begin{proof}[%
                    Proof that the Lagrange multipliers can be chosen Hermitian%
                ]
                We follow closely the derivation done by Mayer
                \cite{mayer2003simple}, we start by noticing that the constraint is
                Hermitian, i.e.,
                \begin{align}
                    \braket{\phi_i}{\phi_j} - \delta_{ij}
                    = \braket{\phi_j}{\phi_i}^{*} - \delta_{ji}.
                \end{align}
                As of now we have two independent Lagrange multipliers; one for the
                overlap $\braket{\phi_i}{\phi_j}$ and another for the the complex
                conjugate $\braket{\phi_j}{\phi_i}$.
                We can formulate the constraint for the real and imaginary part
                separately.
                This yields
                \begin{align}
                    \Re\brac{
                        \braket{\phi_i}{\phi_j}
                    }
                    &=
                    \half\brac{
                        \braket{\phi_i}{\phi_j}
                        + \braket{\phi_j}{\phi_i}
                    }
                    = 0,
                    \\
                    \Im\brac{
                        \braket{\phi_i}{\phi_j}
                    }
                    &=
                    \frac{1}{2i}\brac{
                        \braket{\phi_i}{\phi_j}
                        - \braket{\phi_j}{\phi_i}
                    }
                    = 0.
                \end{align}
                Introducing two separate Lagrange multipliers $\mu_{ij}$ and
                $\nu_{ij}$ for the two latter conditions, we get
                \begin{align}
                    \mu_{ij}\Re\brac{
                        \braket{\phi_i}{\phi_j}
                    }
                    + \nu_{ij}\Im\brac{
                        \braket{\phi_i}{\phi_j}
                    }
                    &=
                    \half\brak{
                        \mu_{ij} - i\nu_{ij}
                    }
                    \braket{\phi_i}{\phi_j}
                    \nonumber
                    \\
                    &\qquad
                    + \half\brak{
                        \mu_{ij} + i\nu_{ij}
                    }
                    \braket{\phi_j}{\phi_i}.
                \end{align}
                We now choose our combined Lagrange multipliers to be
                \begin{align}
                    \lambda_{ji} &=
                    -\half\brak{
                        \mu_{ij} - i\nu_{ij}
                    }, \\
                    \lambda_{ij} &=
                    -\half\brak{
                        \mu_{ij} + i\nu_{ij}
                    },
                \end{align}
                which implies that $\lambda_{ji} = \lambda_{ij}^{*}$, as was to be
                shown.
            \end{proof}
            We are now interested in finding a stationary point in the Lagrangian
            with respect to the molecular orbitals $\phi_k$ subject to the
            constraint that they are orthonormal.
            As we are trying to find a stationary point of the Lagrangian functional
            with respect to the molecular orbitals, we will use \emph{functional
            derivatives} as the orbitals are functions.
            % TODO: Read up on functional derivative theory
            The action of a functional derivative on the matrix elements in the
            Lagrangian functional is given by
            \begin{gather}
                \dfd{\phi_k^{*}}\braket{\phi_i}{\phi_j}
                = \delta_{ik}\ket{\phi_j}, \\
                \dfd{\phi_k^{*}}\bra{\phi_i}\hat{h}\ket{\phi_i}
                = \hat{h}\ket{\phi_k}, \\
                \dfd{\phi_k^{*}}\bra{\phi_i}\dpd{}{t}\ket{\phi_i}
                = \dpd{}{t}\ket{\phi_k}, \\
                \dfd{\phi_k^{*}}\bra{\phi_i\phi_j}\hat{u}\ket{\phi_i\phi_j}_{AS}
                = 2\bra{\cdot\phi_j}\hat{u}\ket{\phi_k\phi_j}_{AS},
            \end{gather}
            where the "dot" is defined in terms of the tensor product by
            \begin{align}
                \ket{\phi_i\phi_j} = \ket{\phi_i}\otimes\ket{\phi_j}
                \implies \ket{\cdot\phi_j} \equiv \1 \otimes\ket{\phi_j}.
            \end{align}
            The last derivative can be found by expanding the antisymmetrix matrix
            elements by \autoref{eq:antisymmetric_two_body} and applying the
            functional derivative two times on each term. Collecting the four terms
            and using the symmetric property of the two-body elements that
            \begin{align}
                \bra{\phi_i\phi_j}\hat{u}\ket{\phi_k\phi_l}
                = \bra{\phi_j\phi_i}\hat{u}\ket{\phi_l\phi_k}.
            \end{align}
            We treat $\phi_k(x)$ and $\phi_k^{*}(x)$ as independent
            variables and taking the functional derivative of the Lagrangian
            function with respect to either form yields the same equations but
            complex conjugated of one another, we will restrict our attention to
            finding the functional derivative of the Lagrangian functional with
            respect to $\phi_k^{*}(x)$.
            \begin{align}
                \dfd{\phi_k^{*}}\lagrangianfunc{\slat, \lambda}
                = \dfd{\phi_k^{*}}\energyfunc{\slat}
                - \lambda_{jk}\ket{\phi_{j}},
            \end{align}
            where the functional derivative of the energy functional is given by
            \begin{align}
                \dfd{\phi_k^{*}}\energyfunc{\slat}
                = \onehamil\ket{\phi_k}
                + \bra{\cdot\phi_j}\twohamil\ket{\phi_k\phi_j}_{AS}.
            \end{align}
            Inserted back into the functional derivative of the Lagrangian and
            equating to zero we get
            \begin{gather}
                \onehamil\ket{\phi_k}
                + \bra{\cdot\phi_j}\twohamil\ket{\phi_k\phi_j}_{AS}
                - \lambda_{jk}\ket{\phi_{j}} = 0.
                \label{eq:min_lagrangian_phi_k}
            \end{gather}
            To go from here we introduce the Fock operator
            \begin{align}
                \fock\ket{\phi_k}
                = \onehamil\ket{\phi_k}
                + \bra{\cdot\phi_j}\twohamil\ket{\phi_k\phi_j}_{AS},
            \end{align}
            where the states $\ket{\phi_j}$ are contained in the Slater determinant,
            whereas $\ket{\phi_k}$ can be any molecular orbital in the basis.
            % TODO: The point on the occupied orbitals needs to made more explicit.
            We insert the expression for the Fock operator into
            \autoref{eq:min_lagrangian_phi_k}.
            We also move the Lagrange multipliers to the right hand side of the
            equation.
            This yields the equation
            \begin{align}
                \fock\ket{\phi_k} = \lambda_{jk}\ket{\phi_j},
                \label{eq:non-canonical-hartree-fock}
            \end{align}
            known as the \emph{non-canonical Hartree-Fock equations}.

        \subsection{Canonical Hartree-Fock equations}
            This equation will yield the correct Hartree-Fock energy, but we are
            interested in an eigenvalue equation without a summation over the matrix
            of Lagrange multipliers.
            To reach this goal we define a new set of spin-orbitals
            $\brac{\ket{\psi_p}}$ which is given by
            \begin{align}
                \ket{\psi_p} = U_{qp}\ket{\phi_q},
            \end{align}
            where $\brac{\phi_q}$ is the set of spin-orbitals from the non-canonical
            Hartree-Fock equations and $U_{qp}$ is an element in the unitary matrix
            $\vfg{U}$.
            In other words, we perform a unitary transformation from the
            non-canonical spin-orbitals to the new set of spin-orbitals.
            As the transformation is unitary, this means that the orthonormality
            condition in the new spin-orbitals is preserved from the old
            spin-orbitals.
            \begin{proof}[%
                    Proof that a unitary transformation preserves orthonormality%
            ]
                Given a set of orthonormal basis states
                $\brac{\ket{\chi_{\alpha}}}_{\alpha = 1}^{L}$,
                we perform a unitary transformation from this basis set to a new
                basis set defined by
                \begin{align}
                    \ket{\phi_p} = U_{\alpha p}\ket{\chi_{\alpha}},
                \end{align}
                where $U_{\alpha p}$ is an element in the unitary matrix $\vfg{U} \in
                \mathbb{C}^{L \times L}$ satisfying
                \begin{align}
                    \vfg{U}^{\dagger}\vfg{U} = \vfg{U}\vfg{U}^{\dagger} = \1.
                \end{align}
                Taking the inner product between two states in the new basis set we
                get
                \begin{align}
                    \braket{\phi_p}{\phi_q}
                    = U^{*}_{\alpha p}
                    \braket{\chi_{\alpha}}{\chi_{\beta}}
                    U_{\beta q}
                    = U^{*}_{\alpha p} U_{\beta q} \delta_{\alpha \beta}
                    = U^{*}_{\alpha p} U_{\alpha q}
                    = \delta_{pq},
                \end{align}
                which shows that the new basis set $\brac{\ket{\phi_p}}_{p = 1}^L$
                preserves the orthonormality after the unitary transfomation.
                % TODO: This proof should probably be moved to the quantum-mechanics
                % section.
            \end{proof}
            Furthermore, the orthonormality of the Slater determinants are also
            preserved as shown in the proof in the subsection on Slater determinants.
            % TODO: Reference this properly
            As the Lagrange multipliers $\lambda_{ji}$ are Hermitian, we can
            construct a matrix $\vfg{\Lambda}$ of the multipliers which will be
            Hermitian.
            This means that we can construct a diagonal matrix $\vfg{\energy}$ from
            the Lagrange multipliers using the spectral theorem, viz.
            \begin{align}
                \vfg{\Lambda} = \vfg{U} \vfg{\energy} \vfg{U}^{\dagger}.
            \end{align}
            This procedure is also known as \emph{Schur decomposition}.
            In tensor notation we introduce a Kronkecker Delta of rank 3 defined as
            \begin{align}
                \delta^{i}_{jk} = \begin{cases}
                    1 & i = j = k, \\
                    0 & else.
                \end{cases}
            \end{align}
            The Schur decomposition of the Lagrange multipliers then take on the
            form
            \begin{align}
                \lambda_{ij} = U_{ik} E_{kl} U^{*}_{jl}
                = U_{ik} \delta^{m}_{kl} \epsilon_{m} U^{*}_{jl},
            \end{align}
            where $\epsilon_m$ are the diagonal entries in the matrix $\vfg{E}$.
            Starting from the non-canonical Hartree-Fock equations in
            \autoref{eq:non-canonical-hartree-fock} and inserting the transformed
            spin-orbitals we get
            \begin{gather}
                \fock\ket{\phi_k} = \lambda_{jk}\ket{\phi_j}
                \\
                \implies
                \fock U^{*}_{kl}\ket{\psi_{l}} = \lambda_{jk} U^{*}_{jl} \ket{\psi_l}
                \\
                \implies
                U_{km} U^{*}_{kl} \fock\ket{\psi_l}
                = U_{km} \lambda_{jk} U^{*}_{jl} \ket{\psi_l}
                \\
                \implies
                \delta_{ml} \fock \ket{\psi_l}
                = \delta^{n}_{ml} \epsilon_{n} \ket{\psi_l}
                \\
                \implies
                \fock\ket{\psi_m}
                = \epsilon_{m} \ket{\psi_m},
                \label{eq:canonical-hartree-fock}
            \end{gather}
            where we are left with the \emph{canonical Hartree-Fock equations}.
            These equations constitute an eigenvalue equation that only depends on
            the choice of basis.
            That is, they make no assumption on which orbitals are occupied or not.
            As mentioned earlier, the Hartree-Fock equations does not guarantee that
            we find a global minimum.
            In fact, it does not even guarantee that we find a minimum!
            We might just as well stumble upon a saddle point.
            % TODO: Discuss how to determine if we have found a minimum.

        \subsection{Brillouin's theorem}
            Brillouin's theorem states that given an orthonormal single-particle
            basis $\brac{\ket{\phi_p}}_{i = 1}^{L}$, which is used to build a basis of
            Slater determinants $\brac{\ket{\Phi_I}}_{I = 1}^{N_s}$, then
            \begin{align}
                \bra{\Phi}\hamil\ket{\Phi^{a}_{i}} = 0,
            \end{align}
            is true iff the single-particle basis is found from solving the
            Hartree-Fock equations and $\ket{\Phi^{a}_{i}}$ is any singly
            excited determinant from the reference determinant $\ket{\Phi}$
            \cite{kvaal2017notes}.
            An important consequence of this is that all single excitations,
            from the reference state, can be neglected if we choose the
            Hartree-Fock reference state as our reference determinant.
            \begin{proof}
                We prove Brillouin's theorem directly by evaluating the matrix
                element
                \begin{align}
                    \bra{\Phi}\hamil\ket{\Phi^{a}_{i}}
                    &= \bra{\Phi}\onehamil\ket{\Phi^{a}_{i}}
                    + \frac{1}{4}\bra{\Phi}\twohamil\ket{\Phi^{a}_{i}}
                    = \oneten^{a}_{i} + \twoten^{aj}_{ij}
                    = \fockten^{a}_{i},
                \end{align}
                where we've used the Slater-Condon rules to evaluate the matrix
                elements.
                As the single-particle basis is the molecular orbitals found
                from solving the Hartree-Fock equations
                \begin{align}
                    \fock\ket{\phi_p} = \varepsilon_p\ket{\phi_p},
                \end{align}
                the Fock matrix is diagonal.
                This means that
                \begin{align}
                    \fockten^{a}_{i}
                    \equiv
                    \bra{\phi_a}\fock\ket{\phi_i}
                    = \varepsilon_i\braket{\phi_a}{\phi_i}
                    = 0,
                \end{align}
                as the molecular orbitals are orthonormal by construction.
            \end{proof}

    \section{Solving the Hartree-Fock equations in a basis}
        Having found the canonical Hartree-Fock equations, we are interested
        in utilizing the method in order to find molecular orbitals
        $\brac{\ket{\phi_p}}_{p = 1}^{L}$ serving as an improvement to our
        known atomic orbital basis $\brac{\ket{\chi_{\alpha}}}_{\alpha =
        1}^{K}$.
        We will in the following demonstrate three different procedures that
        lets us find the molecular orbitals.
        These procedures are related to the restrictions put on the
        spin-orbitals as discussed in
        \autoref{subsec:restrictions-on-spin-orbitals}.
        In fact, each procedure provides a way to choose which restriction we
        want on our molecular orbitals.
        First we'll discuss a general Hartree-Fock method which puts no
        restrictions on the molecular orbitals.
        This method leads to general spin-orbitals as shown in
        \autoref{eq:general-spin-orbital}.
        The second method is known as the \emph{restricted Hartree-Fock} method
        as it assumes restricted spin-orbitals.
        This leads to molecular orbitals that are restricted spin-orbitals as
        shown in \autoref{eq:restricted-spin-orbital}.
        Finally, we'll demonstrate the \emph{unrestricted Hartree-Fock method}
        yielding unrestricted spin-orbitals for the molecular orbitals as
        shown in \autoref{eq:unrestricted-spin-orbital}.

        \subsection{Hartree-Fock with general spin-orbitals}
            Given an atomic orbital basis, e.g., harmonic oscillator basis,
            $\brac{\ket{\chi_{\alpha}}}_{\alpha = 1}^{K}$ we wish to find an
            orthonomal basis of molecular orbitals $\brac{\ket{\phi_{p}}}_{p =
            1}^{L}$ satisfying the canonical Hartree-Fock equations.
            We can transform from the known atomic orbital basis to the unknown
            molecular orbital basis by
            \begin{align}
                \ket{\phi_p} = C_{\alpha p}\ket{\chi_{\alpha}},
            \end{align}
            where $\vfg{C} \in \mathbb{C}^{K\times L}$ is now our unknown
            coefficient matrix.
            The orthonormality condition of the molecular orbitals can no be
            formulated as
            \begin{align}
                \braket{\phi_p}{\phi_q}
                &= C^{*}_{\alpha p} C_{\beta q}
                \braket{\chi_{\alpha}}{\chi_{\beta}}
                = C^{*}_{\alpha p} \overlapten_{\alpha \beta}
                C_{\beta q}
                = \delta_{pq},
            \end{align}
            where we've introduced the overlap matrix $\overlapmat$ with
            elements
            \begin{align}
                \braket{\chi_{\alpha}}{\chi_{\beta}} = \overlapten_{\alpha\beta}.
            \end{align}
            By left-projecting with a state from our atomic orbital basis onto
            the canonical Hartree-Fock equations, we can create a set of
            equations in order to find the coefficients.
            \begin{gather}
                \mel{\chi_{\alpha}}{\fock}{\phi_q}
                = \epsilon_{q} \braket{\chi_{\alpha}}{\phi_q}
                \\
                \implies
                \mel{\chi_{\alpha}}{\fock}{\chi_{\beta}} C_{\beta q}
                = \epsilon_q C_{\beta q} \overlapten_{\alpha \beta}.
            \end{gather}
            We denote the matrix elements of the Fock operator in the atomic
            orbital basis by
            \begin{align}
                \mel{\chi_{\alpha}}{\fock}{\chi_{\beta}}
                \equiv \fockten_{\alpha \beta}.
            \end{align}
            In the case of an orthonormal basis of atomic orbitals, the overlap
            matrix $\overlapmat \in \mathbb{C}^{K \times K}$ reduces to the identity
            matrix.
            The projected Hartree-Fock equations can then be written
            \begin{gather}
                \fockten_{\alpha\beta} C_{\beta q}
                = \overlapten_{\alpha \beta} C_{\beta q} \epsilon_{q}
                \\
                \implies
                \fockmat \vfg{C} = \overlapmat \vfg{C} \vfg{\epsilon},
                \label{eq:roothan-hall-general}
            \end{gather}
            where $\fockmat \in \mathbb{C}^{K \times K}$ is the \emph{Fock
            matrix} with elements from the atomic orbital basis on the Fock
            operator.
            The diagonal matrix $\vfg{\epsilon} = \diag(\epsilon_1, \dots,
            \epsilon_L)$ is the matrix with the eigenenergies from the canonical
            Hartree-Fock equation.
            The equation in \autoref{eq:roothan-hall-general} is known as the
            \emph{Roothan-Hall} equations \cite{roothan, hall}.
            They constitute a formulation of the integro-differential equations
            that are the canonical Hartree-Fock equations to a generalized
            eigenvalue equation formulated as matrices.
            An important point to note is that the Fock operator is an operator
            that includes the molecular orbitals which are dependent on the
            coefficient matrix $\vfg{C}$.
            That is,
            \begin{align}
                \fockten_{\alpha\beta}
                &= \mel{\chi_{\alpha}}{\fock}{\chi_{\beta}}
                = \mel{\chi_{\alpha}}{\onehamil}{\chi_{\beta}}
                +
                \mel{\chi_{\alpha}\phi_j}{\twohamil}{\chi_{\beta}\phi_j}_{AS},
            \end{align}
            where $j$ only sums over the $N$ occupied indices in the ground state
            Slater determinant.
            We see that only the anti-symmetric two-body elements depends on the
            coefficient matrix.
            Formulating the elements in terms of the known atomic orbitals and
            the coefficient matrix we get
            \begin{align}
                \mel{\chi_{\alpha}\phi_j}{\twohamil}{\chi_{\beta}\phi_j}
                &=
                C^{*}_{\gamma j} C_{\delta j}
                \mel{\chi_{\alpha}\chi_{\gamma}}{\twohamil}{\chi_{\beta}\chi_{\delta}},
                \\
                \mel{\chi_{\alpha}\phi_j}{\twohamil}{\phi_j\chi_{\beta}}
                &=
                C^{*}_{\gamma j} C_{\delta j}
                \mel{\chi_{\alpha}\chi_{\gamma}}{\twohamil}{\chi_{\delta}\chi_{\beta}}.
            \end{align}
            Introducing the density matrix of the occupied orbitals
            \begin{align}
                D_{\delta\gamma} \equiv
                C^{*}_{\gamma j} C_{\delta j},
            \end{align}
            where it is important to note the ordering of the indices.
            We can then write the matrix elements of the Fock operator in terms
            of the atomic orbitals and the density matrix as
            \begin{align}
                \fockten_{\alpha\beta}
                &= \mel{\chi_{\alpha}}{\onehamil}{\chi_{\beta}}
                +
                D_{\delta\gamma}
                \mel{\chi_{\alpha}\chi_{\gamma}}{\twohamil}{\chi_{\beta}\chi_{\delta}}_{AS}.
            \end{align}
            % TODO: Describe the SCF-procedure
            % TODO: Describe how to handle non-orthogonal atomic orbitals

            Having found the coefficients from the self-consistent field
            iterations and therefore the molecular orbitals and the ground state
            in the Hartree-Fock regime, we are at liberty to compute various
            observables.

            \subsubsection{General Hartree-Fock energy}
                The Hartree-Fock energy can be found by inserting the expansion
                of the molecular orbitals in the energy functional from
                \autoref{eq:energy_func_hf}.
                \begin{align}
                    \energy
                    &= \bra{\phi_i}\onehamil\ket{\phi_i}
                    + \half\bra{\phi_i\phi_j}\twohamil\ket{\phi_i\phi_j}_{AS}
                    \\
                    &=
                    C^{*}_{\alpha i} C_{\beta i}
                    \bra{\chi_{\alpha}}\onehamil\ket{\chi_{\beta}}
                    + \half
                    C^{*}_{\alpha i} C_{\gamma i}
                    C^{*}_{\beta j} C_{\delta j}
                    \bra{\chi_{\alpha}\chi_{\beta}}\twohamil
                    \ket{\chi_{\gamma}\chi_{\delta}}_{AS}
                    \\
                    &=
                    D^{\beta}_{\alpha} \oneten^{\alpha}_{\beta}
                    + \half
                    D^{\gamma}_{\alpha} D^{\delta}_{\beta}
                    \twoten^{\alpha \beta}_{\gamma \delta}.
                    \label{eq:general-hartree-fock-energy}
                \end{align}

            \subsubsection{General Hartree-Fock one-body density matrix}
                Due to the orthonormality of the molecular orbitals, the
                one-body density matrix is particularly comfortable to compute.
                \begin{align}
                    \densityten^{q}_{p}
                    = \braslat
                    \ccr{q}
                    \can{p}
                    \ketslat
                    = \delta_{p \in o}\delta_{pq},
                \end{align}
                where we have labelled the set of occupied indices in the Slater
                determinants by $o = \brac{1, \dots N}$.
                We can represent the one-body density matrix as a block matrix
                by
                \begin{align}
                    \vfg{\densityten}
                    = \begin{pmatrix}
                        \1_{N \times N} & \vfg{0}_{N \times M} \\
                        \vfg{0}_{M \times N} & \vfg{0}_{M \times M}
                    \end{pmatrix},
                \end{align}
                where $M = L - N$, i.e., the number of virtual basis states.

        \subsection{The restricted Hartree-Fock method}
            In the restricted Hartree-Fock method we make the assumption that
            each spin-direction is doubly occupied by an orbital.
            This can be a valid assumption if the Hamiltonian is
            spin-independent\footnote{%
                We write \emph{can} as there are situations where the
                Hamiltonian is spin-independent, but subject to conditions where
                the spin-symmetry of the restricted spin-orbitals break.
                % TODO: This needs to be explained properly
            }.
            To be even more specific, we will look at the \emph{closed-shell
            restricted Hartree-Fock} method, i.e., each spin-orbital \emph{must}
            be doubly occupied and each energy shell must be completely filled.
            This yields the spin-restricted spin-orbitals from
            \autoref{eq:restricted-spin-orbital}.
            For $L$ basis functions, we then get $L/2$ orbitals, where $L$ must
            be an even number.
            We label the states by
            \begin{align}
                \phi_{P}(x) = \varphi_p(\vf{r}) \sigma(m_s)
                \implies
                \ket{\phi_P} = \ket{\varphi_p\sigma},
            \end{align}
            where $P \in \brac{1, \dots, L}$ and $p \in \brac{1, \dots, L / 2}$.
            That is, we use capital letters to refer to composite indices and
            lowercase letters for the orbitals.
            We write the ground state Slater determinant as
            \begin{align}
                \ketslat = \ket{\phi_1 \phi_2 \dots \phi_{L - 1} \phi_L}
                = \ket{
                    (\varphi_1 \alpha)
                    (\varphi_1 \beta)
                    \dots
                    (\varphi_{L / 2} \alpha)
                    (\varphi_{L / 2}\beta)
                }.
            \end{align}
            The restricted molecular orbitals are orthonormal.
            As a consequence both the spin basis functions and the orbitals are
            orthonormal.
            \begin{align}
                \braket{\phi_P}{\phi_Q}
                = \braket{\sigma}{\tau}
                \braket{\varphi_p}{\varphi_q}
                = \delta_{\sigma \tau}
                \delta_{pq}
                = \delta_{PQ}.
            \end{align}
            We now insert the restricted spin-orbitals into the canonical
            Hartree-Fock equation.
            \begin{align}
                \fock\ket{\phi_P} = \epsilon_P\ket{\phi_P}
                \implies
                \fock\ket{\varphi_p\sigma}
                = \epsilon_P\ket{\varphi_p\sigma}.
            \end{align}
            By projecting onto another spin-orbital we demonstrate how we can
            construct the Fock matrix elements when the Hamiltonian is
            spin-independent.
            \begin{align}
                \bra{\phi_P}\fock\ket{\phi_Q}
                = \bra{\phi_P}\onehamil\ket{\phi_Q}
                + \bra{\phi_P\phi_J}\twohamil\ket{\phi_Q\phi_J}_{AS}.
                \label{eq:mo-fock-elements}
            \end{align}
            Looking at the one-body and the two-body parts separately we will
            demonstrate how the spin can be integrated out of the matrix
            elements.
            \begin{align}
                \bra{\phi_P}\onehamil\ket{\phi_Q}
                &= \braket{\sigma}{\tau}\bra{\varphi_p}\onehamil\ket{\varphi_q}
                = \delta_{\sigma\tau}\bra{\varphi_p}\onehamil\ket{\varphi_q}.
            \end{align}
            We split up the anti-symmetric elements into its constituent parts
            and show the spin-dependence in each explicitly.
            \begin{align}
                \bra{\phi_P\phi_J}\twohamil\ket{\phi_Q\phi_J}
                &= \braket{\sigma}{\tau}\braket{\nu}{\nu}
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_q\varphi_j}
                = 2 \delta_{\sigma\tau}
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_q\varphi_j},
            \end{align}
            where we've summed over the spin-dependence $\ket{\nu}$ from the two
            occupied orbitals in the two-body elements.
            That is,
            \begin{align}
                \braket{\nu}{\nu} = \delta_{\nu\nu} = 2.
            \end{align}
            For the second integral in the anti-symmetric two body elements we
            get
            \begin{align}
                \bra{\phi_P\phi_J}\twohamil\ket{\phi_J\phi_Q}
                &= \braket{\sigma}{\nu}\braket{\nu}{\tau}
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_j\varphi_q}
                = \delta_{\sigma\tau}
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_j\varphi_q},
            \end{align}
            where we've used the completness relation for the spin of the
            occupied molecular orbitals, viz.
            \begin{align}
                \ket{\nu}\bra{\nu}
                = \1 \in \mathbb{R}^{2 \times 2}.
            \end{align}
            Collecting terms, we get the Fock matrix elements
            \begin{align}
                \bra{\phi_P}\fock\ket{\phi_Q}
                &=
                \delta_{\sigma\tau}
                \para{
                    \bra{\varphi_p}\onehamil\ket{\varphi_q}
                    +
                    2
                    \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_q\varphi_j}
                    -
                    \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_j\varphi_q}
                },
            \end{align}
            where we see that the spin-dependence has been removed from the
            orbital integrals.
            We can therefore restrict ourselves to the orbital integrals for the
            Fock matrix elements.
            \begin{align}
                \bra{\varphi_p}\fock\ket{\varphi_q}
                &=
                \bra{\varphi_p}\onehamil\ket{\varphi_q}
                +
                2
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_q\varphi_j}
                -
                \bra{\varphi_p\varphi_j}\twohamil\ket{\varphi_j\varphi_q}.
            \end{align}
            This lets us look for coefficients for the orbitals that are
            independent of the spin.
            \begin{align}
                \ket{\varphi_p} = C_{\alpha p} \ket{\chi_{\alpha}},
            \end{align}
            where $\brac{\ket{\chi_{\alpha}}}_{\alpha = 1}^{K}$ is our basis of
            known atomic orbitals, without spin.
            By projecting the canonical Hartree-Fock equations for the orbitals
            onto the atomic orbitals we will again be left with the Roothan-Hall
            equations as in the case of the general Hartree-Fock method.
            However, the difference between the restricted and the general
            Hartree-Fock methods lies in our calculation of the Fock matrix
            elements in the atomic orbital basis.
            \begin{align}
                \fockten_{\alpha\beta}
                &\equiv \bra{\chi_{\alpha}}\fock\ket{\chi_{\beta}}
                =
                \bra{\chi_{\alpha}}\onehamil\ket{\chi_{\beta}}
                +
                2 \bra{\chi_{\alpha}\varphi_j}
                \twohamil
                \ket{\chi_{\beta}\varphi_j}
                - \bra{\chi_{\alpha}\varphi_j}
                \twohamil
                \ket{\varphi_j\chi_{\beta}}
                \\
                &=
                \bra{\chi_{\alpha}}\onehamil\ket{\chi_{\beta}}
                + 2 C^{*}_{j\gamma} C_{j\delta}
                \bra{\chi_{\alpha}\chi_{\gamma}}
                \twohamil
                \ket{\chi_{\beta}\chi_{\delta}}
                - C^{*}_{j\gamma} C_{j\delta}
                \bra{\chi_{\alpha}\chi_{\gamma}}
                \twohamil
                \ket{\chi_{\delta}\chi_{\beta}}
                \\
                &=
                \bra{\chi_{\alpha}}\onehamil\ket{\chi_{\beta}}
                + D_{\delta\gamma}
                \para{
                    \bra{\chi_{\alpha}\chi_{\gamma}}
                    \twohamil
                    \ket{\chi_{\beta}\chi_{\delta}}
                    -
                    \half
                    \bra{\chi_{\alpha}\chi_{\gamma}}
                    \twohamil
                    \ket{\chi_{\delta}\chi_{\beta}}
                },
                \label{eq:atomic-fock-rhf}
            \end{align}
            where we've introduced the restriced density matrix
            \begin{align}
                D_{\beta \alpha}
                = 2 C^{*}_{\alpha i} C_{\beta i},
            \end{align}
            as the index $i \in \brac{1, \dots, N / 2}$, where $N$ is the number
            of occupied states in the Hartree-Fock Slater determinant.

            By proceeding witht the self-consistent field iterations solving the
            Roothan-Hall equations with \autoref{eq:atomic-fock-rhf} as the
            definition of the Fock matrix elements, we find the orbital
            coefficient matrix $\vfg{C} \in \mathbb{C}^{K \times L/2}$ which we
            use to transform to the restricted molecular orbitals.
            Once transformed, we are at liberty to introduce spin-redundancy to
            open up for more general post Hartree-Fock methods.

            \subsubsection{Restricted Hartree-Fock energy}
                We can compute the ground-state restricted Hartree-Fock energy
                by inserting our expression for the restricted molecular
                orbitals into the energy functional in
                \autoref{eq:energy_func_hf}.
                \begin{align}
                    \energy
                    &= \bra{\Phi}\hamil\ket{\Phi}
                    = \bra{\phi_I}\onehamil\ket{\phi_I}
                    + \half
                    \bra{\phi_I\phi_J}
                    \twohamil
                    \ket{\phi_I\phi_J}_{AS}
                    \\
                    &=
                    \delta_{\sigma\sigma}
                    \bra{\varphi_i}\onehamil\ket{\varphi_i}
                    + \half\para{
                        \delta_{\sigma\sigma}\delta_{\tau\tau}
                        \bra{\varphi_i\varphi_j}
                        \twohamil
                        \ket{\varphi_i\varphi_j}
                        - \delta_{\sigma\tau}\delta_{\tau\sigma}
                        \bra{\varphi_i\varphi_j}
                        \twohamil
                        \ket{\varphi_j\varphi_i}
                    }
                    \\
                    &=
                    D^{\beta}_{\alpha}
                    \oneten^{\alpha}_{\beta}
                    + \half\para{
                        D^{\beta}_{\alpha}
                        D^{\delta}_{\gamma}
                        \twotensym^{\alpha\gamma}_{\beta\delta}
                        - \half
                        D^{\beta}_{\alpha}
                        D^{\delta}_{\gamma}
                        \twotensym^{\alpha\gamma}_{\delta\beta}
                    }
                    \\
                    &=
                    D^{\beta}_{\alpha}
                    \brac{
                        \oneten^{\alpha}_{\beta}
                        + \half D^{\delta}_{\gamma}
                        \para{
                            \twotensym^{\alpha\gamma}_{\beta\delta}
                            - \half
                            \twotensym^{\alpha\gamma}_{\delta\beta}
                        }
                    },
                    %&=
                    %D_{\beta \alpha}
                    %%C^{*}_{\alpha i} C_{\beta i}
                    %\bra{\chi_{\alpha}}\onehamil\ket{\chi_{\beta}}
                    %+ \half\para{
                    %    D_{\gamma\alpha} D_{\delta\beta}
                    %    %C^{*}_{\alpha i} C_{\gamma i}
                    %    %C^{*}_{\beta j} C_{\delta j}
                    %    -
                    %    \half
                    %    D_{\delta\alpha}
                    %    D_{\gamma\beta}
                    %    %C^{*}_{\alpha i} C_{\delta i}
                    %    %C^{*}_{\beta j} C_{\gamma j}
                    %}
                    %\bra{\chi_{\alpha}\chi_{\beta}}
                    %\twohamil
                    %\ket{\chi_{\gamma}\chi_{\delta}}.
                \end{align}
                where we've introduced the notation
                \begin{align}
                    \twotensym^{\alpha\beta}_{\gamma\delta}
                    \equiv \bra{\chi_{\alpha}\chi_{\beta}}
                    \twohamil
                    \ket{\chi_{\gamma}\chi_{\delta}},
                \end{align}
                for the two-body integrals.

        \subsection{The unrestricted Hartree-Fock method}
            The unrestricted Hartree-Fock method allows the molecular orbitals
            to have independent orbitals for each spin-direction.
            Hence, we assume that the molecular orbitals can be described by
            spin-unrestricted spin-orbitals as seen in
            \autoref{eq:unrestricted-spin-orbital}.
            Introducing indices for the different molecular orbitals, we denote
            the spin-unrestricted molecular orbitals by
            \begin{align}
                \phi_P(x)
                &=
                \varphi^{\sigma}_{p}(\vf{r})
                \sigma(m_s)
                \implies
                \ket{\phi_P}
                = \ket{\varphi^{\sigma}_{p}\sigma},
            \end{align}
            where $P \in \brac{1, \dots, L}$, $\sigma \in \brac{\alpha, \beta}$,
            and $p \in \brac{1, \dots, L_{\sigma}}$.
            We have that $L = L_{\alpha} + L_{\beta}$ and we have refrained from
            labelling the lower case orbital indices as they always occur with a
            spin index.
            Note that there is no implicit sum over the label $\sigma$ in the
            orbital $\varphi^{\sigma}_{p}$ and the spin-function $\sigma(m_s)$.
            We can collect the orbitals in two sets
            $\brac{\ket{\varphi^{\sigma}_{p}}}_{p = 1}^{L_{\sigma}}$, one for
            each spin-direction.
            The ground state Slater determinant can then be written
            \begin{align}
                \ketslat
                &=
                \ket{\phi_1 \phi_2 \dots \phi_{N - 1} \phi_N}
                =
                \ket{
                    (\varphi^{\alpha}_{1}\alpha)
                    \dots
                    (\varphi^{\alpha}_{N_{\alpha}}\alpha)
                    (\varphi^{\beta}_{1}\beta)
                    \dots
                    (\varphi^{\beta}_{N_{\beta}}\beta)
                },
            \end{align}
            where $N_{\sigma}$ is the number of particles with spin
            $\sigma(m_s)$.
            The orthonormality of the molecular orbitals is given by
            \begin{align}
                \braket{\phi_P}{\phi_Q}
                &= \delta^{P}_{Q}
                = \braket{\sigma}{\tau}
                \braket{\varphi^{\sigma}_{p}}{\varphi^{\tau}_{q}},
            \end{align}
            where the overlap between two orbitals with differing spin is not
            necessarily zero.
            However, if the two spin-directions are the same, i.e., $\sigma =
            \tau$, we get
            \begin{align}
                \braket{\varphi^{\sigma}_{p}}{\varphi^{\sigma}_{q}}
                = \delta^{p}_{q}.
            \end{align}
            Inserting the unrestricted spin-orbitals into the canonical
            Hartree-Fock equation yields
            \begin{align}
                \fock\ket{\phi_P}
                = \epsilon_P\ket{\phi_P}
                \implies
                \fock\ket{\varphi^{\sigma}_{p}\sigma}
                = \epsilon^{\sigma}_{p}\ket{\varphi^{\sigma}_{p} \sigma},
            \end{align}
            which demonstrates how each spin-component yields a different
            equation as the Fock eigenenergies $\epsilon^{\alpha}_{p}$ is in
            general different from $\epsilon^{\beta}_{p}$.
            By projecting onto another molecular orbital as in
            \autoref{eq:mo-fock-elements} we demonstrate how the spin yields two
            separate Fock matrices, one for each spin-direction.\footnote{%
                Note that this assumes a spin-independent Hamiltonian.
            }
            The one-body elements in the molecular orbital basis is given by
            \begin{align}
                \bra{\phi_P}\onehamil\ket{\phi_Q}
                &= \braket{\sigma}{\tau}
                \bra{\varphi^{\sigma}_{p}}
                \onehamil
                \ket{\varphi^{\tau}_{q}}
                = \delta^{\sigma}_{\tau}
                \bra{\varphi^{\sigma}_{p}}
                \onehamil
                \ket{\varphi^{\tau}_{q}}
            \end{align}
            The two-body elements yield
            \begin{align}
                \bra{\phi_P\phi_J}
                \twohamil
                \ket{\phi_Q\phi_J}
                &=
                \braket{\sigma}{\tau}
                \braket{\rho}{\rho}
                \bra{\varphi^{\sigma}_{p}\varphi^{\rho}_{j}}
                \twohamil
                \ket{\varphi^{\tau}_{q}\varphi^{\rho}_{j}}
                =
                \delta^{\sigma}_{\tau}
                \bra{\varphi^{\sigma}_{p}\varphi^{\rho}_{j}}
                \twohamil
                \ket{\varphi^{\tau}_{q}\varphi^{\rho}_{j}}
                \\
                &=
                \delta^{\sigma}_{\tau}
                \para{
                    \bra{\varphi^{\sigma}_{p}\varphi^{\alpha}_{j}}
                    \twohamil
                    \ket{\varphi^{\tau}_{q}\varphi^{\alpha}_{j}}
                    +
                    \bra{\varphi^{\sigma}_{p}\varphi^{\beta}_{j}}
                    \twohamil
                    \ket{\varphi^{\tau}_{q}\varphi^{\beta}_{j}}
                },
            \end{align}
            where, unlike in the restricted scheme, we get no factor $2$ from
            the Kronecker-Delta $\delta^{\rho}_{\rho}$ as the orbitals in the two
            different spin-directions are unequal.
            We note that this term provides a coupling between the orbitals in
            both spin-directions.
            The last term in the anti-symmetric two-body elements is given by
            \begin{align}
                \bra{\phi_P\phi_J}
                \twohamil
                \ket{\phi_J\phi_Q}
                &=
                \braket{\sigma}{\rho}
                \braket{\rho}{\tau}
                \bra{\varphi^{\sigma}_{p}\varphi^{\rho}_{j}}
                \twohamil
                \ket{\varphi^{\rho}_{j}\varphi^{\tau}_{q}}
                =
                \delta^{\sigma}_{\tau}
                \bra{\varphi^{\sigma}_{p}\varphi^{\tau}_{j}}
                \twohamil
                \ket{\varphi^{\sigma}_{j}\varphi^{\tau}_{q}}.
            \end{align}
            Collecting terms we are then left with
            \begin{align}
                \bra{\phi_P}\fock\ket{\phi_Q}
                &=
                \delta^{\sigma}_{\tau}
                \para{
                    \bra{\varphi^{\sigma}_{p}}
                    \onehamil
                    \ket{\varphi^{\tau}_{q}}
                    +
                    \bra{\varphi^{\sigma}_{p}\varphi^{\rho}_{j}}
                    \twohamil
                    \ket{\varphi^{\tau}_{q}\varphi^{\rho}_{j}}
                    -
                    \bra{\varphi^{\sigma}_{p}\varphi^{\tau}_{j}}
                    \twohamil
                    \ket{\varphi^{\sigma}_{j}\varphi^{\tau}_{q}}
                },
            \end{align}
            where we've demonstrated how the spin yields two different Fock
            matrices from the canonical Hartree-Fock equations.
            That is,
            \begin{align}
                \bra{\varphi^{\sigma}_{p}}\fock\ket{\varphi^{\sigma}_{q}}
                &=
                \bra{\varphi^{\sigma}_{p}}
                \onehamil
                \ket{\varphi^{\sigma}_{q}}
                +
                \bra{\varphi^{\sigma}_{p}\varphi^{\rho}_{j}}
                \twohamil
                \ket{\varphi^{\sigma}_{q}\varphi^{\rho}_{j}}
                -
                \bra{\varphi^{\sigma}_{p}\varphi^{\sigma}_{j}}
                \twohamil
                \ket{\varphi^{\sigma}_{j}\varphi^{\sigma}_{q}},
            \end{align}
            We now look for a set of coefficients for the orbitals in each
            spin-direction in terms of our original atomic orbital basis.
            \begin{align}
                \ket{\varphi^{\sigma}_{p}}
                &= C^{\sigma}_{\kappa p} \ket{\chi_{\kappa}},
            \end{align}
            where we use the greek letters $\kappa$, $\lambda$, $\mu$, and $\nu$
            for the atomic orbitals to avoid confusion with the spin-functions
            $\alpha(m_s)$ and $\beta(m_s)$.
            Before we demonstrate how we can generate a set of equations in
            order to find the coefficient matrices $\vfg{C}^{\sigma}$, we
            motivate the spin-labelling of the Fock matrices in the atomic
            orbital basis.
            \begin{align}
                \fockten^{\sigma}_{\kappa\lambda}
                &\equiv
                \bra{\chi_{\kappa}}\fock^{\sigma}\ket{\chi_{\lambda}}
                =
                \oneten_{\kappa\lambda}
                + \bra{\chi_{\kappa}\varphi^{\rho}_{j}}
                \twohamil
                \ket{\chi_{\lambda}\varphi^{\rho}_{j}}
                - \bra{\chi_{\kappa}\varphi^{\sigma}_{j}}
                \twohamil
                \ket{\varphi^{\sigma}_{j}\chi_{\lambda}}
                \\
                &=
                \oneten_{\kappa\lambda}
                +
                (C^{\rho}_{\mu j})^{*}
                C^{\rho}_{\nu j}
                \twotensym^{\kappa\mu}_{\lambda\nu}
                -
                (C^{\sigma}_{\mu j})^{*}
                C^{\sigma}_{\nu j}
                \twotensym^{\kappa\mu}_{\nu\lambda}
                \\
                &=
                \oneten_{\kappa\lambda}
                +
                D^{\rho}_{\nu\mu}
                \twotensym^{\kappa\mu}_{\lambda\nu}
                -
                D^{\sigma}_{\nu\mu}
                \twotensym^{\kappa\mu}_{\nu\lambda},
            \end{align}
            where the density matrix $D^{\rho}_{\nu\mu}$ with the free
            spin-index $\rho$ is summed yielding
            \begin{align}
                D^{\rho}_{\nu\mu}
                = D^{\alpha}_{\nu\mu}
                + D^{\beta}_{\nu\mu},
            \end{align}
            as opposed to the density matrix with the same spin-index as the
            left-hand side, that is, $\sigma$.
            Left-projecting the atomic orbital basis on the canonical
            Hartree-Fock equations acting on an orbital in the unrestriced
            regime yields
            \begin{gather}
                \bra{\chi_{\kappa}}\fock^{\sigma}\ket{\varphi^{\sigma}_{p}}
                = \epsilon^{\sigma}_{p}
                \braket{\chi_{\kappa}}{\varphi^{\sigma}_{p}}
                \\
                \implies
                C^{\sigma}_{\lambda p}
                \bra{\chi_{\kappa}}\fock^{\sigma}\ket{\chi_{\lambda}}
                = C^{\sigma}_{\lambda p} \epsilon^{\sigma}_{p}
                \braket{\chi_{\kappa}}{\chi_{\lambda}}
                \\
                \implies
                \fockten^{\sigma}_{\kappa \lambda}
                C^{\sigma}_{\lambda p}
                =
                \overlapten_{\kappa\lambda}
                C^{\sigma}_{\lambda p}
                \epsilon^{\sigma}_{p}
                \\
                \implies
                \vfg{F}^{\sigma}
                \vfg{C}^{\sigma}
                =
                \overlapmat
                \vfg{C}^{\sigma}
                \vfg{\epsilon}^{\sigma}.
            \end{gather}
            These coupled equations constitute the \emph{Pople-Nesbet
            equations}.
            They resemble the Roothan-Hall equations seen in the two previous
            methods in that they are generalized eigenvalue equations, but now
            we solve two sets of eigenvalue equations simultaneously.

            \subsubsection{The unrestricted Hartree-Fock energy}
                Inserting our expression for the molecular orbitals into the
                energy functional we find the unrestricted Hartree-Fock energy.
                \begin{align}
                    \energy
                    &=
                    \bra{\slat}\hamil\ket{\slat}
                    =
                    \bra{\phi_I}\onehamil\ket{\phi_I}
                    +
                    \half
                    \bra{\phi_I\phi_J}
                    \twohamil
                    \ket{\phi_I\phi_J}_{AS}
                    \\
                    &=
                    \bra{\varphi^{\sigma}_{i}}
                    \onehamil
                    \ket{\varphi^{\sigma}_{i}}
                    + \half\para{
                        \bra{\varphi^{\sigma}_{i}\varphi^{\tau}_{j}}
                        \twohamil
                        \ket{\varphi^{\sigma}_{i}\varphi^{\tau}_{j}}
                        -
                        \bra{\varphi^{\sigma}_{i}\varphi^{\sigma}_{j}}
                        \twohamil
                        \ket{\varphi^{\sigma}_{j}\varphi^{\sigma}_{i}}
                    }
                    \\
                    &=
                    D^{\sigma}_{\beta\alpha}
                    \oneten^{\alpha}_{\beta}
                    + \half
                    D^{\sigma}_{\beta\alpha}
                    D^{\tau}_{\delta\gamma}
                    \twotensym^{\alpha\gamma}_{\beta\delta}
                    - \half
                    D^{\sigma}_{\beta\alpha}
                    D^{\sigma}_{\delta\gamma}
                    \twotensym^{\alpha\gamma}_{\delta\beta},
                \end{align}
                where we've carried out the spin-sums implicitly and skipped the
                step where we show the coefficient matrices that go into the
                density matrices.


\input{theory/hartree-fock/time-dependent-hartree-fock.tex}

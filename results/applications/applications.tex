\chapter{Applications}
    \epigraph{NÃ¥ funker alt!}
    {--- Morten Ledum}

    Having verified that our implementations work on smaller systems in
    \autoref{chap:validation} and demonstrated the strength of the
    orbital-adaptive coupled-cluster methods in \autoref{chap:stability} we now
    seek to push the methods by exploring more complicated systems.
    Our goal is to firmly establish that we are able to explore larger systems
    than can be done with the full configuration interaction method and the
    multi-configuration Hartree-Fock method, while achieving a quality of the
    results beyond what is possible with the mean-field approximation using
    Hartree-Fock.
    Note that we in this chapter do little to no conscious effort in terms of
    optimization as the default setup of the solvers often yield more than good
    enough results.
    This means that we can focus as much as possible on the physics of the
    problems.

    \section{Electronic spectra of molecules}
        \label{sec:nest}
        In an article by \citeauthor{nest} \cite{nest} the
        multiconfiguration time-dependent Hartree-Fock method was tested on
        a system of lithium hydride and methane subject to a dipole
        laser pulse with a sine-squared envelope on the form\footnote{%
            Note that \citeauthor{nest} \cite{nest} does not explicitly add
            a formula for the laser, but based on their description we infer
            the form of the laser.
        }
        \begin{align}
            \vfg{E}(t)
            = -\vfg{\epsilon} E(t)
            \sin[2](\pi t / T)
            = -\vfg{\epsilon} E_0 \sin(\omega t)
            \sin[2](\pi t / T),
            \label{eq:nest-laser}
        \end{align}
        where $\vfg{\epsilon}$ is the polarization vector, $\omega$ is the
        frequency corresponding to a photon energy of $E_{\nu} =
        \SI{5.44}{\electronvolt}$.
        The negative sign in the polarization vector comes from the charge of
        the electrons.
        The laser field is active for $t \in \brak{0, T}$ where $T =
        \SI{1}{\femto\second}$, and the intensity of the laser field is chosen
        to be $I = \SI{3.5e12}{\watt/\cm^2}$.
        The simulation is run for $\SI{100}{\femto\second}$.
        A plot of the laser field in the first $t = \SI{2}{\femto\second}$ of
        the simulation is shown in \autoref{fig:nest-laser}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                        width=11cm,
                        height=6cm,
                        xlabel={$t$ $[\si{\planckbar / \hartree}]$},
                        grid=major,
                        ylabel={
                            $E(t)$ $[
                                \si{\hartree / (\elementarycharge \bohr)}
                            ]$
                        },
                        enlarge x limits=false,
                    ]
                    \addplot+ [
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/nest/dat/nest_laser_new.dat};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the laser pulse from
            \autoref{eq:nest-laser} for $t = \SI{2}{\femto\second} \approx
            \SI{82.6}{\hslash / \hartree}$, with parameters as defined in the
            text.}
            \label{fig:nest-laser}
        \end{figure}
        A word of caution, when reproducing the results in this article some
        care must be taken when converting to atomic units for the frequency,
        time, and the intensity of the laser as it is not clear how much one
        should round the numbers.
        We have used the Python library \citetitle{pint} \cite{pint} to
        convert from SI units to atomic units as they stand in the text
        without any rounding.
        These conversions are summarized in \autoref{tab:nest-conversions}.
        \begin{table}
            \centering
            \caption{In this table we show the conversions used to move from
            the SI units given in the article by \citeauthor{nest}
            \cite{nest} to the atomic units used in the simulation.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Quantity & SI units & Atomic units \\
                \midrule
                $E_{\nu}$ & $\SI{5.44}{\electronvolt}$ &
                \SI{1.999163e-1}{\hartree} \\
                $I$ & $\SI{3.5e12}{\watt/\cm^{2}}$ &
                \SI{9.973085e-5}{\text{a.u.}} \\
                $t$ & $\SI{1}{\femto\second}$ &
                \SI{4.134137e+1}{\hslash/\hartree}
                \\
                \bottomrule
            \end{tabular}
            \label{tab:nest-conversions}
        \end{table}
        The corresponding frequency in atomic units of the laser specified by
        the photon energy $E_{\nu}$ in \autoref{tab:nest-conversions} is $\omega
        = \SI{1.999163e-1}{\hartree/\hslash}$.
        The electric field strength from the intensity is found to be $E =
        \SI{9.986533e-4}{\hartree/(\elementarycharge \bohr)}$.

        We repeat the study for the \ch{LiH}-molecule as done by
        \citeauthor{nest}.
        We use a bond-length of $\SI{3.08}{\bohr}$ in the $z$-direction
        between the lithium and the hydrogen atoms with the basis 6-31G*.
        To specify this basis in PySCF we pass in the string \pyth{"6-31Gs"}.
        We use the TDHF, TDCCSD, and the OATDCCD solvers in this study and we
        sample the dipole moment for each method.
        Computing the Fourier transform of the dipole moment after the laser is
        turned off yields the absorption spectra of \ch{LiH}.
        We run two simulations; one where we polarize the laser along the
        $z$-direction and measure along the same axis, and another simulation
        where we do the same in the $x$-direction.

        In \autoref{fig:fft_dipole_nest} we have included the Fourier
        transform of the sampled dipole moment in $x$- and $z$-direction in
        time, respectively.
        These plots show the absorption spectra for the \ch{LiH}-molecule.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{x(t)}}$},
                        grid=major,
                        ylabel={Intensity},
                        enlarge x limits=false,
                        %ymax=0.5e-4,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{z(t)}}$},
                        ylabel={Intensity},
                        grid=major,
                        enlarge x limits=false,
                        %ymax=0.5e-4,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we show the Fourier transform of the
            dipole moment in $x$-and $y$-direction of the \ch{LiH}-molecule
            using time-dependent Hartree-Fock, time-dependent coupled cluster
            with singles and doubles, orbital-adaptive time-dependent coupled
            cluster with doubles excitations.
            The top figure shows the results in $x$-direction and the lower
            in $z$-direction.
            Note that we have removed the zero-frequency component from
            these spectra.}
            \label{fig:fft_dipole_nest}
        \end{figure}
        In \autoref{tab:fft_dipole_nest_x} we've used function
        \pyth{scipy.signal.find_peaks} \cite{scipy} to locate the transition
        energies for the Fourier specter of the dipole moment polarized along
        the $x$-direction.
        We've done the same in \autoref{tab:fft_dipole_nest_z} for the
        $z$-direction.
        Note that we've set a threshold for the minimum height of the peaks to
        $\num{5e-6}$ to avoid some noisy signals.\footnote{%
            This value was chosen by trial and error where we've inspected the
            figures --especially for the $z$-direction -- in
            \autoref{fig:fft_dipole_nest} to see that all peaks are in the
            results at the approximate correct location.
        }

        \begin{table}
            \centering
            \caption{Transition energies from peaks in Fourier specter of the
            dipole moment of \ch{LiH} in the $x$-direction as seen in the top
            palette of \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                TDHF & $1$ & $0.1892$ & $5.1491$ \\
                & $2$ & $0.3231$ & $8.7912$ \\
                TDCCSD & $1$ & $0.1600$ & $4.3537$ \\
                & $2$ & $0.2969$ & $8.0795$ \\
                OATDCCD & $1$ & $0.1600$ & $4.3537$ \\
                & $2$ & $0.2969$ & $8.0795$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_x}
        \end{table}

        \begin{table}
            \centering
            \caption{Transition energies from the peaks in the Fourier specter
            of the dipole moment of \ch{LiH} in the $z$-direction as seen in the
            bottom palette of \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                TDHF & $1$ & $0.1492$ & $4.0607$ \\
                & $2$ & $0.2785$ & $7.5772$ \\
                & $3$ & $0.4277$ & $11.6379$ \\
                TDCCSD & $1$ & $0.1215$ & $3.3072$ \\
                & $2$ & $0.2615$ & $7.1167$ \\
                & $3$ & $0.3061$ & $8.3307$ \\
                & $4$ & $0.4108$ & $11.1774$ \\
                OATDCCD & $1$ & $0.1215$ & $3.3072$ \\
                & $2$ & $0.2615$ & $7.1167$ \\
                & $3$ & $0.3061$ & $8.3307$ \\
                & $4$ & $0.4108$ & $11.1774$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_z}
        \end{table}

        For the sake of comparison we have also used CISD to compute the excited
        energy levels.
        By subtracting the ground state energy from each excited energy level we
        find the transition energies and are able to compare with the results in
        \autoref{tab:fft_dipole_nest_x} and \autoref{tab:fft_dipole_nest_z}.
        However, this will include all transition energies, even those that are
        beyond the dipole allowed transitions.
        We therefore wish to filter out all higher order transitions as we are
        only looking for dipole allowed effects.
        Now, the way we verify if a transition is an allowed dipole transition
        once we have the spectrum $(\energy_K, \Psi_K)$ from the
        CISD-Hamiltonian, is to compute a sort of ``transition one-body density
        matrix'' defined as
        % TODO: Is there a name for this quantity?
        \begin{align}
            (\densityten_{IJ})^{q}_{p}
            \equiv \mel*{\Psi_I}{
                \ccr{p}
                \can{q}
            }{\Psi_J}
            = C^{*}_{KI} C_{LJ}
            \mel*{\slat_{K}}{
                \ccr{p}
                \can{q}
            }{\slat_L},
        \end{align}
        where the name stems from the fact that we can reuse the one-body
        density matrix routine, but now with two different coefficient vectors
        $\vfg{C}_I$ and $\vfg{C}_J$.
        To verify if an energy transition between two states $\Psi_I$ and
        $\Psi_J$ are allowed in the dipole approximation we compute
        \begin{align}
            \vfg{d}^{p}_{q} (\densityten_{IJ})^{q}_{p}
            > \vfg{0},
        \end{align}
        where a non-zero -- or, numerically non-zero -- value means that the
        transition is allowed along the axis that has a non-zero value.
        Using these techniques to located allowed transitions, we map the
        lowest lying allowed dipole transitions for the \ch{LiH}-molecule using
        CISD in the restricted Hartree-Fock basis in
        \autoref{tab:dipole_transition_cisd}.
        \begin{table}
            \centering
            \caption{Here we see the allowed dipole transitions from the ground
            state $I = 0$ to a higher excited state $J$.
            We've only included results from the first $40$ states in the
            spectrum from the CISD-Hamiltonian.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Transition & Direction
                &$\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                $0 \to 4$ & $z$ & $0.1218$ & $3.3138$ \\
                $0 \to 11$ & $x$, $y$ & $0.1595$ & $4.3398$ \\
                $0 \to 12$ & $x$, $y$ & $0.1595$ & $4.3398$ \\
                $0 \to 16$ & $z$ & $0.2613$ & $7.1108$ \\
                $0 \to 23$ & $x$, $y$ & $0.2970$ & $8.0814$ \\
                $0 \to 24$ & $x$, $y$ & $0.2970$ & $8.0814$ \\
                $0 \to 28$ & $z$ & $0.3060$ & $8.3275$ \\
                $0 \to 32$ & $z$ & $0.4115$ & $11.1974$ \\
                $0 \to 33$ & $z$ & $0.5310$ & $14.4485$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole_transition_cisd}
        \end{table}
        Comparing the results from \autoref{tab:fft_dipole_nest_x} and
        \autoref{tab:fft_dipole_nest_z} with the results from CISD in
        \autoref{tab:dipole_transition_cisd} we see that TDCCSD and OATDCCD are
        in excellent agreement with the transition energies from the spectrum of
        the CISD-Hamiltonian.
        However, there are small discrepancies which we expect as all three
        methods approximate the four-particle system of \ch{LiH}-molecule with
        at most two-particle excitation operators.
        We also see that OATDCCD and TDCCSD yields exactly the same dipole
        transition energies within the precision that we've kept for these
        results.
        It is a little hard to determine if the coupled-cluster methods perform
        better than CISD as the energies are simultaneously higher and lower at
        different energy levels.
        Furthermore, the converged ground state correlation energy for all three
        methods is
        \begin{align}
            \energy_0 = \SI{-8.9772}{\hartree},
        \end{align}
        for the given precision for the coupled-cluster methods.
        The methods therefore seemingly perform just as well on the
        \ch{LiH}-system.
        We see that we are able to achieve a lower ground state energy than
        \citeauthor{nest}.

        However, there is no doubt that TDHF is quite far off in terms of the
        dipole transition energies when loooking at
        \autoref{tab:fft_dipole_nest_x} and \autoref{tab:fft_dipole_nest_z}.


    \section{Spectra of noble gasses}
        Before moving on to more exotic systems we wish to demonstrate one of
        the main goals in this thesis, and that is to prove that the implemented
        methods are able to explore larger systes than what can achieved with
        the full configuration interaction method.
        We therefore wish to demonstrate some simulations for the \ch{Ne}- and
        \ch{Ar}-atom in exactly the same laser field as in the study done by
        \citeauthor{nest} \cite{nest} shown in \autoref{eq:nest-laser}, but with
        a higher frequency.
        We have chosen a frequency $\omega$ corresponding to a laser wave length
        of $\lambda = \SI{200}{\nm}$ and let the envelope last for a full cycle,
        that is, $T = 2\pi / \omega$.
        We've chosen this frequency as this lets us simulate a full cycle of the
        laser in a relatively short time, thus letting the atoms oscillate for a
        long time after the laser is turned off.
        \begin{table}
            \centering
            \caption{Ground states}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Atom
                & $\energy$ $[\si{\hartree}]$
                & $\energy$ $[\si{\electronvolt}]$ \\
                \midrule
                cc-pVDZ & OATDCCD & \ch{Ne}
                & $\SI{-128.6796}{\hartree}$
                & \\
                & TDCCSD & \ch{Ne}
                & $\SI{-128.6796}{\hartree}$
                & \\
                aug-cc-pVDZ & OATDCCD & \ch{Ne}
                & $\SI{-128.7082}{\hartree}$
                &
                \\
                & TDCCSD & \ch{Ne}
                & $\SI{-128.7085}{\hartree}$
                &
                \\
                \bottomrule
            \end{tabular}
            \label{tab:gs-noble-gasses}
        \end{table}

        \begin{table}
            \centering
            \caption{Dipole transitions for \ch{Ne} in cc-pVDZ basis.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak $[n]$
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                TDCCSD & $1$ & $2.3116$ & $62.9005$ \\
                & $2$ & $2.8879$ & $78.5830$ \\
                & $3$ & $5.7507$ & $156.4842$ \\
                OATDCCD & $1$ & $2.3087$ & $62.8237$ \\
                & $2$ & $2.8890$ & $78.6130$ \\
                & $3$ & $5.7412$ & $156.2261$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole-ne-cc-pvdz}
        \end{table}

        \begin{table}
            \centering
            \caption{Dipole transitions for \ch{Ne} in aug-cc-pVDZ basis.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak $[n]$
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                OATDCCD & $1$ & $0.7141$ & $19.4327$ \\
                & $2$ & $2.1863$ & $59.4913$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole-ne-aug-cc-pvdz}
        \end{table}

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=6cm,
                    title={Absorption spectra of Neon},
                    xlabel={Excitation energy $[\si{\hartree}]$},
                    grid=major,
                    ylabel={Intensity},
                    enlarge x limits=false,
                    xmax=6,
                ]
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ne_ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{cc-pVDZ}
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ne_aug-ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{aug-cc-pVDZ}
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we've plotted the absorption spectra of the
            \ch{Ne}-atom in two different basis sets using the OATDCCD-method.
            The results achieved from the TDCCSD-method are indistinguishable by
            eye.
            The peaks for the cc-pVDZ basis are listed in
            \autoref{tab:dipole-ne-cc-pvdz} and in
            \autoref{tab:dipole-ne-aug-cc-pvdz} for the aug-cc-pVDZ basis.}
            \label{fig:ne-spectra}
        \end{figure}

        \begin{table}
            \centering
            \caption{Dipole transitions for \ch{Ar} in cc-pVDZ and aug-cc-pVDZ
            basis using the OATDCCD-method.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Basis & Peak $[n]$
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                cc-pVDZ & $1$ & $1.1118$ & $30.2549$ \\
                & $2$ & $1.4746$ & $40.1254$ \\
                & $3$ & $1.6323$ & $44.4168$ \\
                aug-cc-pVDZ & $1$ & $0.4677$ & $12.7275$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole-ar-cc-pvdz}
        \end{table}

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=6cm,
                    title={Absorption spectra of Argon},
                    xlabel={Excitation energy $[\si{\hartree}]$},
                    grid=major,
                    ylabel={Intensity},
                    enlarge x limits=false,
                    xmax=3,
                ]
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ar_ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{cc-pVDZ}
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ar_aug-ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{aug-cc-pVDZ}
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we've plotted the absorption spectra of the
            \ch{Ar}-atom in two different basis sets using the OATDCCD-method.}
            \label{fig:ar-spectra}
        \end{figure}

    \section{Spin-dependent laser pulses}
        We have so far demonstrated that our implemented methods reproduce known
        results from the litterature on a wide range of systems.
        Furthermore, we've demonstrated that we can run large simulations and
        have presented new results for the \ch{Ar}-atom.
        However, we now wish to demonstrate that our implemented methods are
        able to simulate more exotic systems with \emph{spin-dependence}.

        In a study by \citeauthor{isborn} \cite{isborn}, the authors explored a
        spin-dependent laser field to see singlet-triplet transitions which are
        invisible to a spin-symmetric field.
        % TODO: Is this why?
        This study is performed using the time-dependent unrestricted
        Hartree-Fock (TDUHF) method and time-dependent density functional theory.
        We've yet to implement a TDUHF-method and will therefore use regular
        TDHF with general spin-orbitals and the OATDCCD-method.
        We shall see that the former will experience spin-contamination and
        break down when we include spin-dependency in the laser field.

        The laser pulse used by \citeauthor{isborn} is given by
        \begin{align}
            \vfg{E}(t)
            = E_m \vfg{\epsilon} \sine(\omega t),
        \end{align}
        where we polarize in the negative $z$-direction to correct for charge of
        the electrons.
        The field is active for $t \in [0, T]$ with $T = 6\pi / \omega$, i.e.,
        the field is active for three cycles.
        The frequency is set to $\omega = \SI{0.06}{\hartree/\hslash}$, the
        integration time step to $\Delta t = \SI{0.002}{\fs}$ with the
        simulation run for a total of $\SI{50}{\fs}$.
        We simulate the three molecules \ch{H2}, \ch{LiH}, and \ch{CO} with the
        two basis sets STO-3G and 6-31G**.
        The laser field strength for \ch{H2} was set to $E_m = \num{0.1}$, and
        for \ch{LiH} and \ch{CO} to $E_m = \num{0.01}$.
        For \ch{CO} we had to lower the time step to $\Delta t =
        \SI{0.01}{\hslash/\hartree}$ for the simulation to run for both basis
        sets.
        Furthermore, due to a hickup in the (self-made) caching scheme used on
        the Abel compute cluster led to the seven days long run for \ch{CO} in
        the 6-31G** basis using OATDCCD to get deleted.
        Thus, our results for \ch{CO} will only be in the smaller STO-3G basis
        set.
        A frutstrating fact in the article by \citeauthor{isborn} is that the
        bonding length of the molecules used are not reported.
        We therefore guess that \citeauthor{isborn} used the equilibrium
        bond-lengths in the $z$-direction for all three molecules.
        These are listed in \autoref{tab:bond-length-isborn}.
        \begin{table}
            \centering
            \caption{Equilibrium bond lengths for diatomic molecules used in the
            study on spin-dependent laser fields \cite{bond-lengths}.
            Note that the values for \ch{LiH} are reused from the study by
            \citeauthor{nest} \cite{nest}, and converted to $\si{\pm}$ for the
            sake of completeness.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Molecule & $R_e$ $[\si{\pm}]$ & $R_e$ $[\si{\bohr}]$ \\
                \midrule
                \ch{H2} & $74$ & $1.40$ \\
                \ch{LiH} & $163$ & $3.08$ \\
                \ch{CO} & $143$ & $2.70$ \\
                \bottomrule
            \end{tabular}
            \label{tab:bond-length-isborn}
        \end{table}
        To included the spin-dependency in the electric fields we have chosen a
        solution where we set the dipole moment matrix elements corresponding to
        a specific spin-direction to zero and leave the other spin-direction as
        it is.
        A demonstration of the dipole matrix elements of the \ch{H2} molecule in
        the 6-31G** basis is shown in \autoref{fig:dipole-matrices}.
        By using the matrix elements on the right in
        \autoref{fig:dipole-matrices} we effectively use a spin-dependent laser
        field applied to all spins in the up-direction.\footnote{%
            Note that which indices correspond to ``up'' or ``down'' is
            completely arbitrary, we just need a name for the odd and even
            indices.
        }
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \pgfplotsset{small}
                \begin{groupplot}[
                    group style={
                        group size=2 by 1,
                    },
                    width=0.5\textwidth,
                    height=0.5\textwidth,
                ]
                    \nextgroupplot[
                        view={0}{90},
                        colormap/viridis,
                        colorbar horizontal,
                        colorbar style={
                            at={
                                (0, 1.2),
                                anchor=south west,
                            },
                        },
                        title={Spin-independent},
                        title style={yshift=5ex},
                    ]
                        \addplot[
                            matrix plot*,
                            mesh/rows=20,
                            point meta=explicit,
                        ]
                        file[meta=index 2]
                        {results/benchmarks/isborn/dat/h2_6-31gss_dip_mat_both.dat};
                    \nextgroupplot[
                        view={0}{90},
                        colormap/viridis,
                        colorbar horizontal,
                        colorbar style={
                            at={
                                (0, 1.2),
                                anchor=north west,
                            },
                        },
                        title={Spin-dependent},
                        title style={yshift=5ex},
                    ]
                        \addplot[
                            matrix plot*,
                            mesh/rows=20,
                            point meta=explicit,
                        ]
                        file[meta=index 2]
                        {results/benchmarks/isborn/dat/h2_6-31gss_dip_mat_up.dat};
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we've plotted the dipole matrix elements along
            $z$-direction, that is, $z^{p}_{q}$, for \ch{H2} in the 6-31G**
            basis.
            The image on the left is of the full dipole matrix elements whereas
            the image on the left shows the same matrix elements, but with all
            odd indices set to zero which means that we are left with the dipole
            matrix elements for the spin-up direction.
            Note that we've scaled the values to be between $0$ and $1$.}
            \label{fig:dipole-matrices}
        \end{figure}

        In \autoref{fig:h2-isborn} we have plotted the absorption spectra of
        \ch{H2} using both basis sets and both TDHF and OATDCCD.
        We've also included absorption spectra using a spin-dependent field as
        the dashed lines in \autoref{fig:h2-isborn}.
        As expected from the study done by \citeauthor{isborn} we see that the
        spin-dependency adds an extra peak at a lower energy level than the
        first allowed dipole transition.
        This is the first singlet to triplet allowed dipole transition in
        \ch{H2}.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        title={Absorption spectra of \ch{H2} (STO-3G)},
                        grid=major,
                        ylabel={Intensity},
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}

                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{H2} (6-31G**)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we've plotted the absorption spectra of
            \ch{H2} subject to a laser field using the TDHF (HF) and the OATDCCD
            (OA) methods.
            The label ``up'' denotes a spin-dependent field along one of the
            spin-functions.
            No extra label means that the field is spin-indepdenent.}
            \label{fig:h2-isborn}
        \end{figure}
        In \autoref{tab:h2-isborn} we've listed the transition energies found
        from the peaks in \autoref{fig:h2-isborn}.
        \begin{table}
            \centering
            \caption{Dipole transition energy levels for the \ch{H2}-molecule in
            both the STO-3G and the 6-31G** basis sets using TDHF and OATDCCD.
            These results are found from the peaks in \autoref{fig:h2-isborn}.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                STO-3G & TDHF & no & $0.5574$ & $15.1687$ \\
                & & yes & $0.9315$ & $25.3464$ \\
                & OATDCCD& no & $0.6078$ & $16.5395$ \\
                & & yes & $0.9675$ & $26.3262$ \\
                6-31G** & TDHF & no & $0.3632$ & $9.8841$ \\
                & & yes & $0.5466$ & $14.8751$ \\
                & OATDCCD & no & $0.4028$ & $10.9611$ \\
                & & yes & $0.5539$ & $15.0715$ \\
                \bottomrule
            \end{tabular}
            \label{tab:h2-isborn}
        \end{table}
        For the \ch{H2}-molecule we can use CISD to compute the entire spectrum
        and locate the allowed dipole transitions using the same technique as
        discussed in \autoref{sec:nest}.
        Furthermore, using the spin-reduced dipole matrix elements we should
        locate the allowed singlet-triplet transitions.
        In \autoref{tab:h2-isborn-transitions} we've listed all allowed
        dipole transitions in both basis sets for \ch{H2}.
        We've denoted singlet allowed transitions -- where it is understood that
        the same transition is allowed in the spin-dependent case as well --
        specifically to demonstrate which peaks we expect to see for the singlet
        only transitions.
        \begin{table}
            \centering
            \caption{Dipole allowed transitions for \ch{H2} in both basis sets
            computed using CISD.
            The transition is from the ground state $I = 0$ to a higher excited
            state $J$.
            We've limited the transition energies to $\Delta \energy \leq
            \SI{1}{\hartree}$ for the 6-31G** basis.
            Spin-independent transitions, i.e., singlet-to-singlet transitions,
            are denoted with a ``yes'' under the column ``Singlet allowed''.
            These transitions are also allowed in the spin-dependent case.}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Transition & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                STO-3G & $0 \to 1$ & no & $0.6065$ & $16.5040$ \\
                & $0 \to 3$ & no & $0.6065$ & $16.5040$ \\
                & $0 \to 4$ & yes & $0.9689$ & $26.3660$ \\
                6-31G** & $0 \to 1$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 2$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 3$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 4$ & yes & $0.5523$ & $15.0277$ \\
                \bottomrule
            \end{tabular}
            \label{tab:h2-isborn-transitions}
        \end{table}
        Comparing \autoref{tab:h2-isborn-transitions} with the results in
        \autoref{tab:h2-isborn} we are able to locate the energy transitions in the
        results from OATDCCD.
        We note that the energies are not exactly the same -- even though both
        CISD and OATDCCD are formally exact within the given basis for $N = 2$
        particles -- but as the methods for discovering these energy transitions
        are so vastly different we conclude that these energies are the same.
        Comparing with the results from \citeauthor{isborn} we see that TDHF is
        close to their results using TDUHF.
        However, we conjecture that the discrepancies are mainly a result of
        \citeauthor{isborn} using the presumably more stable TDUHF method for
        these kind of simulations.
        We also note that our results using the more exact methods OATDCCD and
        CISD are higher than the results achieved from TDHF.
        It seems that both TDHF and TDUHF predicts a lower transition energy
        than what is correct.

        From \autoref{tab:h2-isborn-transitions} we see that the degenerate
        transitions in the STO-3G basis $0 \to 1$ and $0 \to 3$ are triplet-only
        allowed transitions, but the interesting thing is that the transition $0
        \to 2$ is also a transition with the same energy level.
        However, the latter transition is \emph{not} a dipole-allowed triplet
        transition.
        In the 6-31G** basis the triplet transitions opens up for all
        transitions up to the fourth excited state within the energy levels we
        explore.


        Repeating the same exercise for the \ch{LiH}-system we have the
        absorption spectra for both the spin-dependent and spin-independent
        fields in the STO-3G and the 6-31G** basis sets in
        \autoref{fig:lih-isborn}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{LiH} (STO-3G)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                        xmax=0.25,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}


                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{LiH} (6-31G**)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                        xmax=0.25,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we've plotted the absorption spectra of
            \ch{LiH} subject to a laser field using the TDHF (HF) and the OATDCCD
            (OA) methods.
            The label ``up'' denotes a spin-dependent field along one of the
            spin-functions.
            No extra label means that the field is spin-indepdenent.}
            \label{fig:lih-isborn}
        \end{figure}
        We see that the signal from these simulations are rather noisy.
        Especially for the spin-dependent field.
        Tabulating the values in \autoref{fig:lih-isborn} we get the results
        shown in \autoref{tab:lih-isborn}.
        We've set the thresholds for the peaks to include all the visual peaks
        in \autoref{fig:lih-isborn}.
        \begin{table}
            \centering
            \caption{Dipole transition energy levels for the \ch{LiH}-molecule in
            both the STO-3G and the 6-31G** basis sets using TDHF and OATDCCD.
            These results are found from the peaks in \autoref{fig:lih-isborn}.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                STO-3G & TDHF & no & $0.0468^{\diamond}$ & $1.2722$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & yes & $0.1618$ & $4.4038$ \\
                & OATDCCD & no & $0.0180^{\diamond}$ & $0.4893$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & no & $0.1295^{\dagger}$ & $3.5231$ \\
                & & yes & $0.1331$ & $3.6210$ \\
                6-31** & TDHF & no & $0.0324^{\ddagger}$ & $0.8808$ \\
                & & no & $0.0432^{\ddagger}$ & $1.1743$ \\
                & & no & $0.0503^{\ddagger}$ & $1.3701$ \\
                & & no & $0.0575^{\ddagger}$ & $1.5658$ \\
                & & no & $0.0755^{\ddagger}$ & $2.0551$ \\
                & & no & $0.0935^{\ddagger}$ & $2.5444$ \\
                & & no & $0.1043^{\ddagger}$ & $2.8380$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & yes & $0.1510$ & $4.1102$ \\
                & & no & $0.3488^{\ddagger}$ & $9.4927$ \\
                & & no & $0.4280^{\ddagger}$ & $11.6456$ \\
                & OATDCCD & no & $0.0144^{\diamond}$ & $0.3915$ \\
                & & no & $0.1115$ & $3.0339$ \\
                & & yes & $0.1259$ & $3.4253$ \\
                \bottomrule
            \end{tabular}
            \label{tab:lih-isborn}
        \end{table}
        Unlike the \ch{H2}-molecule we see that the values in
        \autoref{tab:lih-isborn} contain significantly more noise.
        Looking at the transition in \autoref{tab:lih-isborn} denoted with a
        $\dagger$ we've left it as it is, but we conjecture that it should
        really be the singlet-allowed transition listed below as the peaks in
        the upper palette of \autoref{fig:lih-isborn} show that the two peaks
        coincide, but due to few samples they become a little noisy and thus do
        not overlap perfectly.
        The values for TDHF in \autoref{tab:lih-isborn} denoted with a
        $\ddagger$ are clearly noise.
        Furthermore, comparing with \citeauthor{isborn} \cite{isborn} we see
        that only the two values that are not denoted with a $\ddagger$ are the
        actual dipole transition energies we should see.
        However, they are so weak that they occur below the noise and would not
        have been discovered unless we knew what we were looking for.
        This demonstrates that the TDHF-method is unable to describe the
        spin-dependent field.
        We conjecture that this has to do with \emph{spin-contamination} where
        the lack of a spin-restriction on the molecular orbitals yield a linear
        combination of combined spin-directions.
        This suddenly means that the dipole matrix elements are no longer acting
        on a clear spin-direction.
        As \citeauthor{isborn} \cite{isborn} were able to get better
        measurements we believe that the usage of a TDUHF-method would recover
        the desired results.
        This would be an interesting study to explore, but we've not had the
        time to implement the TDUHF-method and the analysis will have to be
        saved for another day!

        Computing the dipole allowed transitions using the CISD-method we get
        the results shown in \autoref{tab:lih-isborn-transitions}.
        The TDHF results in \autoref{tab:lih-isborn} that are not marked as
        noise compare well with the results from \citeauthor{isborn}
        \cite{isborn} whereas the OATDCCD results are comparable to the results
        from CISD in \autoref{tab:lih-isborn-transitions}.
        However, they are not the same and we expect the results from OATDCCD to
        be more correct as they stem from a method that includes more
        correlation.
        \begin{table}
            \centering
            \caption{Dipole allowed transitions for \ch{LiH} in both basis sets
            computed using CISD.
            We use the notation $[J - K]$ to denote a range of excited states.
            We only include results for $\Delta \energy \leq
            \SI{0.25}{\hartree}$.}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Transition & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                STO-3G & $0 \to [1-3]$ & no & $0.1138$ & $3.0959$ \\
                & $0 \to 4$ & yes & $0.1313$ & $3.5741$ \\
                6-31G** & $0 \to [1-3]$ & no & $0.1099$ & $2.9894$ \\
                & $0 \to 4$ & yes & $0.1259$ & $3.4261$ \\
                & $0 \to [13-15]$ & no & $0.2222$ & $6.0468$ \\
                \bottomrule
            \end{tabular}
            \label{tab:lih-isborn-transitions}
        \end{table}
        % TODO: Add CO maybe?
        % TODO: See if the lowest transition is between two excited states.

        The inclusion of a spin-dependent laser field demonstrates that we are
        able to take a step further and include magnetic fields with spin-orbit
        coupling in future work.
        In \citeauthor{greg-winther}'s work, a demonstration of an orbital
        angular magnetic field is showcased \cite{greg-winther}, but we wish in the future to
        include the spin-dependence as well.

    \section{Ionization of one-dimensional atoms}
        The process of modelling ionization of electrons in atoms and
        molecules is a tricky subject, particularly in our regime.
        That is because we are forcing our systems to be bound by simulating a
        restricted space and requiring that all particles be contained inside
        the simulation box.
        As a consequence, ionization has to be inferred in some way or another.
        e.g., an absorbing potential with a time-dependent atomic orbital basis
        on a grid \cite{kosloff1986363, miyagi_and_madsen, takeshi}.
        However, in our formalism we use static atomic orbitals which we
        force to zero at the boundaries of the simulation box.
        This makes the use of an absorbing potential useless and ionization
        must be inferred in some other way.

        In a study done by \citeauthor{miyagi_and_madsen}
        \cite{miyagi_and_madsen} they explored the dynamics of one-dimensional
        atoms subject to a dipole laser.
        This study provides us with an excellent benchmark to observe a form
        of ionization and see if this is reproducible in our formalism.
        Note that \citeauthor{miyagi_and_madsen} used a
        discrete-variable-representation basis (DVR) which is why they include
        an absorbing potential.
        Our solution differs from this as we use the static one-dimensional
        quantum dot basis with a one-dimensional atom potential.
        In a position basis with Hartree atomic units, the one-body
        Hamiltonian is given by \cite{miyagi_and_madsen}
        \begin{align}
            \oneten(x, t)
            &= -\half \dod[2]{}{x}
            - \frac{Z}{\sqrt{x^2 + 1}}
            + xF(t)
            - iW(x),
        \end{align}
        where $Z = N_e$, that is, the number of electrons in the system,
        $W(x)$ is the absorbing potential, which we'll set to zero.
        The second term gives rise to the naming of these systems as
        one-dimensional atoms as this term serves as the electron-nuclear
        interaction in the atomic Hamiltonian, but with the three-dimensional
        position replaced with $x$.
        One of the interesting aspects of the one-dimensional atoms is that many
        open-shell systems such as \ch{C} gets closed shells in the
        one-dimensional case.
        We will however, limit our study to the one-dimensional Beryllium
        system with $N = 4$ electrons in a closed shell.

        The laser pulse $F(t)$ is given by \cite{miyagi_and_madsen}
        \begin{align}
            F(t)
            &= -\dod[]{A(t)}{t}
            = -\dod[]{}{t}\brak{
                \frac{F_0}{\omega}
                \sin^2\para{\frac{\pi t}{T}}
                \sin(\omega t)
            }
            \\
            &=
            -\sin\para{\frac{\pi t}{T}}\brak{
                \omega \sin\para{\frac{\pi t}{T}}
                \cos(\omega t)
                + \frac{2\pi}{T}
                \cos\para{\frac{\pi t}{T}}
                \sin(\omega t)
            }.
            \label{eq:miyagi-laser}
        \end{align}
        where this field is active for $t \in [0, T]$.
        A plot of the laser pulse during the simulation is shown in
        \autoref{fig:miyagi-laser}.
        The Coulomb interaction is given by \autoref{eq:shield-coulomb} with a
        shielding parameter of $a = 1$ and $\alpha = 1$.
        To compare with the study by \citeauthor{miyagi_and_madsen} we will run
        for $T = \SI{331}{\hslash/\hartree}$ with $\Delta t =
        \SI{1e-2}{\hslash/\hartree}$ which corresponds to $n_t = 33100$
        time steps.
        This computation is rather involved and we will therefore limit
        ourselves to the time-dependent Hartree-Fock method and the
        orbital-adaptive time-dependent coupled cluster method as the
        full-configuration interaction method becomes quite expensive.
        In fact, for $n = 4$ and $l = 40$ we have to create a Hamiltonian
        matrix with $91390^2$ elements, each of size $\SI{16}{\text{B}}$ as
        we use complex numbers.
        To solve this system we require a much smarter implementation of the
        configuration interaction method which is out of scope for this
        thesis.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                        width=11cm,
                        height=6cm,
                        xlabel={$t$ $[\text{a.u.}]$},
                        grid=major,
                        ylabel={$F(t)$},
                        enlarge x limits=false,
                        enlarge y limits=false,
                    ]
                    \addplot+ [
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/miyagi_laser.dat};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the laser pulse from
            \autoref{eq:miyagi-laser} for $T = \SI{331}{\text{a.u.}}$,
            $\omega = \SI{0.057}{\text{a.u.}}$, and $F_0 =
            \SI{0.0755}{\text{a.u.}}$ \cite{miyagi_and_madsen}.}
            \label{fig:miyagi-laser}
        \end{figure}


        In order for us to observe actual ionization we need to have a basis
        containing scattered states, that is, states that have an eigenenergy
        above the potential well such that we get a non-zero portion of the wave
        function outside the potential well.
        If the basis set is too small all states will be bound in the atomic
        potential and it is not possible to make a linear combination where
        some parts of the total wave function is outside the potential well
        more than a small tunneling effect.
        In \autoref{fig:spf-potential-miyagi} we see the highest lying
        orbitals we've used in the one-dimensional Beryllium system.
        The plot demonstrates that we need a large basis in order to capture
        scattered states.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=8cm,
                    xlabel={$x$ $[\text{a.u.}]$},
                    ylabel={$E$ $[\text{a.u.}]$},
                    xmin=-100,
                    xmax=100,
                    ymin=-0.25,
                    legend pos=south west,
                    grid=major,
                ]
                    \addplot+[
                        mark=none,
                        dashed,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/miyagi_potential.dat};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=10_sq.dat};
                    \addlegendentry{$\abs{\psi_{10}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=15_sq.dat};
                    \addlegendentry{$\abs{\psi_{15}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=20_sq.dat};
                    \addlegendentry{$\abs{\psi_{20}(x)}^2$};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we've plotted some of the high lying
            single-particle functions squared and scaled by their
            eigenenergy inside the one-dimensional Beryllium potential.
            We've only included a select few single-particle functions to
            avoid the figure being too cluttered.}
            \label{fig:spf-potential-miyagi}
        \end{figure}

        We can see this from \autoref{fig:one-particle-density-miyagi}
        where a basis of $l = 20$ spin-orbitals has been used.
        This basis is not able to capture much of the scattered states and
        looking at the figure for $t = T$ we see that the system is
        relatively confined still.
        We can also see this from \autoref{fig:spf-potential-miyagi} as $l =
        20$ means the highest single-particle function used is
        $\psi_{10}(x)$ which is clearly confined in the potential well.
        However, looking at \autoref{fig:one-particle-density-miyagi-l=40}
        we see the same Beryllium system with a basis set of $l = 40$
        spin-orbitals.
        It is apparent that the system undergoes a larger degree of
        ionization with more of the one-particle density further away from
        the central potential.
        This is also see in \autoref{fig:spf-potential-miyagi} as $l = 40$
        includes the state $\psi_{20}(x)$ which is more dispersed.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have included the one-particle
            density for the initial ground state, after half the simulation
            has been run and for the final state of the one-dimensional
            Beryllium system.
            For these figures we have $l = 20$ spin-orbitals, that is, $l /
            2 = 10$ orbitals.
            The $y$-axis has been truncated at $y = \num{1e-4}$ to avoid
            including noise in the figures.}
            \label{fig:one-particle-density-miyagi}
        \end{figure}


        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{These figures show the same situation as in
            \autoref{fig:one-particle-density-miyagi} but for $l = 40$
            spin-orbitals.
            We have truncated the $y$-axis to $y = \num{1e-4}$ as lower
            values include more noise and provides no more insight.}
            \label{fig:one-particle-density-miyagi-l=40}
        \end{figure}

\chapter{Applications}
    \epigraph{NÃ¥ funker alt!}
    {--- Morten Ledum}

    Having verified that our implementations work on smaller systems in
    \autoref{chap:validation} and demonstrated the strength of the
    orbital-adaptive coupled-cluster methods in \autoref{chap:stability} we now
    seek to push the methods by exploring more complicated systems.
    Our goal is to firmly establish that we are able to explore larger systems
    than can be done with the full configuration interaction method and the
    multi-configuration Hartree-Fock method, while achieving a quality of the
    results beyond what is possible with the mean-field approximation using
    Hartree-Fock.
    Furthermore, we wish to demonstrate the versatility of our methods by
    studying exotic systems such as spin-dependent laser field interactions and
    ionization of the one-dimensional Beryllium-atom.
    Note that we in this chapter do little to no conscious effort in terms of
    optimization as the default setup of the solvers often yield more than good
    enough results.
    This means that we can focus as much as possible on the physics of the
    problems.

    \section{Electronic spectra of molecules}
        \label{sec:nest}
        In an article by \citeauthor{nest} \cite{nest} the
        multiconfiguration time-dependent Hartree-Fock method was tested on
        a system of lithium hydride and methane subject to a dipole
        laser pulse with a sine-squared envelope on the form\footnote{%
            Note that \citeauthor{nest} \cite{nest} does not explicitly add
            a formula for the laser, but based on their description we infer
            the form of the laser.
        }
        \begin{align}
            \vfg{E}(t)
            = -\vfg{\epsilon} E(t)
            \sin[2](\pi t / T)
            = -\vfg{\epsilon} E_0 \sin(\omega t)
            \sin[2](\pi t / T),
            \label{eq:nest-laser}
        \end{align}
        where $\vfg{\epsilon}$ is the polarization vector, $\omega$ is the
        frequency corresponding to a photon energy of $E_{\nu} =
        \SI{5.44}{\electronvolt}$.
        The negative sign in the polarization vector comes from the charge of
        the electrons.
        The laser field is active for $t \in \brak{0, T}$ where $T =
        \SI{1}{\femto\second}$, and the intensity of the laser field is chosen
        to be $I = \SI{3.5e12}{\watt/\cm^2}$.
        The simulation is run for $\SI{100}{\femto\second}$ with a time step
        of\footnote{%
            Note that we specify the time step in atomic units as we convert all
            the SI units to atomic units when doing the simulation.
        }
        $\Delta t = \SI{1e-2}{\hslash/\hartree}$ using the Gauss-integrator with
        $s = 3$ and $\epsilon = \num{1e-6}$.
        A word of caution, when reproducing the results in this article some
        care must be taken when converting to atomic units for the frequency,
        time, and the intensity of the laser as it is not clear how much one
        should round the numbers.
        We have used the Python library \citetitle{pint} \cite{pint} to
        convert from SI units to atomic units as they stand in the text
        without any rounding.
        These conversions are summarized in \autoref{tab:nest-conversions}.
        \begin{table}
            \centering
            \caption{In this table we show the conversions used to move from
            the SI units given in the article by \citeauthor{nest}
            \cite{nest} to the atomic units used in the simulation.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Quantity & SI units & Atomic units \\
                \midrule
                $E_{\nu}$ & $\SI{5.44}{\electronvolt}$ &
                \SI{1.999163e-1}{\hartree} \\
                $I$ & $\SI{3.5e12}{\watt/\cm^{2}}$ &
                \SI{9.973085e-5}{I_a} \\
                $t$ & $\SI{1}{\femto\second}$ &
                \SI{4.134137e+1}{\hslash/\hartree}
                \\
                \bottomrule
            \end{tabular}
            \label{tab:nest-conversions}
        \end{table}
        The corresponding frequency in atomic units of the laser specified by
        the photon energy $E_{\nu}$ in \autoref{tab:nest-conversions} is $\omega
        = \SI{1.999163e-1}{\hartree/\hslash}$.
        The electric field strength from the intensity is found to be $E =
        \SI{9.986533e-4}{\hartree/(\elementarycharge \bohr)}$.

        We repeat the study for the \ch{LiH} molecule as done by
        \citeauthor{nest} \cite{nest}.
        We use a bond-length of $\SI{3.08}{\bohr}$ in the $z$-direction
        between the lithium and the hydrogen atoms with the basis 6-31G*.
        To specify this basis in PySCF we pass in the string \pyth{"6-31Gs"}.
        We use the TDHF, TDCCSD, and the OATDCCD solvers in this study and we
        sample the dipole moment for each method.
        Computing the Fourier transform of the dipole moment after the laser is
        turned off yields the absorption spectra of \ch{LiH}.
        We run two simulations; one where we polarize the laser along the
        $z$-direction and measure along the same axis, and another simulation
        where we do the same in the $x$-direction.

        In \autoref{fig:fft_dipole_nest} we have included the Fourier
        transform of the sampled dipole moment in $x$- and $z$-direction in
        time, respectively.
        These plots show the absorption spectra for the \ch{LiH} molecule.
        For the $z$-direction it is important to note that the \ch{LiH} molecule
        with the bonding set in the $z$-direction has a non-zero dipole moment.
        This makes the absorption spectra include a constant zero frequency
        component.
        We have removed this component from the figures by using the function
        \pyth{scipy.signal.detrend} \cite{scipy}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                    xticklabel style={
                        /pgf/number format/fixed,
                        /pgf/number format/precision=2,
                    },
                ]
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{x(t)}}$},
                        grid=major,
                        ylabel={Intensity},
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{z(t)}}$},
                        ylabel={Intensity},
                        grid=major,
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we show the Fourier transform of the
            dipole moment in $x$-and $y$-direction of the \ch{LiH} molecule
            using time-dependent Hartree-Fock, time-dependent coupled-cluster
            with singles and doubles, orbital-adaptive time-dependent coupled
            cluster with doubles excitations.
            The top figure shows the results in $x$-direction and the lower
            in $z$-direction.}
            \label{fig:fft_dipole_nest}
        \end{figure}
        In \autoref{tab:fft_dipole_nest_x} we have used the function
        \pyth{scipy.signal.find_peaks} \cite{scipy} to locate the transition
        energies for the Fourier specter of the dipole moment polarized along
        the $x$-direction.
        We have done the same in \autoref{tab:fft_dipole_nest_z} for the
        $z$-direction.
        Note that we have set a threshold for the minimum height of the peaks to
        $\num{5e-3}$ to avoid some noisy signals.\footnote{%
            This value was chosen by trial and error where we inspected the
            figures --especially for the $z$-direction -- in
            \autoref{fig:fft_dipole_nest} to see that all peaks are in the
            results at the approximate correct location.
        }

        \begin{table}
            \centering
            \caption{Transition energies from peaks in Fourier specter of the
            dipole moment of \ch{LiH} in the $x$-direction as seen in the top
            palette of \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                TDHF & $1$ & $0.1892$ & $5.1491$ \\
                & $2$ & $0.3231$ & $8.7912$ \\
                TDCCSD & $1$ & $0.1600$ & $4.3537$ \\
                & $2$ & $0.2969$ & $8.0795$ \\
                OATDCCD & $1$ & $0.1600$ & $4.3537$ \\
                & $2$ & $0.2969$ & $8.0795$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_x}
        \end{table}

        \begin{table}
            \centering
            \caption{Transition energies from the peaks in the Fourier specter
            of the dipole moment of \ch{LiH} in the $z$-direction as seen in the
            bottom palette of \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                TDHF & $1$ & $0.1492$ & $4.0607$ \\
                & $2$ & $0.2785$ & $7.5772$ \\
                & $3$ & $0.3308$ & $9.0005$ \\
                & $4$ & $0.4277$ & $11.6379$ \\
                TDCCSD & $1$ & $0.1215$ & $3.3072$ \\
                & $2$ & $0.2615$ & $7.1167$ \\
                & $3$ & $0.3061$ & $8.3307$ \\
                & $4$ & $0.4108$ & $11.1774$ \\
                OATDCCD & $1$ & $0.1215$ & $3.3072$ \\
                & $2$ & $0.2615$ & $7.1167$ \\
                & $3$ & $0.3061$ & $8.3307$ \\
                & $4$ & $0.4108$ & $11.1774$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_z}
        \end{table}

        For the sake of comparison we have also used CISD to compute the excited
        energy levels.
        By subtracting the ground state energy from each excited energy level we
        find the transition energies from the ground state to a higher state,
        and we are able to compare with the results in
        \autoref{tab:fft_dipole_nest_x} and \autoref{tab:fft_dipole_nest_z}.
        However, this will include all transition energies, even those that are
        beyond the dipole allowed transitions.
        We therefore wish to filter out all higher-order transitions as we are
        only looking for dipole allowed effects.
        Now, the way we verify if a transition is an allowed dipole
        transition\footnote{%
            Within the CISD-approximation.
        }
        once we have the spectrum $(\energy_K, \Psi_K)$ from the
        CISD-Hamiltonian, is to compute a transition one-body density matrix
        defined as
        \begin{align}
            (\densityten_{IJ})^{q}_{p}
            \equiv \mel*{\Psi_I}{
                \ccr{p}
                \can{q}
            }{\Psi_J}
            = C^{*}_{KI} C_{LJ}
            \mel*{\slat_{K}}{
                \ccr{p}
                \can{q}
            }{\slat_L},
        \end{align}
        where the name stems from the fact that we can reuse the one-body
        density matrix routine, but now with two different coefficient vectors
        $\vfg{C}_I$ and $\vfg{C}_J$.
        To verify if an energy transition between two states $\Psi_I$ and
        $\Psi_J$ are allowed in the dipole approximation we compute
        \begin{align}
            \abs{\vfg{d}^{p}_{q} (\densityten_{IJ})^{q}_{p}}
            > \vfg{0},
            \label{eq:dipole-transition-cisd}
        \end{align}
        where a non-zero -- or, numerically non-zero -- value means that the
        transition is allowed along the axis that has a non-zero value.
        Note that the absolute value in \autoref{eq:dipole-transition-cisd}
        should be interpreted as an elementwise absolute value for each spatial
        component in $\vfg{d}^{p}_{q}$.
        Using these techniques to locate allowed transitions, we map the
        lowest lying allowed dipole transitions for the \ch{LiH} molecule using
        CISD in the restricted Hartree-Fock basis in
        \autoref{tab:dipole_transition_cisd}.
        \begin{table}
            \centering
            \caption{Here we see the allowed dipole transitions from the ground
            state $I = 0$ to a higher excited state $J$.
            We have only included results from the first $40$ states in the
            spectrum from the CISD-Hamiltonian.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}llll@{}}
                \toprule
                Transition & Direction
                &$\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                $0 \to 4$ & $z$ & $0.1218$ & $3.3138$ \\
                $0 \to 11$ & $x$, $y$ & $0.1595$ & $4.3398$ \\
                $0 \to 12$ & $x$, $y$ & $0.1595$ & $4.3398$ \\
                $0 \to 16$ & $z$ & $0.2613$ & $7.1108$ \\
                $0 \to 23$ & $x$, $y$ & $0.2970$ & $8.0814$ \\
                $0 \to 24$ & $x$, $y$ & $0.2970$ & $8.0814$ \\
                $0 \to 28$ & $z$ & $0.3060$ & $8.3275$ \\
                $0 \to 32$ & $z$ & $0.4115$ & $11.1974$ \\
                $0 \to 33$ & $z$ & $0.5310$ & $14.4485$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole_transition_cisd}
        \end{table}
        Comparing the results from \autoref{tab:fft_dipole_nest_x} and
        \autoref{tab:fft_dipole_nest_z} with the results from CISD in
        \autoref{tab:dipole_transition_cisd} we see that TDCCSD and OATDCCD are
        in excellent agreement with the transition energies from the spectrum of
        the CISD-Hamiltonian.
        However, there are small discrepancies which we expect as all three
        methods approximate the four-particle system of \ch{LiH} molecule with
        at most two-particle excitation operators.
        We also see that OATDCCD and TDCCSD yields exactly the same dipole
        transition energies within the precision that we have kept for these
        results.
        It is a little hard to determine if the coupled-cluster methods perform
        better than CISD as the energies are simultaneously higher and lower at
        different energy levels.
        An important point to note is that even though CISD is found using the
        variational principle thus guaranteeing an upper bound to the energy,
        the \emph{energy difference} does not have this requirement.
        That is, the ground state energy and an excited state are both an upper
        bound to the their respective energy, but the excited state might be
        closer to the exact energy therefore making the difference smaller than
        what it should be.
        Furthermore, we know that OATDCCD and TDCCSD are more correlated than
        CISD and should in theory yield better results, however, the transition
        energies from the coupled-cluster methods depends on a lot of factors
        such as the time step of the integrator and the sampling time when
        computing the Fourier transform of the dipole moment signal.
        But, within two decimal places the results from the coupled-cluster
        methods and CISD are in perfect agreement.

        As an extra point, the converged ground state energies\footnote{%
            This energy is excluding the nuclear repulsion as reported by
            \citeauthor{nest} \cite{nest}.
        } for CISD, TDCCSD, and OATDCCD are
        \begin{align}
            \energy_0 = \SI{-8.9772}{\hartree}.
        \end{align}
        The methods therefore seemingly perform just as well on the
        \ch{LiH} system.
        However, we see that we are able to achieve a lower ground state energy
        than reported by \citeauthor{nest} \cite{nest}.

        There is no doubt that TDHF is quite far off in terms of the dipole
        transition energies when loooking at \autoref{tab:fft_dipole_nest_x} and
        \autoref{tab:fft_dipole_nest_z}.
        This demonstrates the expected behavior as discussed in \autoref{sec:li}
        that the TDHF will falter once the laser fields intesifies and the
        correlations in the atoms and molecules becomes larger.
        To properly explain the dynamics of even a $4$-particle system we need
        something better than the signle-determinant mean-field approximation
        achieved from TDHF.
        The fact that TDHF is so far off shows promise in that the real-time
        coupled-cluster methods can be used to improve on many reported results
        achieved from using TDHF.


    \section{Spectra of noble gasses}
        \label{sec:noble-gasses}
        Before moving on to more exotic systems we wish to demonstrate one of
        the main goals in this thesis, and that is to prove that the implemented
        methods are able to explore larger systems than what can achieved with
        the full configuration interaction method.
        We therefore wish to demonstrate some simulations for the \ch{Ne} and
        \ch{Ar} atoms in exactly the same laser field as in the study done by
        \citeauthor{nest} \cite{nest} shown in \autoref{eq:nest-laser}, but with
        a higher frequency.
        We have chosen a frequency $\omega$ corresponding to a laser wavelength
        of $\lambda = \SI{200}{\nm}$ and let the envelope last for a full cycle,
        that is, $T = 2\pi / \omega$.
        We have chosen this frequency as this lets us simulate a full cycle of the
        laser in a relatively short time, thus letting the atoms oscillate for a
        long time after the laser is turned off.

        Due to the size of the atoms, $N = 10$ for \ch{Ne} and $N = 18$ for
        \ch{Ar}, the evolution of the system takes a substantial amount of time.
        We have used two different basis sets: cc-pVDZ and aug-cc-pVDZ for both
        atoms.
        We specify these basis sets in PySCF \cite{pyscf} by the strings
        \pyth{"ccpvdz"} and \pyth{"aug-ccpvdz"} respectively.
        For \ch{Ne} the basis set cc-pVDZ yields $L = 28$ spin-orbitals and
        aug-cc-pVDZ contains $L = 46$ spin-orbitals.
        Similarly for \ch{Ar} we get $L = 36$ spin-orbitals for cc-pVDZ and $L =
        54$ for aug-cc-pVDZ.
        In other words, the basis sets are still quite small, but due to the
        number of particles the runs using our non-optimized code are still
        slow.
        Ideally we would like to run all simulations for $\SI{100}{\fs}$ with a
        time step of $\Delta t = \SI{1e-2}{\hslash/\hartree}$, but in
        practice the larger basis sets did limit the length of the simulations.
        We managed to run \ch{Ne} in cc-pVDZ using OATDCCD for the full
        duration, but all other runs were truncated to $\SI{25}{\fs}$, or in the
        case of \ch{Ar} in aug-cc-pVDZ, were cut-off due to exceeding the max
        time of a week at the Abel compute cluster.
        We used the Gauss-integrator with $s = 3$ and $\epsilon = \num{1e-6}$ as
        convegence threshold for the fix-point iterations.

        All runs are done using the OATDCCD-method and we have repeated the runs
        for \ch{Ne} in both basis sets using TDCCSD as well.
        The ground state energies are listed in \autoref{tab:gs-noble-gasses}.
        \begin{table}
            \centering
            \caption{Ground state energies for \ch{Ne} and \ch{Ar} in both
            cc-pVDZ and aug-cc-pVDZ using OATDCCD and TDCCSD.
            The convergence tolerance for all amplitudes in both methods were
            set to $\num{1e-6}$.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Atom & Basis & Solver
                & $\energy$ $[\si{\hartree}]$
                & $\energy$ $[\si{\electronvolt}]$ \\
                \midrule
                \ch{Ne} & cc-pVDZ & OATDCCD & $-128.6796$ & $-3501.5501$ \\
                & & TDCCSD & $-128.6796$ & $-3501.5513$ \\
                & aug-cc-pVDZ & OATDCCD & $-128.7082$ & $-3502.3294$ \\
                & & TDCCSD & $-128.7085$ & $-3502.3364$ \\
                \ch{Ar} & cc-pVDZ & OATDCCD & $-526.9562$ & $-14339.2093$ \\
                & & TDCCSD & $-526.9562$ & $-14339.2094$ \\
                & aug-cc-pVDZ & OATDCCD & $-526.9725$ & $-14339.6511$ \\
                & & TDCCSD & $-526.9725$ & $-14339.6519$ \\
                \bottomrule
            \end{tabular}
            \label{tab:gs-noble-gasses}
        \end{table}
        In \autoref{fig:dipole-ne} we have plotted the absorption spectra for
        \ch{Ne} using both basis sets.
        The corresponding dipole allowed transition energies are listed in
        \autoref{tab:dipole-ne}.
        As discussed in \autoref{sec:atoms-and-molecules}, to properly model
        dynamics we need an augmented basis set with diffues basis functions
        beyond the ground state optimized correlation consistent basis sets.
        We can see this in the transition energies found from cc-pVDZ as they
        are far higher than the same transitions in aug-cc-pVDZ.
        In the article \citetitle{gauge-invariant-thomas-2} by
        \citeauthor{gauge-invariant-thomas-2} \cite{gauge-invariant-thomas-2}
        they report both ground state results and the first allowed dipole
        transition for \ch{Ne} in aug-cc-pVDZ.\footnote{%
            They report results for more basis sets, but we can compare with
            this basis set in particular.
        }
        For the ground state energies we have used the exact same methods, i.e.,
        the CCSD and NOCCD ground state solvers, and we see that we agree with
        the results found by \citeauthor{gauge-invariant-thomas-2}
        \cite{gauge-invariant-thomas-2} to three decimal places for \ch{Ne} in
        the aug-cc-pVDZ basis.
        In \autoref{tab:dipole-ne} we also see that OATDCCD and TDCCSD report
        similar values for the first allowed dipole transition of \ch{Ne} in
        aug-cc-pVDZ basis as reported by \citeauthor{gauge-invariant-thomas-2}
        \cite{gauge-invariant-thomas-2} using linear response theory with CCSD
        and NOCCD.
        The time-dependent NOCCD-method should be equal to OATDCCD if we let the
        right-hand side of the $Q$-space equations in OATDCCD be
        zero.\footnote{%
            This is one of the reasons why we use NOCCD as the ground state
            solver for OATDCCD.
        }
        We also see the same behvior as reported by
        \citeauthor{gauge-invariant-thomas-2} \cite{gauge-invariant-thomas-2}
        that OATDCCD reports a higher value for the transition energy than
        TDCCSD.
        However, the second allowed dipole transition in \autoref{tab:dipole-ne}
        for \ch{Ne} in the aug-cc-pVDZ basis is not reported elsewhere.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=6cm,
                    title={Absorption spectra for Neon},
                    xlabel={Excitation energy $[\si{\hartree}]$},
                    grid=major,
                    ylabel={Intensity},
                    enlarge x limits=false,
                    xmax=6,
                ]
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ne_ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{cc-pVDZ}
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ne_aug-ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{aug-cc-pVDZ}
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the Fourier transform of the
            expectation value of the dipole moment in $z$-direction of the
            \ch{Ne} atom in both cc-pVDZ and aug-cc-pVDZ using OATDCCD.
            The results for TDCCSD are visually indistinguishable and we have
            therefore refrained from plotting these.
            The peaks for both basis sets and using both solvers are listed in
            \autoref{tab:dipole-ne}.}
            \label{fig:dipole-ne}
        \end{figure}

        \begin{table}
            \centering
            \caption{Dipole transitions for \ch{Ne} in both basis sets.
            We have numbered the peaks from left to right from the plot in
            \autoref{fig:dipole-ne}.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Peak $[n]$
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                cc-pVDZ & TDCCSD & $1$ & $2.3116$ & $62.9005$ \\
                & & $2$ & $2.8879$ & $78.5830$ \\
                & & $3$ & $5.7507$ & $156.4842$ \\
                & OATDCCD & $1$ & $2.3087$ & $62.8237$ \\
                & & $2$ & $2.8890$ & $78.6130$ \\
                & & $3$ & $5.7412$ & $156.2261$ \\
                % TODO: Use new results for TDCCSD once they are done
                aug-cc-pVDZ & TDCCSD & $1$ & $0.7003$ & $19.0567$ \\
                & & $2$ & $2.1700$ & $59.0489$ \\
                & OATDCCD & $1$ & $0.7141$ & $19.4327$ \\
                & & $2$ & $2.1863$ & $59.4913$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole-ne}
        \end{table}

        Mostly as a test of the applicability of our developed codes, we repeat
        the same study we did for \ch{Ne} on the \ch{Ar} atom.
        We restrict our attention to the OATDCCD method for no other reason than
        time limitations.\footnote{%
            The inclusion of results using TDCCSD should absolutely have been
            done, but this will have to be explored at a later time.
        }
        In \autoref{fig:dipole-ar} we have plotted the absorption spectra of
        \ch{Ar} in both the cc-PVDZ and the aug-cc-pVDZ basis.
        The results from the latter basis does not have a good resolution due to
        relatively few samples after the laser pulse was switched off, but we
        are able to see a trend.
        In \autoref{tab:dipole-ar} we have listed the dipole allowed transition
        energies for all the peaks that we see in \autoref{fig:dipole-ar}.
        Recalling that the cc-pVDZ basis gave a much higher transition energy
        than for the aug-cc-pVDZ basis for \ch{Ne} we see the same result for
        \ch{Ar}.
        Note that we have been unable to locate any results for the first
        allowed dipole transitino for \ch{Ar} in the aug-cc-pVDZ basis and we
        therefore merely report it in \autoref{tab:dipole-ar}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=6cm,
                    title={Absorption spectra for Argon},
                    xlabel={Excitation energy $[\si{\hartree}]$},
                    grid=major,
                    ylabel={Intensity},
                    enlarge x limits=false,
                    xmax=3,
                ]
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ar_ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{cc-pVDZ}
                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/atoms-and-molecules/time-evolution-noble-gasses/dat/fft_ar_aug-ccpvdz_oatdccd_new_real.dat};
                    \addlegendentry{aug-cc-pVDZ}
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the Fourier transform of the
            expectation value of the dipole moment in $z$-direction of the
            \ch{Ar} atom in both cc-pVDZ and aug-cc-pVDZ using OATDCCD.
            The peaks for both basis sets and using both solvers are listed in
            \autoref{tab:dipole-ar}.}
            \label{fig:dipole-ar}
        \end{figure}

        \begin{table}
            \centering
            \caption{Dipole allowed transition energies for \ch{Ar} in cc-pVDZ
            and aug-cc-pVDZ basis along the $z$-axis using the OATDCCD-method.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Peak $[n]$
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                cc-pVDZ & OATDCCD & $1$ & $1.1118$ & $30.2549$ \\
                & & $2$ & $1.4746$ & $40.1254$ \\
                & & $3$ & $1.6323$ & $44.4168$ \\
                aug-cc-pVDZ & OATDCCD & $1$ & $0.4677$ & $12.7275$ \\
                \bottomrule
            \end{tabular}
            \label{tab:dipole-ar}
        \end{table}

    \section{Spin-dependent laser pulses}
        \label{sec:isborn}
        We have so far demonstrated that our implemented methods reproduce known
        results from the literature on a wide range of systems.
        Furthermore, we have demonstrated that we can run large simulations up to
        $N = 18$ (\ch{Ar}) in a modest basis set.
        However, we now wish to demonstrate that our implemented methods are
        able to simulate systems with a \emph{spin-dependent} Hamiltonian.
        Doing this will demonstrate that we are able to simulate systems with a
        spin-dependent magnetic field.

        In a study by \citeauthor{isborn} \cite{isborn}, the authors explored a
        spin-dependent laser field to see singlet-triplet transitions which are
        invisible to a spin-symmetric field.
        This study is performed using the time-dependent unrestricted
        Hartree-Fock (TDUHF) method and time-dependent density functional theory.
        We have not implemented a TDUHF-method and will therefore use our
        regular TDHF code with general spin-orbitals and the OATDCCD-method.

        The laser pulse used by \citeauthor{isborn} \cite{isborn} is given by
        \begin{align}
            \vfg{E}(t)
            = E_m \vfg{\epsilon} \sine(\omega t),
        \end{align}
        where we polarize in the negative $z$-direction to include the charge of
        the electrons.
        The field is active for $t \in [0, T]$ with $T = 6\pi / \omega$, i.e.,
        the field is active for three cycles of the laser frequency.
        The frequency is set to $\omega = \SI{0.06}{\hartree/\hslash}$, the
        integration time step to $\Delta t = \SI{1e-2}{\hslash/\hartree}$ and we
        let the simulation run for a total of $\SI{50}{\fs}$.
        We simulate the three molecules \ch{H2}, \ch{LiH}, and \ch{CO} with the
        two basis sets STO-3G and 6-31G**.
        The laser field strength for \ch{H2} was set to $E_m = \num{0.1}$, and
        for \ch{LiH} and \ch{CO} to $E_m = \num{0.01}$.
        Furthermore, a hickup in the (self-made) caching scheme used on the Abel
        computing cluster led to the seven days long run for \ch{CO} in the
        6-31G** basis using OATDCCD being deleted.
        Thus, our results for \ch{CO} will only be in the smaller STO-3G basis
        set.
        A frutstrating fact in the article by \citeauthor{isborn} \cite{isborn}
        is that the bonding length of the molecules used are not reported.
        We therefore assume that \citeauthor{isborn} \cite{isborn} used the
        equilibrium bond-lengths in the $z$-direction for all three molecules.
        These are listed in \autoref{tab:bond-length-isborn}.
        \begin{table}
            \centering
            \caption{Equilibrium bond lengths for diatomic molecules used in the
            study on spin-dependent laser fields \cite{bond-lengths}.
            Note that the values for \ch{LiH} are reused from the study by
            \citeauthor{nest} \cite{nest}, and converted to $\si{\pm}$ for the
            sake of completeness.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Molecule & $R_e$ $[\si{\pm}]$ & $R_e$ $[\si{\bohr}]$ \\
                \midrule
                \ch{H2} & $74$ & $1.40$ \\
                \ch{LiH} & $163$ & $3.08$ \\
                \ch{CO} & $143$ & $2.70$ \\
                \bottomrule
            \end{tabular}
            \label{tab:bond-length-isborn}
        \end{table}
        In order to make the applied field spin-dependent we have chosen a
        solution where we set the dipole moment matrix elements corresponding to
        a specific spin direction to zero and leave the other spin direction as
        it is.
        A demonstration of the dipole matrix elements of the \ch{H2} molecule in
        the 6-31G** basis is shown in \autoref{fig:dipole-matrices}.
        By using the matrix elements on the right in
        \autoref{fig:dipole-matrices} we effectively use a spin-dependent laser
        field applied to all spins in the up-direction.\footnote{%
            Note that which indices correspond to ``up'' or ``down'' is
            completely arbitrary, we just need a name for the odd and even
            indices.
        }
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \pgfplotsset{small}
                \begin{groupplot}[
                    group style={
                        group size=2 by 1,
                    },
                    width=0.5\textwidth,
                    height=0.5\textwidth,
                ]
                    \nextgroupplot[
                        view={0}{90},
                        colormap/viridis,
                        colorbar horizontal,
                        colorbar style={
                            at={
                                (0, 1.2),
                                anchor=south west,
                            },
                        },
                        title={Spin-independent},
                        title style={yshift=5ex},
                    ]
                        \addplot[
                            matrix plot*,
                            mesh/rows=20,
                            point meta=explicit,
                        ]
                        file[meta=index 2]
                        {results/benchmarks/isborn/dat/h2_6-31gss_dip_mat_both.dat};
                    \nextgroupplot[
                        view={0}{90},
                        colormap/viridis,
                        colorbar horizontal,
                        colorbar style={
                            at={
                                (0, 1.2),
                                anchor=north west,
                            },
                        },
                        title={Spin-dependent},
                        title style={yshift=5ex},
                    ]
                        \addplot[
                            matrix plot*,
                            mesh/rows=20,
                            point meta=explicit,
                        ]
                        file[meta=index 2]
                        {results/benchmarks/isborn/dat/h2_6-31gss_dip_mat_up.dat};
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have plotted the dipole matrix elements along
            $z$-direction, that is, $z^{p}_{q}$, for \ch{H2} in the 6-31G**
            basis.
            The image on the left is of the full dipole matrix elements whereas
            the image on the left shows the same matrix elements, but with all
            odd indices set to zero which means that we are left with the dipole
            matrix elements for the spin-up direction.
            Note that we have scaled the values to be between $0$ and $1$ by
            taking the elementwise absolute value of $\vfg{z}$ and dividing by
            the max value in the matrix.}
            \label{fig:dipole-matrices}
        \end{figure}

        In \autoref{fig:h2-isborn} we have plotted the absorption spectra of
        \ch{H2} using both basis sets and both TDHF and OATDCCD.
        We have also included absorption spectra using a spin-dependent field as
        the dashed lines in \autoref{fig:h2-isborn}.
        As expected from the study done by \citeauthor{isborn} \cite{isborn} we
        see that the spin-dependency adds an extra peak at a lower energy level
        than the first allowed dipole transition.
        This is the first singlet to triplet allowed dipole transition in
        \ch{H2}.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        title={Absorption spectra of \ch{H2} (STO-3G)},
                        grid=major,
                        ylabel={Intensity},
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_sto-3g_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}

                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{H2} (6-31G**)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_h2_6-31gss_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have plotted the absorption spectra of
            \ch{H2} subject to a laser field using the TDHF (HF) and the OATDCCD
            (OA) methods.
            The label ``up'' denotes a spin-dependent field along one of the
            spin-functions.
            No extra label means that the field is spin-indepdenent.}
            \label{fig:h2-isborn}
        \end{figure}
        In \autoref{tab:h2-isborn} we have listed the transition energies found
        from the peaks in \autoref{fig:h2-isborn}.
        \begin{table}
            \centering
            \caption{Dipole transition energy levels for the \ch{H2} molecule in
            both the STO-3G and the 6-31G** basis sets using TDHF and OATDCCD.
            These results are found from the visible peaks in
            \autoref{fig:h2-isborn}.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                STO-3G & TDHF & no & $0.5574$ & $15.1687$ \\
                & & yes & $0.9315$ & $25.3464$ \\
                & OATDCCD& no & $0.6078$ & $16.5395$ \\
                & & yes & $0.9675$ & $26.3262$ \\
                6-31G** & TDHF & no & $0.3632$ & $9.8841$ \\
                & & yes & $0.5466$ & $14.8751$ \\
                & OATDCCD & no & $0.4028$ & $10.9611$ \\
                & & yes & $0.5539$ & $15.0715$ \\
                \bottomrule
            \end{tabular}
            \label{tab:h2-isborn}
        \end{table}
        For the \ch{H2} molecule we can use CISD, i.e., FCI in this case, to
        compute the entire spectrum and locate the allowed dipole transitions
        using the same technique as discussed in \autoref{sec:nest}.
        Furthermore, using the spin-reduced dipole matrix elements we should
        be able to locate the allowed singlet-triplet transitions.
        In \autoref{tab:h2-isborn-transitions} we have listed all allowed
        dipole transitions in both basis sets for \ch{H2}.
        We have denoted singlet allowed transitions -- where it is understood that
        the same transition is allowed in the spin-dependent case as well --
        specifically to demonstrate which peaks we expect to see for the singlet
        only transitions.
        \begin{table}
            \centering
            \caption{Dipole allowed transitions for \ch{H2} in both basis sets
            computed using CISD.
            The transition is from the ground state $I = 0$ to a higher excited
            state $J$.
            We have limited the transition energies to $\Delta \energy \leq
            \SI{1}{\hartree}$ for the 6-31G** basis.
            Spin-independent transitions, i.e., singlet-to-singlet transitions,
            are denoted with a ``yes'' under the column ``Singlet allowed''.
            These transitions are also allowed in the spin-dependent case.}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Transition & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                STO-3G & $0 \to 1$ & no & $0.6065$ & $16.5040$ \\
                & $0 \to 3$ & no & $0.6065$ & $16.5040$ \\
                & $0 \to 4$ & yes & $0.9689$ & $26.3660$ \\
                6-31G** & $0 \to 1$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 2$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 3$ & no & $0.4020$ & $10.9403$ \\
                & $0 \to 4$ & yes & $0.5523$ & $15.0277$ \\
                \bottomrule
            \end{tabular}
            \label{tab:h2-isborn-transitions}
        \end{table}
        Comparing \autoref{tab:h2-isborn-transitions} with the results in
        \autoref{tab:h2-isborn} we are able to locate the energy transitions in the
        results from OATDCCD.
        We note that the energies are not exactly the same -- even though both
        CISD and OATDCCD are formally exact within the given basis for $N = 2$
        particles -- but as the methods for discovering these energy transitions
        are so vastly different as discussed in \autoref{sec:nest} we conclude
        that these energies are the same.
        Comparing with the results from \citeauthor{isborn} \cite{isborn} we see
        that TDHF is close to their results using TDUHF.
        However, we conjecture that the discrepancies are mainly a result of
        \citeauthor{isborn} \cite{isborn} using the presumably more stable TDUHF
        method for spin-dependent laser fields.
        We also note that our results using the more exact methods OATDCCD and
        CISD have higher transition energies than the results achieved from
        TDHF.
        It seems that both TDHF and TDUHF predict a lower transition energy
        than what is correct.

        From \autoref{tab:h2-isborn-transitions} we see that the degenerate
        transitions in the STO-3G basis $0 \to 1$ and $0 \to 3$ are triplet-only
        allowed transitions, but the interesting thing is that the transition $0
        \to 2$ is also a transition with the same energy level.
        However, the latter transition is \emph{not} a dipole-allowed triplet
        transition.
        In the 6-31G** basis the triplet transitions opens up for all
        transitions up to the fourth excited state within the energy levels we
        explore.


        Repeating the same exercise for the \ch{LiH} system we have the
        absorption spectra for both the spin-dependent and spin-independent
        fields in the STO-3G and the 6-31G** basis sets in
        \autoref{fig:lih-isborn}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{LiH} (STO-3G)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                        xmax=0.25,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_sto-3g_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}


                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{LiH} (6-31G**)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                        xmax=0.25,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_lih_6-31gss_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have plotted the absorption spectra of
            \ch{LiH} subject to a laser field using the TDHF (HF) and the OATDCCD
            (OA) methods.
            The label ``up'' denotes a spin-dependent field along one of the
            spin-functions.
            No extra label means that the field is spin-indepdenent.}
            \label{fig:lih-isborn}
        \end{figure}
        We see that the signal from these simulations is rather noisy.
        Tabulating the values in \autoref{fig:lih-isborn} we get the results
        shown in \autoref{tab:lih-isborn}.
        \begin{table}
            \centering
            \caption{Dipole transition energy levels for the \ch{LiH} molecule in
            both the STO-3G and the 6-31G** basis sets using TDHF and OATDCCD.
            These results are found from the peaks in \autoref{fig:lih-isborn}
            with a threshold that the peaks must have a larger intensity than
            $\num{0.2}$.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                STO-3G & TDHF & no & $0.0468^{\diamond}$ & $1.2722$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & yes & $0.1618$ & $4.4038$ \\
                & OATDCCD & no & $0.0180^{\diamond}$ & $0.4893$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & no & $0.1295^{\dagger}$ & $3.5231$ \\
                & & yes & $0.1331$ & $3.6210$ \\
                6-31** & TDHF & no & $0.0324^{\ddagger}$ & $0.8808$ \\
                & & no & $0.0432^{\ddagger}$ & $1.1743$ \\
                & & no & $0.0503^{\ddagger}$ & $1.3701$ \\
                & & no & $0.0575^{\ddagger}$ & $1.5658$ \\
                & & no & $0.0755^{\ddagger}$ & $2.0551$ \\
                & & no & $0.0935^{\ddagger}$ & $2.5444$ \\
                & & no & $0.1043^{\ddagger}$ & $2.8380$ \\
                & & no & $0.1151$ & $3.1316$ \\
                & & yes & $0.1510$ & $4.1102$ \\
                & OATDCCD & no & $0.0144^{\diamond}$ & $0.3915$ \\
                & & no & $0.1115$ & $3.0339$ \\
                & & yes & $0.1259$ & $3.4253$ \\
                \bottomrule
            \end{tabular}
            \label{tab:lih-isborn}
        \end{table}
        Unlike the \ch{H2} molecule we see that the values in
        \autoref{tab:lih-isborn} contains significantly more noise, especially
        for the transition energies found using the TDHF-method.
        The transition energy in \autoref{tab:lih-isborn} denoted with a
        ``$\dagger$'' is included as it is, but we conjecture that it should
        really be the singlet-allowed transition listed just below.
        This as the peaks in the upper palette of \autoref{fig:lih-isborn} show
        that the two peaks coincide, but due to few samples they do not overlap
        perfectly.
        The values for TDHF in \autoref{tab:lih-isborn} denoted with a
        ``$\ddagger$'' are clearly noise.
        Furthermore, comparing with \citeauthor{isborn} \cite{isborn} we see
        that only the two values that are not denoted with a ``$\ddagger$'' are
        the actual dipole transition energies we should see.
        However, they are so weak that they occur below the noise and would not
        have been discovered unless we knew what we were looking for.
        This demonstrates that the TDHF-method is unable to describe the
        spin-dependent field.
        As \citeauthor{isborn} \cite{isborn} were able to get better
        measurements we believe that the usage of a TDUHF-method would recover
        the desired results.
        This would be an interesting study to explore, but we have not had the
        time to implement the TDUHF-method.
        The values in \autoref{tab:lih-isborn} marked with a ``$\diamond$'' are
        most likely the results of dipole transitions between two excited
        states.
        We see that they are present in plots of \citeauthor{isborn}
        \cite{isborn} as well, and we leave them as they are.

        Computing the dipole allowed transitions using the CISD-method we get
        the results shown in \autoref{tab:lih-isborn-transitions}.
        The TDHF results in \autoref{tab:lih-isborn} that are not marked as
        noise compare well with the results from \citeauthor{isborn}
        \cite{isborn} whereas the OATDCCD results are comparable to the results
        from CISD in \autoref{tab:lih-isborn-transitions}.
        However, they are not the same for the same reasons as discussed in the
        two previous studies using this technique.
        \begin{table}
            \centering
            \caption{Dipole allowed transitions for \ch{LiH} in both basis sets
            computed using CISD.
            We use the notation $[J - K]$ to denote a range of excited states.
            We only include results for $\Delta \energy \leq
            \SI{0.25}{\hartree}$.}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Transition & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$ \\
                \midrule
                STO-3G & $0 \to [1-3]$ & no & $0.1138$ & $3.0959$ \\
                & $0 \to 4$ & yes & $0.1313$ & $3.5741$ \\
                6-31G** & $0 \to [1-3]$ & no & $0.1099$ & $2.9894$ \\
                & $0 \to 4$ & yes & $0.1259$ & $3.4261$ \\
                & $0 \to [13-15]$ & no & $0.2222$ & $6.0468$ \\
                \bottomrule
            \end{tabular}
            \label{tab:lih-isborn-transitions}
        \end{table}
        % TODO: Add CO maybe?
        Finally, in \autoref{fig:co-isborn} we have listed the results from the
        \ch{CO} simulations in the STO-3G basis.
        Here we clearly see how TDHF really struggles with the spin-dependent
        field.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 1,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        grid=major,
                        title={Absorption spectra of \ch{CO} (STO-3G)},
                        ylabel={Intensity},
                        enlarge x limits=false,
                        xmax=2,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_co_sto-3g_tdhf_both_real.dat};
                        \addlegendentry{HF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_co_sto-3g_oatdccd_both_real.dat};
                        \addlegendentry{OA}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_co_sto-3g_tdhf_up_real.dat};
                        \addlegendentry{HF (up)}

                        \addplot+[
                            mark=none,
                            thick,
                            dashed,
                        ]
                        table
                        {results/benchmarks/isborn/dat/fft_co_sto-3g_oatdccd_up_real.dat};
                        \addlegendentry{OA (up)}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have plotted the absorption spectra of
            \ch{CO} subject to a laser field using the TDHF (HF) and the OATDCCD
            (OA) methods.
            The label ``up'' denotes a spin-dependent field along one of the
            spin-functions.
            No extra label means that the field is spin-indepdenent.}
            \label{fig:co-isborn}
        \end{figure}
        In \autoref{tab:co-isborn} we have tabulated the peaks from
        \autoref{fig:co-isborn}.
        The results from the TDHF-method, especially for the spin-dependent
        field, are hard to make sense of.
        They seemingly only consist of noisy data and by comparing with the
        results found by \citeauthor{isborn} \cite{isborn} we see that there are
        little to no comparison of the results.
        For OATDCCD we trust our data a little more, but it is again hard to
        compare with the results from \citeauthor{isborn} \cite{isborn} as they
        use TDUHF and TDDFT.
        Also, what is strange is that we only see a single clear peak once the
        spin-dependent field is active, and this value is much lower than any
        results reported by \citeauthor{isborn} \cite{isborn}.
        \begin{table}
            \centering
            \caption{Dipole transition energy levels for the \ch{CO} molecule in
            the STO-3G basis using TDHF and OATDCCD.
            These results are found from the peaks in \autoref{fig:co-isborn}
            with a threshold that the peaks must have a larger intensity than
            $\num{0.05}$ for the OATDCCD-method and $\num{0.8}$ for the
            TDHF-method.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lllll@{}}
                \toprule
                Basis & Solver & Singlet allowed
                & $\Delta \energy$ $[\si{\hartree}]$
                & $\Delta \energy$ $[\si{\electronvolt}]$
                \\
                \midrule
                STO-3G & TDHF & no & $0.0036$ & $0.0979$ \\
                & & yes & $0.1690$ & $4.5996$ \\
                & & yes & $0.7013$ & $19.0833$ \\
                & & yes & $0.7912$ & $21.5299$ \\
                & & yes & $0.9315$ & $25.3465$ \\
                & OATDCCD & no & $0.0971$ & $2.6423$ \\
                & & yes & $0.3453$ & $9.3949$ \\
                & & yes & $0.6869$ & $18.6919$ \\
                & & yes & $0.8092$ & $22.0193$ \\
                & & yes & $0.9171$ & $24.9552$ \\
                \bottomrule
            \end{tabular}
            \label{tab:co-isborn}
        \end{table}

        The inclusion of a spin-dependent laser field demonstrates that we are
        able to take a step further and include magnetic fields with spin-orbit
        coupling in future work.
        In \citeauthor{greg-winther}'s work, a demonstration of an orbital
        angular magnetic field is showcased \cite{greg-winther}, but we wish in the future to
        include the spin-dependence as well.

    \section{Ionization of one-dimensional atoms}
        The process of modelling ionization of electrons in atoms is a hot
        topic \cite{kosloff1986363, miyagi_and_madsen, takeshi, sawada,
        Sato_2014}.
        It is also of the utmost importance when doing laser driven dynamics as
        at some point or another we will use a field which in reality would rip
        the electrons away from the atoms and molecules.
        An accurate description of this process is therefore important in order
        to model real experiments, which after all, is what we are trying to
        do.

        In a study done by \citeauthor{miyagi_and_madsen}
        \cite{miyagi_and_madsen} they explored the dynamics of one-dimensional
        atoms subject to a dipole laser.
        This study provides us with an excellent benchmark to observe a form
        of ionization and see if this is reproducible in our formalism.
        Note that \citeauthor{miyagi_and_madsen} \cite{miyagi_and_madsen} use a
        discrete-variable-representation basis (DVR) \cite{miyagi_and_madsen,
        takeshi} which is why they include an absorbing potential.
        Our solution differs from this as we use the static one-dimensional
        quantum dot basis with a one-dimensional atom potential.
        In a position basis with Hartree atomic units, the one-body
        Hamiltonian is given by \cite{miyagi_and_madsen}
        \begin{align}
            \oneten(x, t)
            &= -\half \dod[2]{}{x}
            - \frac{Z}{\sqrt{x^2 + 1}}
            + xF(t)
            - iW(x),
        \end{align}
        where $Z = N_e$ -- the number of electrons in the system -- and $W(x)$
        is the absorbing potential, which we will set to zero.
        The second term gives rise to the naming of these systems as
        one-dimensional atoms as this term serves as the electron-nuclear
        interaction in the atomic Hamiltonian, but with the three-dimensional
        position replaced with $x$.
        One of the interesting aspects of the one-dimensional atoms is that many
        open-shell systems such as Carbon (\ch{C}) becomes closed shell systems
        in the one-dimensional case.
        We will limit our study to the one-dimensional Beryllium (\ch{Be})
        system with $N = 4$ electrons in a closed shell.

        The laser pulse $F(t)$ used by \citeauthor{miyagi_and_madsen} is given
        by \cite{miyagi_and_madsen}
        \begin{align}
            F(t)
            &= -\dod[]{A(t)}{t}
            = -\dod[]{}{t}\brak{
                \frac{F_0}{\omega}
                \sin^2\para{\frac{\pi t}{T}}
                \sin(\omega t)
            }
            \\
            &=
            -\sin\para{\frac{\pi t}{T}}\brak{
                \omega \sin\para{\frac{\pi t}{T}}
                \cos(\omega t)
                + \frac{2\pi}{T}
                \cos\para{\frac{\pi t}{T}}
                \sin(\omega t)
            },
            \label{eq:miyagi-laser}
        \end{align}
        where the field is active for $t \in [0, T]$.
        The Coulomb interaction is given by \autoref{eq:shielded-coulomb} with a
        shielding parameter of $a = 1$ and $\alpha = 1$.
        To compare with the study by \citeauthor{miyagi_and_madsen}
        \cite{miyagi_and_madsen} we will run for $T =
        \SI{331}{\hslash/\hartree}$ with $\Delta t =
        \SI{1e-2}{\hslash/\hartree}$ which corresponds to $n_t = 33100$ time
        steps.
        This computation is rather involved and we will therefore limit
        ourselves to the time-dependent Hartree-Fock method and the
        orbital-adaptive time-dependent coupled-cluster method as the
        full-configuration interaction method becomes quite expensive.
        In fact, for $N = 4$ and $L = 40$ we have to create a Hamiltonian
        matrix with $91390^2$ elements, each of size $\SI{16}{\text{B}}$ as
        we use complex numbers.
        To solve this system we require a more efficient implementation of the
        configuration interaction method which is out of scope for this thesis.


        Using the same definition as \citeauthor{takeshi} \cite{takeshi}, we
        define ionization as all components outside a radius of $\SI{20}{\bohr}$
        from the center of the nucleus \cite{hochstuhl2014time, takeshi}.
        We can then measure the amount of ionization by computing the particle
        density outside this radius, or conversely, the amount of particle
        density still inside the nucleus.
        However, note that as we use static orbitals, we are dependent on having
        a large enough basis set to actually observe ionization.
        In \autoref{fig:spf-potential-miyagi} we see the highest lying
        orbitals we have used in the one-dimensional Beryllium system.
        We see that unless we include more than $10$ orbitals we will not
        include states that are outside the radius of $\SI{20}{\bohr}$.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=8cm,
                    xlabel={$x$ $[\si{\bohr}]$},
                    ylabel={$E$ $[\si{\hartree}]$},
                    xmin=-100,
                    xmax=100,
                    ymin=-0.25,
                    legend pos=south west,
                    grid=major,
                ]
                    \addplot+[
                        mark=none,
                        dashed,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/miyagi_potential.dat};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=10_sq.dat};
                    \addlegendentry{$\abs{\psi_{10}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=15_sq.dat};
                    \addlegendentry{$\abs{\psi_{15}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=20_sq.dat};
                    \addlegendentry{$\abs{\psi_{20}(x)}^2$};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted some of the high lying
            single-particle functions squared and scaled by their
            eigenenergy inside the one-dimensional Beryllium potential.
            We have only included a select few single-particle functions to
            avoid the figure being too cluttered.}
            \label{fig:spf-potential-miyagi}
        \end{figure}
        To demonstrate this we have in \autoref{fig:one-particle-density-miyagi}
        plotted the particle density using a basis of $L / 2 = 10$ orbitals.
        Looking at the lower palette of
        \autoref{fig:one-particle-density-miyagi} we see that the system is
        still fairly confined.
        This shows how this basis does not allow any significant particle
        density outside the nucleus.
        We can also see this from \autoref{fig:spf-potential-miyagi} as $L =
        20$ means the highest single-particle function used is
        $\psi_{10}(x)$ which is clearly confined in the potential well.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we plot the particle density for the
            initial ground state, after half the simulation has been run and for
            the final state of the one-dimensional \ch{Be} system.
            For these figures we have $L = 20$ spin-orbitals, that is, $L /
            2 = 10$ orbitals.
            The $y$-axis has been truncated at $y = \num{1e-4}$ to avoid
            including noise in the figures.}
            \label{fig:one-particle-density-miyagi}
        \end{figure}
        Looking at \autoref{fig:one-particle-density-miyagi-l=40} we see the
        same one-dimensional \ch{Be} system with a basis set of $L = 40$
        spin-orbitals.
        It is apparent that the system undergoes a larger degree of ionization
        with more of the particle density further away from the central
        potential.
        This is also seen in \autoref{fig:spf-potential-miyagi} as $L = 40$
        includes the state $\psi_{20}(x)$ which is more dispersed.
        Comparing with the results reported by \citeauthor{miyagi_and_madsen}
        \cite{miyagi_and_madsen} we see that we are able to perform
        qualitatively just as well.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{These figures show the same situation as in
            \autoref{fig:one-particle-density-miyagi} but for $L = 40$
            spin-orbitals.
            We have truncated the $y$-axis to $y = \num{1e-4}$ as lower
            values include more noise and provides no more insight.}
            \label{fig:one-particle-density-miyagi-l=40}
        \end{figure}
        In \autoref{fig:one-particle-density-miyagi-l=40} we see that the
        OATDCCD-method is able to describe a larger degree of ionization than
        TDHF.
        However, it is reasonable to believe that with either a larger basis
        set, or a basis set with time-dependency on the grid we might get an
        even large degree of ionization.
        As it stands the particles can never escape the potential and once they
        have reached the edge of their extent -- as seen in
        \autoref{fig:spf-potential-miyagi} -- they can only be reflected.
        This will then lead to the electrons oscillating in the well, when they
        should in fact have escaped the trapping potential all together.

        % TODO: Add plot of ionization as a function of time.
        % Use L = 20, 30, 36, 40

        If we were to describe ionization in three dimensions we would either
        need a combination of diffues or continuum states which can describe
        ionization.
        An alternative is the use of a DVR basis \cite{miyagi_and_madsen,
        takeshi}, but this would need a clever grid solution as the three
        dimensional grid quickly becomes a memory and computational clog.


    \section{Summing up the applications}
        We have in this chapter explored several studies done on atoms and
        molecules using real-time methods.
        We have found our implemented methods to be comparable to what has been
        reported in the literature.
        We have demonstrated how the methods can be applied to larger systems
        such as \ch{Ar}, and discussed how more time must be spent on the
        optimization of our code for systems of $N = 18$ particles to be
        practical.

        We went on to look at more academic studies where we explored a
        spin-depedent laser field as a taste of what can be done with the
        addition of spin-orbit coupling.
        Finally, we explored the highly interesting topic of ionization in a
        one-dimensional atomic system highlighting how the implemented code can
        be used to describe these type of effects.


\clearemptydoublepage

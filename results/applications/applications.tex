\chapter{Applications}
    Having verified that our implementations work on smaller systems in
    \autoref{chap:validation} and demonstrated the strength of the
    orbital-adaptive coupled-cluster methods in \autoref{chap:stability} we now
    seek to push the methods by exploring more complicated systems.
    Our goal is to firmly establish that we are able to explore larger systems
    than can be done with the full configuration interaction method and the
    multi-configuration Hartree-Fock method, while achieving a quality of the
    results beyond what is possible with the mean-field approximation using
    Hartree-Fock.
    Note that we in this chapter do little to no conscious effort in terms of
    optimization as the default setup of the solvers often yield more than good
    enough results.
    This means that we can focus as much as possible on the physics of the
    problems.

    \section{Electronic spectra of molecules}
        In an article by \citeauthor{nest} \cite{nest} the
        multiconfiguration time-dependent Hartree-Fock method was tested on
        a system of lithium hydride and methane subject to a dipole
        laser pulse with a sine-squared envelope on the form\footnote{%
            Note that \citeauthor{nest} \cite{nest} does not explicitly add
            a formula for the laser, but based on their description we infer
            the form of the laser.
        }
        \begin{align}
            \vfg{E}(t)
            = -\vfg{\epsilon} E(t)
            \sin[2](\pi t / T)
            = -\vfg{\epsilon} E_0 \sin(\omega t)
            \sin[2](\pi t / T),
            \label{eq:nest-laser}
        \end{align}
        where $\vfg{\epsilon}$ is the polarization vector, $\omega$ is the
        frequency corresponding to a photon energy of $E_{\nu} =
        \SI{5.44}{\electronvolt}$.
        The negative sign in the polarization vector comes from the charge of
        the electrons.
        The laser field is active for $t \in \brak{0, T}$ where $T =
        \SI{1}{\femto\second}$, and the intensity of the laser field is chosen
        to be $I = \SI{3.5e12}{\watt/\cm^2}$.
        The simulation is run for $\SI{100}{\femto\second}$.
        A plot of the laser field in the first $t = \SI{2}{\femto\second}$ of
        the simulation is shown in \autoref{fig:nest-laser}.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                        width=11cm,
                        height=6cm,
                        xlabel={$t$ $[\si{\planckbar / \hartree}]$},
                        grid=major,
                        ylabel={
                            $E(t)$ $[
                                \si{\hartree / (\elementarycharge \bohr)}
                            ]$
                        },
                        enlarge x limits=false,
                    ]
                    \addplot+ [
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/nest/dat/nest_laser_new.dat};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the laser pulse from
            \autoref{eq:nest-laser} for $t = \SI{2}{\femto\second} \approx
            \SI{82.6}{\hslash / \hartree}$, with parameters as defined in the
            text.}
            \label{fig:nest-laser}
        \end{figure}
        A word of caution, when reproducing the results in this article some
        care must be taken when converting to atomic units for the frequency,
        time, and the intensity of the laser as it is not clear how much one
        should round the numbers.
        We have used the Python library \citetitle{pint} \cite{pint} to
        convert from SI units to atomic units as they stand in the text
        without any rounding.
        These conversions are summarized in \autoref{tab:nest-conversions}.
        \begin{table}
            \centering
            \caption{In this table we show the conversions used to move from
            the SI units given in the article by \citeauthor{nest}
            \cite{nest} to the atomic units used in the simulation.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Quantity & SI units & Atomic units \\
                \midrule
                $E_{\nu}$ & $\SI{5.44}{\electronvolt}$ &
                \SI{1.999163e-1}{\hartree} \\
                $I$ & $\SI{3.5e12}{\watt/\cm^{2}}$ &
                \SI{9.973085e-5}{\text{a.u.}} \\
                $t$ & $\SI{1}{\femto\second}$ &
                \SI{4.134137e+1}{\hslash/\hartree}
                \\
                \bottomrule
            \end{tabular}
            \label{tab:nest-conversions}
        \end{table}
        The corresponding frequency in atomic units of the laser specified by
        the photon energy $E_{\nu}$ in \autoref{tab:nest-conversions} is $\omega
        = \SI{1.999163e-1}{\hartree/\hslash}$.
        The electric field strength from the intensity is found to be $E =
        \SI{9.986533e-4}{\hartree/(\elementarycharge \bohr)}$.

        We repeat the study for the \ch{LiH}-molecule as done by
        \citeauthor{nest}.
        We use a bond-length of $\SI{3.08}{\bohr}$ in the $z$-direction
        between the lithium and the hydrogen atoms with the basis 6-31G*.
        To specify this basis in PySCF we pass in the string \pyth{"6-31Gs"}.
        We use the TDHF, TDCCSD, and the OATDCCD solvers in this study and we
        sample the dipole moment for each method.
        Computing the Fourier transform of the dipole moment after the laser is
        turned off yields the absorption spectra of \ch{LiH}.
        We run two simulations; one where we polarize the laser along the
        $z$-direction and measure along the same axis, and another simulation
        where we do the same in the $x$-direction.

        In \autoref{fig:fft_dipole_nest} we have included the Fourier
        transform of the sampled dipole moment in $x$- and $z$-direction in
        time, respectively.
        These plots show the absorption spectra for the \ch{LiH}-molecule.
        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                    group style={
                        group size=1 by 2,
                        vertical sep=60pt,
                        xlabels at=edge bottom,
                    },
                    width=11cm,
                    height=6cm,
                    xlabel={Excitation energy $[\si{\hartree}]$},
                ]
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{x(t)}}$},
                        grid=major,
                        ylabel={Intensity},
                        enlarge x limits=false,
                        %ymax=0.5e-4,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_x_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                    \nextgroupplot[
                        title={$\mathcal{F}\brak{\expval*{z(t)}}$},
                        ylabel={Intensity},
                        grid=major,
                        enlarge x limits=false,
                        %ymax=0.5e-4,
                    ]
                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_oatdccd_real_new.dat};
                        \addlegendentry{OATDCCD}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdhf_real_new.dat};
                        \addlegendentry{TDHF}

                        \addplot+[
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/nest/dat/fft_dipole_z_tdccsd_real_new.dat};
                        \addlegendentry{TDCCSD}
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we show the Fourier transform of the
            dipole moment in $x$-and $y$-direction of the \ch{LiH}-molecule
            using time-dependent Hartree-Fock, time-dependent coupled cluster
            with singles and doubles, orbital-adaptive time-dependent coupled
            cluster with doubles excitations.
            The top figure shows the results in $x$-direction and the lower
            in $z$-direction.
            Note that we have removed the zero-frequency component from
            these spectra.}
            \label{fig:fft_dipole_nest}
        \end{figure}

        \begin{table}
            \centering
            \caption{Transition energies from peaks in Fourier specter of the
            dipole moment in the $x$-direction as seen in the top palette of
            \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$ \\
                \midrule
                TDHF & $1$ & $0.18922721$ \\
                & $2$ & $0.32307085$ \\
                TDCCSD & $1$ & $0.15999699$ \\
                & $2$ & $0.29691749$ \\
                OATDCCD & $1$ & $0.15999699$ \\
                & $2$ & $0.29691749$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_x}
        \end{table}

        \begin{table}
            \centering
            \caption{Transition energies from peaks in Fourier specter of the
            dipole moment in the $z$-direction as seen in the bottom palette of
            \autoref{fig:fft_dipole_nest}.
            The peaks are counted from left to right.}
            \renewcommand{\arraystretch}{1.3}
            \begin{tabular}{@{}lll@{}}
                \toprule
                Solver & Peak [$n$] & $\Delta \energy$ $[\si{\hartree}]$ \\
                \midrule
                TDHF & $1$ & $0.18922721$ \\
                & $2$ & $0.32307085$ \\
                TDCCSD & $1$ & $0.15999699$ \\
                & $2$ & $0.29691749$ \\
                OATDCCD & $1$ & $0.15999699$ \\
                & $2$ & $0.29691749$ \\
                \bottomrule
            \end{tabular}
            \label{tab:fft_dipole_nest_z}
        \end{table}


    \section{Ionization of one-dimensional atoms}
        The process of modelling ionization of electrons in atoms and
        molecules is a tricky subject, particularly in our regime.
        That is because we are forcing our systems to be bound by simulating a
        restricted space and requiring that all particles be contained inside
        the simulation box.
        As a consequence, ionization has to be inferred in some way or another.
        e.g., an absorbing potential with a time-dependent atomic orbital basis
        on a grid \cite{kosloff1986363, miyagi_and_madsen, takeshi}.
        However, in our formalism we use static atomic orbitals which we
        force to zero at the boundaries of the simulation box.
        This makes the use of an absorbing potential useless and ionization
        must be inferred in some other way.

        In a study done by \citeauthor{miyagi_and_madsen}
        \cite{miyagi_and_madsen} they explored the dynamics of one-dimensional
        atoms subject to a dipole laser.
        This study provides us with an excellent benchmark to observe a form
        of ionization and see if this is reproducible in our formalism.
        Note that \citeauthor{miyagi_and_madsen} used a
        discrete-variable-representation basis (DVR) which is why they include
        an absorbing potential.
        Our solution differs from this as we use the static one-dimensional
        quantum dot basis with a one-dimensional atom potential.
        In a position basis with Hartree atomic units, the one-body
        Hamiltonian is given by \cite{miyagi_and_madsen}
        \begin{align}
            \oneten(x, t)
            &= -\half \dod[2]{}{x}
            - \frac{Z}{\sqrt{x^2 + 1}}
            + xF(t)
            - iW(x),
        \end{align}
        where $Z = N_e$, that is, the number of electrons in the system,
        $W(x)$ is the absorbing potential, which we'll set to zero.
        The second term gives rise to the naming of these systems as
        one-dimensional atoms as this term serves as the electron-nuclear
        interaction in the atomic Hamiltonian, but with the three-dimensional
        position replaced with $x$.
        One of the interesting aspects of the one-dimensional atoms is that many
        open-shell systems such as \ch{C} gets closed shells in the
        one-dimensional case.
        We will however, limit our study to the one-dimensional Beryllium
        system with $N = 4$ electrons in a closed shell.

        The laser pulse $F(t)$ is given by \cite{miyagi_and_madsen}
        \begin{align}
            F(t)
            &= -\dod[]{A(t)}{t}
            = -\dod[]{}{t}\brak{
                \frac{F_0}{\omega}
                \sin^2\para{\frac{\pi t}{T}}
                \sin(\omega t)
            }
            \\
            &=
            -\sin\para{\frac{\pi t}{T}}\brak{
                \omega \sin\para{\frac{\pi t}{T}}
                \cos(\omega t)
                + \frac{2\pi}{T}
                \cos\para{\frac{\pi t}{T}}
                \sin(\omega t)
            }.
            \label{eq:miyagi-laser}
        \end{align}
        where this field is active for $t \in [0, T]$.
        A plot of the laser pulse during the simulation is shown in
        \autoref{fig:miyagi-laser}.
        The Coulomb interaction is given by \autoref{eq:shield-coulomb} with a
        shielding parameter of $a = 1$ and $\alpha = 1$.
        To compare with the study by \citeauthor{miyagi_and_madsen} we will run
        for $T = \SI{331}{\hslash/\hartree}$ with $\Delta t =
        \SI{1e-2}{\hslash/\hartree}$ which corresponds to $n_t = 33100$
        time steps.
        This computation is rather involved and we will therefore limit
        ourselves to the time-dependent Hartree-Fock method and the
        orbital-adaptive time-dependent coupled cluster method as the
        full-configuration interaction method becomes quite expensive.
        In fact, for $n = 4$ and $l = 40$ we have to create a Hamiltonian
        matrix with $91390^2$ elements, each of size $\SI{16}{\text{B}}$ as
        we use complex numbers.
        To solve this system we require a much smarter implementation of the
        configuration interaction method which is out of scope for this
        thesis.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                        width=11cm,
                        height=6cm,
                        xlabel={$t$ $[\text{a.u.}]$},
                        grid=major,
                        ylabel={$F(t)$},
                        enlarge x limits=false,
                        enlarge y limits=false,
                    ]
                    \addplot+ [
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/miyagi_laser.dat};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we have plotted the laser pulse from
            \autoref{eq:miyagi-laser} for $T = \SI{331}{\text{a.u.}}$,
            $\omega = \SI{0.057}{\text{a.u.}}$, and $F_0 =
            \SI{0.0755}{\text{a.u.}}$ \cite{miyagi_and_madsen}.}
            \label{fig:miyagi-laser}
        \end{figure}


        In order for us to observe actual ionization we need to have a basis
        containing scattered states, that is, states that have an eigenenergy
        above the potential well such that we get a non-zero portion of the wave
        function outside the potential well.
        If the basis set is too small all states will be bound in the atomic
        potential and it is not possible to make a linear combination where
        some parts of the total wave function is outside the potential well
        more than a small tunneling effect.
        In \autoref{fig:spf-potential-miyagi} we see the highest lying
        orbitals we've used in the one-dimensional Beryllium system.
        The plot demonstrates that we need a large basis in order to capture
        scattered states.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{axis}[
                    width=11cm,
                    height=8cm,
                    xlabel={$x$ $[\text{a.u.}]$},
                    ylabel={$E$ $[\text{a.u.}]$},
                    xmin=-100,
                    xmax=100,
                    ymin=-0.25,
                    legend pos=south west,
                    grid=major,
                ]
                    \addplot+[
                        mark=none,
                        dashed,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/miyagi_potential.dat};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=10_sq.dat};
                    \addlegendentry{$\abs{\psi_{10}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=15_sq.dat};
                    \addlegendentry{$\abs{\psi_{15}(x)}^2$};

                    \addplot+[
                        mark=none,
                        thick,
                    ]
                    table
                    {results/benchmarks/miyagi/dat/spf_l=20_sq.dat};
                    \addlegendentry{$\abs{\psi_{20}(x)}^2$};
                \end{axis}
            \end{tikzpicture}
            \caption{In this figure we've plotted some of the high lying
            single-particle functions squared and scaled by their
            eigenenergy inside the one-dimensional Beryllium potential.
            We've only included a select few single-particle functions to
            avoid the figure being too cluttered.}
            \label{fig:spf-potential-miyagi}
        \end{figure}

        We can see this from \autoref{fig:one-particle-density-miyagi}
        where a basis of $l = 20$ spin-orbitals has been used.
        This basis is not able to capture much of the scattered states and
        looking at the figure for $t = T$ we see that the system is
        relatively confined still.
        We can also see this from \autoref{fig:spf-potential-miyagi} as $l =
        20$ means the highest single-particle function used is
        $\psi_{10}(x)$ which is clearly confined in the potential well.
        However, looking at \autoref{fig:one-particle-density-miyagi-l=40}
        we see the same Beryllium system with a basis set of $l = 40$
        spin-orbitals.
        It is apparent that the system undergoes a larger degree of
        ionization with more of the one-particle density further away from
        the central potential.
        This is also see in \autoref{fig:spf-potential-miyagi} as $l = 40$
        includes the state $\psi_{20}(x)$ which is more dispersed.

        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{In these figures we have included the one-particle
            density for the initial ground state, after half the simulation
            has been run and for the final state of the one-dimensional
            Beryllium system.
            For these figures we have $l = 20$ spin-orbitals, that is, $l /
            2 = 10$ orbitals.
            The $y$-axis has been truncated at $y = \num{1e-4}$ to avoid
            including noise in the figures.}
            \label{fig:one-particle-density-miyagi}
        \end{figure}


        \begin{figure}
            \centering
            \begin{tikzpicture}
                \begin{groupplot}[
                        group style={
                            group size=1 by 3,
                            vertical sep=30pt,
                            xlabels at=edge bottom,
                            xticklabels at=edge bottom,
                            ylabels at=edge left,
                            vertical sep=10pt,
                        },
                        width=11cm,
                        height=6cm,
                        xlabel={$x$ $[\si{\bohr}]$},
                        ylabel={$\rho(x, t)$},
                        xmin=-100,
                        xmax=100,
                        ymin=1e-4,
                    ]
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_start_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_start_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = 0$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_half_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_half_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T/2$};
                    \nextgroupplot[
                            grid=major,
                            ymode=log,
                        ]
                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_tdhf_end_real_l=40.dat};
                        \addlegendentry{TDHF}

                        \addplot+ [
                            mark=none,
                            thick,
                        ]
                        table
                        {results/benchmarks/miyagi/dat/rho_oatdccd_end_real_l=40.dat};
                        \addlegendentry{OATDCCD}

                        \node[anchor=north west] at (rel axis cs:0,1)
                        {$t = T$};
                \end{groupplot}
            \end{tikzpicture}
            \caption{These figures show the same situation as in
            \autoref{fig:one-particle-density-miyagi} but for $l = 40$
            spin-orbitals.
            We have truncated the $y$-axis to $y = \num{1e-4}$ as lower
            values include more noise and provides no more insight.}
            \label{fig:one-particle-density-miyagi-l=40}
        \end{figure}
